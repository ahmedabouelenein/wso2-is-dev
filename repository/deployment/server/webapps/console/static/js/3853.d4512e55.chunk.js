"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[3853],{51147:function(e,t,n){n.d(t,{y:function(){return v}});var r=n(26776),a=n(96462),o=n(76742),i=n(68905),l=n(64805),s=n(5554),u=n(23177),c=n(84504),d=n(97532);function m(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(l)throw a}}return o}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v=function(e){var t=e.isReadOnly,n=e.emphasize,p=e.triggerSubmit,g=e.onSubmit,v=e.roleObject,h=e.isEdit,y=e.initialValues,b=e.isRole,S=e.isSubmitting,E=e.permissionsToHide,A=e["data-testid"],R=(0,l.$G)().t,w=f((0,i.useState)([]),2),L=w[0],I=w[1],O=f((0,i.useState)([]),2),z=O[0],C=O[1],P=f((0,i.useState)([]),2),k=P[0],T=P[1],N=f((0,i.useState)([]),2),Z=N[0],x=N[1],j=f((0,i.useState)(!0),2),G=j[0],_=j[1];(0,i.useEffect)((function(){var e=[];if(d.t.getAllOrganizationLevelPermissions(E).then((function(e){I(e),x([e[0].key.toString()]),_(!1)})),y&&y.length>0){var t=[];y.forEach((function(e){t.push(e.key.toString())})),T(t),null===k||void 0===k||k.forEach((function(t){var n=D(t,L);null!==n&&e.push(n)})),C(e)}b&&v&&(T(v.permissions),null===k||void 0===k||k.forEach((function(t){var n=D(t,L);null!==n&&e.push(n)})),C(e))}),[L.length>0]);var U=function(e,t){if(t.checked){if(!z.find((function(e){return e.key===t.node.key}))){var n,r,a=D(t.node.key,L,!0),o=1;if(null===a||void 0===a||null===(n=a.children)||void 0===n||n.forEach((function(e){z.filter((function(t){return t.key===e.key})).length>0&&++o})),(null===a||void 0===a||null===(r=a.children)||void 0===r?void 0:r.length)===o){var i=z.filter((function(e){e.key.toString().replace(/^\/|\/$/g,"").split("/"),a.key.toString().replace(/^\/|\/$/g,"").split("/")}));C([].concat(m(i),[a]))}else C([].concat(m(z),[t.node]))}}else C(t.checkedNodes)},D=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[t[0]];r.length;){var a=r.shift();if(n){if(a.key===e.slice(0,e.lastIndexOf("/")))return a}else if(a.key===e)return a;a.children&&r.push.apply(r,m(a.children))}return null},B=function(e){return e.isLeaf?null:i.createElement("div",{className:"tree-arrow-wrap"},i.createElement("span",{className:"tree-arrow ".concat(e.expanded?"":"active")},i.createElement("span",null),i.createElement("span",null)))},W=function(){return i.createElement(i.Fragment,null,i.createElement(r.Forms,{submitState:p,onSubmit:function(){g(z)}},G?i.createElement(a.ContentLoader,{className:"p-3",active:!0}):i.createElement("div",{className:"treeview-container"},i.createElement(o.Z,{className:"customIcon","data-testid":"".concat(A,"-tree"),disabled:t,checkedKeys:z.map((function(e){return e.key})),defaultExpandedKeys:Z,showLine:!0,showIcon:!1,checkable:!0,selectable:!1,onCheck:U,treeData:L,switcherIcon:B})),h&&!G&&i.createElement(i.Fragment,null,i.createElement(s.Z,{hidden:!0}),i.createElement(u.Z.Row,{columns:1},i.createElement(u.Z.Column,{mobile:16,tablet:16,computer:8},i.createElement(c.Z,{"data-testid":"".concat(A,"-update-button"),primary:!0,type:"submit",loading:S,disabled:S,size:"small",className:"form-button"},R("console:manage.features.roles.addRoleWizard.permissions.buttons.update")))))))};return n?i.createElement(a.EmphasizedSegment,{"data-testid":A,padded:"very"},W()):i.createElement("div",{"data-testid":A},W())};v.defaultProps={emphasize:!0,isReadOnly:!1}},73853:function(e,t,n){n.r(t),n.d(t,{default:function(){return J}});var r=n(69883),a=n(88742),o=n(26278),i=n(26776),l=n(22260),s=n(96462),u=n(98812),c=n(87289),d=n(68905),m=n(64805),f=n(83913),p=n(70515),g=n(12847),v=n(83952),h=n(10783),y=n(85027),b=n(23177),S=n(84504),E=n(87780),A=n(86715),R=n(50714),w=n(58107);function L(e,t,n,r,a,o,i){try{var l=e[o](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,a)}function I(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){L(o,r,a,i,l,"next",e)}function l(e){L(o,r,a,i,l,"throw",e)}i(void 0)}))}}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(l)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var C=function(e){var t=e.onSubmit,n=e.triggerSubmit,r=e.initialValues,a=e["data-testid"],o=(0,m.$G)().t,l=O((0,d.useState)(!0),2),s=l[0],u=l[1],c=O((0,d.useState)(g.fo.PRIMARY_USER_STORE),1)[0],p=O((0,d.useState)(!1),2),v=p[0],h=p[1],y=(0,f.v9)((function(e){return e.organization.organization})),S=function(){var e=I(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="",c===w.$R){e.next=6;break}return e.next=4,g.w3.getUserStoreRegEx(c,g.fo.USERSTORE_REGEX_PROPERTIES.RolenameRegEx).then((function(e){h(!0),n=e}));case 4:e.next=7;break;case 6:n=g.fo.PRIMARY_USERSTORE_PROPERTY_VALUES.RolenameJavaScriptRegEx;case 7:u(g.w3.validateInputAgainstRegEx(t,n));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return d.createElement(i.Forms,{"data-testid":a,onSubmit:function(e){t(function(e){return{roleName:e.get("rolename").toString()}}(e))},submitState:n},d.createElement(b.Z,null,d.createElement(E.Z,null,d.createElement(A.Z,{mobile:16,tablet:16,computer:8},d.createElement(i.Field,{"data-testid":"".concat(a,"-role-name-input"),type:"text",name:"rolename",label:o("console:manage.features.roles.addRoleWizard.forms.roleBasicDetails.roleName.label",{type:"Role"}),placeholder:o("console:manage.features.roles.addRoleWizard.forms.roleBasicDetails.roleName.placeholder",{type:"Role"}),required:!0,requiredErrorMessage:o("console:manage.features.roles.addRoleWizard.forms.roleBasicDetails.roleName.validations.empty",{type:"Role"}),validation:function(){var e=I(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,R.Sr)(y.id,"name eq ".concat(t),null,null);case 2:return(null===(r=e.sent)||void 0===r?void 0:r.totalResults)>0&&(n.isValid=!1,n.errorMessages.push(o("console:manage.features.roles.addRoleWizard.forms.roleBasicDetails.roleName.validations.duplicate",{type:"Role"}))),e.next=6,S(t.toString());case 6:s||(n.isValid=!1,n.errorMessages.push(o("console:manage.features.roles.addRoleWizard.forms.roleBasicDetails.roleName.validations.invalid",{type:"role"})));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),value:r&&r.roleName,loading:v})))))},P=n(76742),k=n(99104),T=n(97532);function N(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(l)throw a}}return o}(e,t)||x(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){if(e){if("string"===typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var G,_=function(e){var t,n,r=e.summary,a=e.triggerSubmit,o=e.onSubmit,i=e.isAddGroup,l=e["data-testid"],u=(0,m.$G)().t,c=Z((0,d.useState)([]),2),f=c[0],p=c[1],g=Z((0,d.useState)([]),2),v=g[0],h=g[1],y=Z((0,d.useState)([]),2),S=y[0],E=y[1];(0,d.useEffect)((function(){T.t.getAllOrganizationLevelPermissions().then((function(e){if(p(e),h([e[0].key.toString()]),r&&r.PermissionList){var t=r.PermissionList;E([].concat(N(S),N(t.map((function(e){return e.key})))))}}))}),[f.length>0]),(0,d.useEffect)((function(){a&&o(r)}),[a]);return d.createElement(b.Z,{className:"wizard-summary"},(null===r||void 0===r?void 0:r.BasicDetails)&&d.createElement(d.Fragment,null,d.createElement(b.Z.Row,{className:"summary-field",columns:2},d.createElement(b.Z.Column,{mobile:16,tablet:8,computer:7,textAlign:"right"},d.createElement("div",{"data-testid":"".concat(l,"-role-name-label"),className:"label"},u("console:manage.features.roles.addRoleWizard.summary.labels.roleName",i?{type:"Group"}:{type:"Role"}))),d.createElement(b.Z.Column,{mobile:16,tablet:8,computer:8,textAlign:"left"},d.createElement("div",{"data-testid":"".concat(l,"-role-name-value"),className:"value url"},r.BasicDetails.roleName)))),(null===r||void 0===r?void 0:r.PermissionList)&&r.PermissionList instanceof Array&&r.PermissionList.length>0&&d.createElement(b.Z.Row,{className:"summary-field",columns:2},d.createElement(b.Z.Column,{mobile:16,tablet:8,computer:7,textAlign:"right"},d.createElement("div",{"data-testid":"".concat(l,"-permissions-label"),className:"label"},u("console:manage.features.roles.addRoleWizard.summary.labels.permissions"))),d.createElement(b.Z.Column,{mobile:16,tablet:8,computer:8,textAlign:"left"},d.createElement(k.Z.Group,null,d.createElement(P.Z,{className:"customIcon","data-testid":"".concat(l,"-tree"),disabled:!0,checkedKeys:S,defaultExpandedKeys:v,showLine:!0,showIcon:!1,checkable:!0,selectable:!1,treeData:f,switcherIcon:function(e){return e.isLeaf?null:d.createElement("div",{className:"tree-arrow-wrap"},d.createElement("span",{className:"tree-arrow ".concat(e.expanded?"":"active")},d.createElement("span",null),d.createElement("span",null)))}})))),null!==r&&void 0!==r&&r.UserList&&(null===r||void 0===r?void 0:r.UserList)instanceof Array&&(null===r||void 0===r||null===(t=r.UserList)||void 0===t?void 0:t.length)>0?d.createElement(b.Z.Row,{className:"summary-field",columns:2},d.createElement(b.Z.Column,{mobile:16,tablet:8,computer:7,textAlign:"right"},d.createElement("div",{"data-testid":"".concat(l,"-users-label"),className:"label"},u("console:manage.features.roles.addRoleWizard.summary.labels.users"))),d.createElement(b.Z.Column,{mobile:16,tablet:8,computer:8,textAlign:"left"},d.createElement(k.Z.Group,null,null===r||void 0===r?void 0:r.UserList.map((function(e,t){return d.createElement("div",{key:t,className:"role-summary-user"},d.createElement(s.UserAvatar,{name:e.userName,size:"mini",floated:"left",image:e.profileUrl}),e.userName)}))))):null,null!==r&&void 0!==r&&r.GroupList&&(null===r||void 0===r?void 0:r.GroupList)instanceof Array&&(null===r||void 0===r||null===(n=r.GroupList)||void 0===n?void 0:n.length)>0?d.createElement(b.Z.Row,{className:"summary-field",columns:2},d.createElement(b.Z.Column,{mobile:16,tablet:8,computer:7,textAlign:"right"},d.createElement("div",{"data-testid":"".concat(l,"-users-label"),className:"label"},u("console:manage.features.roles.addRoleWizard.summary.labels.groups"))),d.createElement(b.Z.Column,{mobile:16,tablet:8,computer:8,textAlign:"left"},d.createElement(k.Z.Group,null,null===r||void 0===r?void 0:r.GroupList.map((function(e,t){return d.createElement(k.Z,{"data-testid":"".concat(l,"-permissions-").concat(t,"-label"),key:t,basic:!0,circular:!0},null===e||void 0===e?void 0:e.displayName)}))))):null)},U=n(51147),D=n(21207),B=n(26264);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){$(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(l)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return V(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e){e.BASIC_DETAILS="BasicDetails",e.PERM_LIST="PermissionList",e.USER_LIST="UserList",e.GROUP_LIST="GroupList",e.SUMMARY="summary"}(G||(G={}));var H=function(e){var t,n,r=e.closeWizard,a=e.initStep,o=e.updateList,l=e.isAddGroup,u=e.onCreateRoleRequested,c=e["data-testid"],f=(0,m.$G)().t,g=F((0,d.useState)(a),2),v=g[0],h=g[1],E=F((0,d.useState)(void 0),2),A=E[0],R=E[1],w=F((0,d.useState)(void 0),2),L=w[0],I=w[1],O=F((0,d.useState)(""),2),z=O[0],P=O[1],k=F((0,i.useTrigger)(),2),T=k[0],N=k[1],Z=F((0,i.useTrigger)(),2),x=Z[0],j=Z[1],W=F((0,i.useTrigger)(),2),V=W[0],H=W[1],q=F((0,d.useState)([]),2),K=q[0],Q=q[1],Y=F((0,d.useState)([]),2),J=Y[0],X=Y[1],ee=F((0,d.useState)([]),2),te=ee[0],ne=ee[1],re=F((0,d.useState)([]),2),ae=re[0],oe=re[1],ie=F((0,d.useState)([]),2),le=ie[0],se=ie[1],ue=F((0,d.useState)(!1),2),ce=ue[0],de=ue[1],me=F((0,d.useState)(!1),2),fe=me[0],pe=me[1];(0,d.useEffect)((function(){void 0!==A&&(h(v-1),R(void 0))}),[A]),(0,d.useEffect)((function(){K.length<1&&(0,D.hI)(null).then((function(e){var t=e.data.Resources.filter((function(e){return 1===e.displayName.split("/").length}));Q(t)}))}),[]),(0,d.useEffect)((function(){ce&&L&&L[G.BASIC_DETAILS]&&ge(L[G.BASIC_DETAILS])}),[L&&L[G.BASIC_DETAILS]]);var ge=function(e){var t,n,r,a,o,i,l,s=[],c=[],d=[];(null===e||void 0===e||null===(t=e.UserList)||void 0===t?void 0:t.length)>0&&(null===e||void 0===e||null===(o=e.UserList)||void 0===o||o.forEach((function(e){null===s||void 0===s||s.push({display:null===e||void 0===e?void 0:e.userName,value:null===e||void 0===e?void 0:e.id})})));(null===e||void 0===e||null===(n=e.GroupList)||void 0===n?void 0:n.length)>0&&(null===e||void 0===e||null===(i=e.GroupList)||void 0===i||i.forEach((function(e){null===c||void 0===c||c.push({display:e.displayName,value:e.id})})));(null===e||void 0===e||null===(r=e.PermissionList)||void 0===r?void 0:r.length)>0&&(null===e||void 0===e||null===(l=e.PermissionList)||void 0===l||l.forEach((function(e){null===d||void 0===d||d.push(null===e||void 0===e?void 0:e.key.toString())})));var m={displayName:null!==e&&void 0!==e&&e.BasicDetails?null===e||void 0===e||null===(a=e.BasicDetails)||void 0===a?void 0:a.roleName:null===e||void 0===e?void 0:e.roleName,groups:c,permissions:d,schemas:["urn:ietf:params:scim:schemas:extension:2.0:Role"],users:s};pe(!0),u&&u(m)},ve=function(e,t){G.BASIC_DETAILS===t&&P(e.domain),h(v+1),I(M(M({},L),{},$({},t,e)))},he=[{content:d.createElement(C,{"data-testid":"add-role-form",isAddGroup:l,triggerSubmit:T,initialValues:L&&L[G.BASIC_DETAILS],onSubmit:function(e){return ve(e,G.BASIC_DETAILS)}}),icon:(0,B.TT)().general,title:f("console:manage.features.roles.addRoleWizard.wizardSteps.0")},{content:d.createElement(U.y,{"data-testid":"new-organization-role-permissions",isEdit:!1,triggerSubmit:x,initialValues:L&&L[G.PERM_LIST],onSubmit:function(e){return ve(e,G.PERM_LIST)},isSubmitting:fe}),icon:d.createElement(p.Z,{name:"key",inverted:!0,size:"large"}),title:f("console:manage.features.roles.addRoleWizard.wizardSteps.1")},{content:d.createElement(B.vk,{"data-testid":"role-mgt-assign-users-and-groups",initialUsersList:le,initialGroupList:{groupList:K,initialGroupList:te,initialTempGroupList:ae,tempGroupList:J},onRoleUpdate:o,selectedUserStore:z,handleAddedGroupInitialListChange:function(e){oe(e)},handleAddedGroupListChange:function(e){X(e)},handleGroupListChange:function(e){return function(e){Q(e)}(e)},handleInitialGroupListChange:function(e){return function(e){ne(e)}(e)},handleTempUsersListChange:function(e){se(e)}}),icon:(0,B.TT)().assignUser,title:f("console:manage.features.roles.addRoleWizard.wizardSteps.4")},{content:d.createElement(_,{"data-testid":"organization-add-role-summary",isAddGroup:l,triggerSubmit:V,onSubmit:function(){ge(L)},summary:function(){if(L)return L}()}),icon:(0,B.TT)().summary,title:f("console:manage.features.roles.addRoleWizard.wizardSteps.3")}],ye=function(){var e,t;switch(v){case 0:N();break;case 1:j();break;case 2:$(e={},G.USER_LIST,le),$(e,null===G||void 0===G?void 0:G.GROUP_LIST,J),t=e,h(v+1),I(M(M({},L),t));break;case 3:H()}};return d.createElement(y.Z,{open:!0,className:"wizard create-role-wizard",dimmer:"blurring",size:"small",onClose:r,closeOnDimmerClick:!1,closeOnEscape:!1,"data-testid":c},d.createElement(y.Z.Header,{className:"wizard-header"},f("console:manage.features.roles.addRoleWizard.heading",{type:"Role"}),L&&null!==(t=L[G.BASIC_DETAILS])&&void 0!==t&&t.roleName?" - "+(null===(n=L[G.BASIC_DETAILS])||void 0===n?void 0:n.roleName):"",d.createElement(s.Heading,{as:"h6"},f("console:manage.features.roles.addRoleWizard.subHeading",{type:"role"}))),d.createElement(y.Z.Content,{className:"steps-container"},d.createElement(s.Steps.Group,{current:v},he.map((function(e,t){return d.createElement(s.Steps.Step,{key:t,icon:e.icon,title:e.title})})))),d.createElement(y.Z.Content,{className:"content-container",scrolling:!0},he[v].content),d.createElement(y.Z.Actions,null,d.createElement(b.Z,null,d.createElement(b.Z.Row,{column:1},d.createElement(b.Z.Column,{mobile:8,tablet:8,computer:8},d.createElement(s.LinkButton,{floated:"left",onClick:function(){return r()},"data-testid":"".concat(c,"-cancel-button")},f("common:cancel"))),d.createElement(b.Z.Column,{mobile:8,tablet:8,computer:8},v<he.length-1&&d.createElement(s.PrimaryButton,{floated:"right",onClick:ye,"data-testid":"".concat(c,"-next-button")},f("console:manage.features.roles.addRoleWizard.buttons.next"),d.createElement(p.Z,{name:"arrow right","data-testid":"".concat(c,"-next-button-icon")})),0===v&&d.createElement(S.Z,{basic:!0,color:"orange",floated:"right",onClick:function(){de(!0),N()},"data-testid":"".concat(c,"-initial-finish-button")},f("console:manage.features.roles.addRoleWizard.buttons.finish")),v===he.length-1&&d.createElement(s.PrimaryButton,{floated:"right",onClick:ye,loading:fe,disabled:fe,"data-testid":"".concat(c,"-finish-button")},f("console:manage.features.roles.addRoleWizard.buttons.finish")),v>0&&d.createElement(s.LinkButton,{floated:"right",onClick:function(){R(v)},"data-testid":"".concat(c,"-previous-button")},d.createElement(p.Z,{name:"arrow left","data-testid":"".concat(c,"-previous-button-icon")}),f("console:manage.features.roles.addRoleWizard.buttons.previous")))))))};function q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){l=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(l)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}H.defaultProps={initStep:0};var Q=[{key:0,text:l.I18n.instance.t("common:name"),value:"name"}],Y=function(e){var t=e["data-componentid"],n=(0,m.$G)().t,l=(0,f.I0)(),y=(0,f.v9)((function(e){return e.config.ui.features})),b=q((0,d.useState)(""),2),S=b[0],E=b[1],A=q((0,d.useState)(Q[0]),2),R=A[0],w=A[1],L=q((0,d.useState)(g.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT),2),I=L[0],O=L[1],z=q((0,d.useState)(!1),2),C=z[0],P=z[1],k=q((0,d.useState)(!0),2),T=k[0],N=k[1],Z=q((0,d.useState)(!1),2),x=Z[0],j=Z[1],G=q((0,d.useState)(!1),2),_=G[0],U=G[1],D=q((0,d.useState)(void 0),2),B=D[0],W=D[1],M=q((0,d.useState)(),2),$=M[0],F=M[1],V=q((0,d.useState)(""),2),K=V[0],Y=V[1],J=q((0,d.useState)(""),2),X=J[0],ee=J[1],te=q((0,d.useState)(null),2),ne=te[0],re=te[1],ae=q((0,d.useState)(1),2),oe=ae[0],ie=ae[1],le=q((0,i.useTrigger)(),2),se=le[0],ue=le[1],ce=(0,f.v9)((function(e){return e.organization.organization})),de=function(){ie(1),ue()},me=(0,d.useCallback)((function(e,t,r){P(!0),(0,v.Sr)(ce.id,t,e,r).then((function(e){fe(e.nextCursor,e.previousCursor),F(e.Resources)})).catch((function(e){null!==e&&void 0!==e&&e.description?l((0,o.addAlert)({description:e.description,level:a.AlertLevels.ERROR,message:n("console:manage.features.organizations.notifications.getOrganizationList.error.message")})):l((0,o.addAlert)({description:n("console:manage.features.organizations.notifications.getOrganizationList.genericError.description"),level:a.AlertLevels.ERROR,message:n("console:manage.features.organizations.notifications.getOrganizationList.genericError.message")}))})).finally((function(){P(!1),N(!1)}))}),[l,n]),fe=function(e,t){re(null),Y(void 0),ee(void 0),e&&Y(e),t&&ee(t),W(!!e)},pe=function(e){de(),E(e)},ge=(0,d.useCallback)((function(e){e.groups.forEach((function(e){delete e.display})),e.users.forEach((function(e){delete e.display})),delete e.schemas,(0,v.eI)(ce.id,e).then((function(e){201===e.status&&(l((0,o.addAlert)({description:n("console:manage.features.roles.notifications.createRole.success.description"),level:a.AlertLevels.SUCCESS,message:n("console:manage.features.roles.notifications.createRole.success.message")})),U(!1),g.m8.push(g.$x.getPaths().get("ORGANIZATION_ROLE_UPDATE").replace(":id",e.data.id)))})).catch((function(e){e.response&&401!==e.response.status?e.response&&e.response.data.detail?(U(!1),l((0,o.addAlert)({description:n("console:manage.features.roles.notifications.createRole.error.description",{description:e.response.data.detail}),level:a.AlertLevels.ERROR,message:n("console:manage.features.roles.notifications.createRole.error.message")}))):(U(!1),l((0,o.addAlert)({description:n("console:manage.features.roles.notifications.createRole.genericError.description"),level:a.AlertLevels.ERROR,message:n("console:manage.features.roles.notifications.createRole.genericError.message")}))):(U(!1),l((0,o.addAlert)({description:n("console:manage.features.roles.notifications.createRole.error.description"),level:a.AlertLevels.ERROR,message:n("console:manage.features.roles.notifications.createRole.error.message")})))})).finally((function(){N(!1)}))}),[U,N,l,ce,n]);return(0,d.useEffect)((function(){me(I,S,ne)}),[I,me,S]),d.createElement(d.Fragment,null,d.createElement(s.PageLayout,{action:!T&&!(!S&&((0,c.Z)($)||$.length<=0))&&d.createElement(r.di,{when:r.TA.ORGANIZATION_WRITE},d.createElement(s.PrimaryButton,{disabled:C,loading:C,onClick:function(){U(!0)},"data-testid":"".concat(t,"-list-layout-add-button")},d.createElement(p.Z,{name:"add"}),n("Add Organization Role"))),title:"Organization Roles",pageTitle:"Organization Roles",description:"Manage organization roles here","data-testid":"".concat(t,"-page-layout"),titleAs:"h3"},T?d.createElement(s.GridLayout,{isLoading:T}):d.createElement(d.Fragment,null,d.createElement(s.ListLayout,{advancedSearch:d.createElement(g.nC,{onFilter:pe,filterAttributeOptions:[{key:0,text:n("common:name"),value:"name"}],filterAttributePlaceholder:n("console:manage.features.organizations.advancedSearch.form.inputs.filterAttribute.placeholder"),filterConditionsPlaceholder:n("console:manage.features.organizations.advancedSearch.form.inputs.filterCondition.placeholder"),filterValuePlaceholder:n("console:manage.features.organizations.advancedSearch.form.inputs.filterValue.placeholder"),placeholder:n("console:manage.features.organizations.advancedSearch.placeholder"),defaultSearchAttribute:"name",defaultSearchOperator:"co",triggerClearQuery:x,"data-testid":"".concat(t,"-list-advanced-search")}),currentListSize:null===$||void 0===$?void 0:$.length,listItemLimit:I,onItemsPerPageDropdownChange:function(e,t){O(t.value),de()},onPageChange:function(e,t){var n=parseInt(null===t||void 0===t?void 0:t.activePage);n>oe?(re(K),me(I,S,K)):n<oe&&(re(X),me(I,S,X)),ie(n)},onSortStrategyChange:function(e,t){w((0,u.Z)(Q,(function(e){return t.value===e.value})))},showPagination:!0,showTopActionPanel:C||!(!S&&(null===$||void 0===$?void 0:$.length)<=0),sortOptions:Q,sortStrategy:R,totalPages:K?oe+1:1,totalListSize:null===$||void 0===$?void 0:$.length,paginationOptions:{disableNextButton:!B},"data-testid":"".concat(t,"-list-layout"),resetPagination:se},d.createElement(h.eh,{advancedSearch:d.createElement(g.nC,{onFilter:pe,filterAttributeOptions:[{key:0,text:n("common:name"),value:"name"}],filterAttributePlaceholder:n("console:manage.features.organizations.advancedSearch.form.inputs.filterAttribute.placeholder"),filterConditionsPlaceholder:n("console:manage.features.organizations.advancedSearch.form.inputs.filterCondition.placeholder"),filterValuePlaceholder:n("console:manage.features.organizations.advancedSearch.form.inputs.filterValue.placeholder"),placeholder:n("console:manage.features.organizations.advancedSearch.placeholder"),defaultSearchAttribute:"name",defaultSearchOperator:"co",triggerClearQuery:x,"data-testid":"".concat(t,"-list-advanced-search")}),featureConfig:y,isLoading:C,list:$,onOrganizationRoleDelete:function(){me(I,S,ne)},onEmptyListPlaceholderActionClick:function(){U(!0)},onSearchQueryClear:function(){E(""),de(),j(!x)},organizationId:ce.id,searchQuery:S,"data-testid":"".concat(t,"-list"),"data-componentid":"organization",onListItemClick:function(e,t){g.m8.push(g.$x.getPaths().get("ORGANIZATION_ROLE_UPDATE").replace(":id",t.id))}})),_&&d.createElement(H,{"data-testid":"org-role-mgt-add-role-wizard",isAddGroup:!1,closeWizard:function(){return U(!1)},updateList:function(){me(I,S,ne)},onCreateRoleRequested:ge}))))};Y.defaultProps={"data-componentid":"organizations-roles"};var J=Y},97532:function(e,t,n){n.d(t,{t:function(){return c}});var r=n(87289),a=n(83108),o=n(50714);function i(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"generatePermissionTree",value:function(e,t,n){var r=t.shift(),o=n.find((function(e){return e.name===r}));return o||(o={key:e.resourcePath,name:r,title:e.displayName},n.push(o)),t.length&&(0,a.H)(e,t,o.children||(o.children=[])),n}}],(n=null)&&s(t.prototype,n),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();u(c,"permissionJoining",(function(e,t){var n=e.split("/"),r=n.splice(0,t);return n=[r.join("/")].concat(i(e))})),u(c,"getAllOrganizationLevelPermissions",(function(e){return(0,o._W)().then((function(t){if(200===t.status&&t.data&&t.data instanceof Array){var n=(0,r.Z)(e)?t.data:t.data.filter((function(t){return!e.includes(t.resourcePath)})),o=!1;return n.reduce((function(e,t,n){return 0===n&&2==t.resourcePath.replace(/^\/|\/$/g,"").split("/").length&&(o=!0),o?(0,a.H)(t,c.permissionJoining(t.resourcePath.replace(/^\/|\/$/g,""),2),e):(0,a.H)(t,t.resourcePath.replace(/^\/|\/$/g,"").split("/"),e)}),[])}}))}))}}]);