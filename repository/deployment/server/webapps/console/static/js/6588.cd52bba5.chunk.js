"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[6588],{83421:function(e,t,n){n.d(t,{f:function(){return d}});var r=n(69883),a=n(96462),o=n(68905),c=n(64805),i=n(70515),s=n(12847),l=n(40759),d=function(e){var t=e.onAddNewSecret,n=e.resourceNotFound,d=e["data-componentid"],u=(0,c.$G)().t;return n?o.createElement(a.EmptyPlaceholder,{action:o.createElement(a.LinkButton,{"aria-label":u("console:develop.features.secrets.emptyPlaceholders.buttons.backToSecrets.ariaLabel"),onClick:function(){s.m8.push(s.$x.getPaths().get(l.Fk))}},o.createElement(i.Z,{name:"backward"}),u("console:develop.features.secrets.emptyPlaceholders.buttons.backToSecrets.label")),image:(0,s.jF)().pageNotFound,imageSize:"tiny",subtitle:[u("console:develop.features.secrets.emptyPlaceholders.resourceNotFound.messages.0"),u("console:develop.features.secrets.emptyPlaceholders.resourceNotFound.messages.1")],"data-testid":d}):o.createElement(a.EmptyPlaceholder,{action:o.createElement(r.di,{when:r.TA.SECRET_WRITE},o.createElement(a.PrimaryButton,{"aria-label":u("console:develop.features.secrets.emptyPlaceholders.buttons.addSecret.ariaLabel"),onClick:t},o.createElement(i.Z,{name:"add"}),u("console:develop.features.secrets.emptyPlaceholders.buttons.addSecret.label"))),image:(0,s.jF)().newList,imageSize:"tiny",subtitle:[u("console:develop.features.secrets.emptyPlaceholders.emptyListOfSecrets.messages.0")],"data-testid":d})};d.defaultProps={"data-componentid":"empty-secret-list-placeholder"}},96588:function(e,t,n){n.r(t),n.d(t,{default:function(){return Z}});var r=n(69883),a=n(88742),o=n(26278),c=n(96462),i=n(68905),s=n(64805),l=n(83913),d=n(70515),u=n(21275),m=n(34861),p=n(8890),f=n(22260),v=n(98812),h=n(82791),y=n(83421),g=n(12847),S=n(40759),b=n(70787),A=n.n(b);function E(e,t,n,r,a,o,c){try{var i=e[o](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}function w(e){return function(e){if(Array.isArray(e))return R(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||C(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],c=!0,i=!1;try{for(n=n.call(e);!(c=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);c=!0);}catch(e){i=!0,a=e}finally{try{c||null==n.return||n.return()}finally{if(i)throw a}}return o}(e,t)||C(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){if(e){if("string"===typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(e,t):void 0}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var T=[{key:1,text:f.I18n.instance.t("common:name"),value:"name"},{key:2,text:f.I18n.instance.t("common:type"),value:"type"},{key:3,text:f.I18n.instance.t("common:createdOn"),value:"createdDate"},{key:4,text:f.I18n.instance.t("common:lastUpdatedOn"),value:"lastUpdated"}],x=function(e){var t=e.onSearchQueryClear,n=e.advancedSearch,r=e.whenSecretDeleted,d=e.isSecretListLoading,m=e.secretList,f=e["data-componentid"],b=e.onAddNewSecretButtonClick,C=e.selectedSecretType,R=e.showAdaptiveAuthSecretBanner,x=(0,s.$G)().t,P=(0,l.I0)(),L=k((0,i.useState)(!1),2),N=L[0],M=L[1],I=k((0,i.useState)(void 0),2),O=I[0],Z=I[1],j=(0,l.v9)((function(e){return e.config.ui.features})),B=(0,l.v9)((function(e){var t;return null===e||void 0===e||null===(t=e.auth)||void 0===t?void 0:t.allowedScopes})),D=k((0,i.useState)([]),2),F=D[0],$=D[1],_=k((0,i.useState)(""),2),q=_[0],z=_[1],H=k((0,i.useState)(T[0]),2),V=H[0],G=H[1],U=function(e,t){var n,r;if(null===e||void 0===e||e.preventDefault(),(0,p.hasRequiredScopes)(null===j||void 0===j?void 0:j.secretsManagement,null===j||void 0===j||null===(n=j.secretsManagement)||void 0===n||null===(r=n.scopes)||void 0===r?void 0:r.update,B)){var a=g.$x.getPaths().get(S.AA).replace(":type",null===t||void 0===t?void 0:t.type).replace(":name",null===t||void 0===t?void 0:t.secretName);g.m8.push({pathname:a})}};(0,i.useEffect)((function(){$(w(m).reverse())}),[m]);var W=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!O||!(0,p.hasRequiredScopes)(null===j||void 0===j?void 0:j.secretsManagement,null===j||void 0===j||null===(t=j.secretsManagement)||void 0===t||null===(n=t.scopes)||void 0===n?void 0:n.delete,B)){e.next=19;break}return e.prev=1,e.next=4,(0,u.c8)({params:{secretName:O.secretName,secretType:O.type}});case 4:P((0,o.addAlert)({description:x("console:develop.features.secrets.alerts.deleteSecret.description",{secretName:O.secretName,secretType:O.type}),level:a.AlertLevels.SUCCESS,message:x("console:develop.features.secrets.alerts.deleteSecret.message")})),e.next=13;break;case 7:if(e.prev=7,e.t0=e.catch(1),!(e.t0.response&&e.t0.response.data&&e.t0.response.data.description)){e.next=12;break}return P((0,o.addAlert)({description:e.t0.response.data.description,level:a.AlertLevels.ERROR,message:e.t0.response.data.message})),e.abrupt("return");case 12:P((0,o.addAlert)({description:x("console:develop.features.secrets.errors.generic.description"),level:a.AlertLevels.ERROR,message:x("console:develop.features.secrets.errors.generic.message")}));case 13:return e.prev=13,r(O,!0),M(!1),Z(void 0),e.finish(13);case 19:case"end":return e.stop()}}),e,null,[[1,7,13,19]])})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){E(o,r,a,c,i,"next",e)}function i(e){E(o,r,a,c,i,"throw",e)}c(void 0)}))});return function(){return t.apply(this,arguments)}}(),Y=i.createElement(c.ConfirmationModal,{onClose:function(){M(!1),Z(void 0)},onSecondaryActionClick:function(){M(!1),Z(void 0)},onPrimaryActionClick:W,open:N,type:"negative",assertionHint:x("console:develop.features.secrets.modals.deleteSecret.assertionHint"),assertionType:"checkbox",primaryAction:x("console:develop.features.secrets.modals.deleteSecret.primaryActionButtonText"),secondaryAction:x("console:develop.features.secrets.modals.deleteSecret.secondaryActionButtonText"),"data-testid":"".concat(f,"-delete-confirmation-modal"),closeOnDimmerClick:!1},i.createElement(c.ConfirmationModal.Header,{"data-testid":"".concat(f,"-delete-confirmation-modal-header")},x("console:develop.features.secrets.modals.deleteSecret.title")),i.createElement(c.ConfirmationModal.Message,{attached:!0,negative:!0,"data-testid":"".concat(f,"-delete-confirmation-modal-message")},x("console:develop.features.secrets.modals.deleteSecret.warningMessage")),i.createElement(c.ConfirmationModal.Content,{"data-testid":"".concat(f,"-delete-confirmation-modal-content")},x("console:develop.features.secrets.modals.deleteSecret.content")));return i.createElement(c.GridLayout,{isLoading:d,showTopActionPanel:!1},R&&C===S.H0&&i.createElement(c.Message,{type:"info","data-componentid":"".concat(f,"-page-message"),header:x("console:develop.features.secrets.banners.adaptiveAuthSecretType.title"),content:x("console:develop.features.secrets.banners.adaptiveAuthSecretType.content")}),(null===m||void 0===m?void 0:m.length)>0?i.createElement(c.ListLayout,{advancedSearch:i.createElement(g.nC,{onFilter:function(e){z(e),e||$(m.reverse());var t=null===e||void 0===e?void 0:e.split(" ");if(t){var n=t[1],r=t.splice(2).join(""),a=[];m.forEach((function(e){"co"===n&&null!==e&&void 0!==e&&e.secretName.includes(r)&&a.push(e),"sw"===n&&null!==e&&void 0!==e&&e.secretName.startsWith(r)&&a.push(e),"ew"===n&&null!==e&&void 0!==e&&e.secretName.endsWith(r)&&a.push(e),"eq"===n&&(null===e||void 0===e?void 0:e.secretName)==r&&a.push(e)})),$(a.reverse())}},filterAttributeOptions:[{key:0,text:x("common:name"),value:"name"}],filterAttributePlaceholder:x("console:develop.features.secrets.advancedSearch.form.inputs.filterAttribute.placeholder"),filterConditionsPlaceholder:x("console:develop.features.secrets.advancedSearch.form.inputs.filterCondition.placeholder"),filterValuePlaceholder:x("console:develop.features.secrets.advancedSearch.form.inputs.filterValue.placeholder"),placeholder:x("console:develop.features.secrets.advancedSearch.placeholder"),defaultSearchAttribute:"name",defaultSearchOperator:"co","data-testid":"".concat(f,"-list-advanced-search")}),currentListSize:m.length,onPageChange:function(){},onSortStrategyChange:function(e,t){G((0,v.Z)(T,(function(e){return t.value===e.value})))},showPagination:!1,sortOptions:T,sortStrategy:V,totalPages:1,"data-testid":"".concat(f,"-list-layout")},i.createElement(c.DataTable,{externalSearch:n,data:F,showHeader:!1,onRowClick:U,actions:[{"data-componentid":"".concat(f,"-item-edit-button"),hidden:function(){var e,t;return!(0,p.hasRequiredScopes)(null===j||void 0===j?void 0:j.secretsManagement,null===j||void 0===j||null===(e=j.secretsManagement)||void 0===e||null===(t=e.scopes)||void 0===t?void 0:t.update,B)},icon:function(){return"pencil alternate"},onClick:U,popupText:function(){return x("common:edit")},renderer:"semantic-icon"},{"data-componentid":"".concat(f,"-item-delete-button"),hidden:function(){var e,t;return!(0,p.hasRequiredScopes)(null===j||void 0===j?void 0:j.secretsManagement,null===j||void 0===j||null===(e=j.secretsManagement)||void 0===e||null===(t=e.scopes)||void 0===t?void 0:t.delete,B)},icon:function(){return"trash alternate"},onClick:function(e,t){null===e||void 0===e||e.preventDefault(),Z(t),M(!0)},popupText:function(){return x("common:delete")},renderer:"semantic-icon"}],columns:[{allowToggleVisibility:!1,dataIndex:"secretName",id:"secret-name",key:"data-column-secret-name",render:function(e){return i.createElement(h.Z,{image:!0,as:"h6",className:"header-with-icon","data-testid":"".concat(f,"-first-column")},i.createElement(c.AppAvatar,{image:i.createElement(c.GenericIcon,{size:"mini",shape:"rounded",colored:!0,background:!0,hoverable:!1,icon:(0,g.Lb)().editingSecretIcon}),size:"mini",spaced:"right","data-testid":"".concat(f,"-item-image")}),i.createElement(h.Z.Content,{"data-testid":"".concat(f,"-first-column-item-header")},e.secretName,i.createElement(h.Z.Subheader,{className:"truncate ellipsis","data-testid":"".concat(f,"-item-sub-heading")},e.description)))},title:"Secret Name"},{allowToggleVisibility:!1,dataIndex:"created",id:"created-at",key:"data-column-created-at",render:function(e){return i.createElement(h.Z,{as:"h6","data-testid":"".concat(f,"-second-column")},i.createElement(h.Z.Content,{"data-testid":"".concat(f,"-second-column-data")},(t=e.created)?A()(t).format("dddd, MMMM Do YYYY"):"N/A"));var t},title:"Created At"},{allowToggleVisibility:!1,dataIndex:"lastModified",id:"last-modified",key:"data-column-last-modified",render:function(e){return i.createElement(h.Z,{as:"h6","data-testid":"".concat(f,"-third-column")},i.createElement(h.Z.Content,{"data-testid":"".concat(f,"-third-column-data")},(t=e.lastModified)?A()(t).utc(!0).fromNow():"N/A"));var t},title:"Last Modified"},{allowToggleVisibility:!1,dataIndex:"action",id:"actions",key:"actions",textAlign:"right",title:"Take Action"}],placeholders:q&&0===(null===F||void 0===F?void 0:F.length)?i.createElement(c.EmptyPlaceholder,{action:i.createElement(c.LinkButton,{onClick:t},x("console:develop.placeholders.emptySearchResult.action")),image:(0,g.jF)().emptySearch,imageSize:"tiny",title:x("console:develop.placeholders.emptySearchResult.title"),subtitle:[x("console:develop.placeholders.emptySearchResult.subtitles.0",{query:q}),x("console:develop.placeholders.emptySearchResult.subtitles.1")],"data-testid":"".concat(f,"-empty-search-placeholder")}):null}),N&&Y):i.createElement(y.f,{onAddNewSecret:b}))};x.defaultProps={"data-componentid":"secrets-list",showAdaptiveAuthSecretBanner:!1};var P=x;function L(e,t,n,r,a,o,c){try{var i=e[o](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,a)}function N(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function c(e){L(o,r,a,c,i,"next",e)}function i(e){L(o,r,a,c,i,"throw",e)}c(void 0)}))}}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],c=!0,i=!1;try{for(n=n.call(e);!(c=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);c=!0);}catch(e){i=!0,a=e}finally{try{c||null==n.return||n.return()}finally{if(i)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var O=function(e){var t=e["data-componentid"],n=(0,l.I0)(),p=(0,s.$G)().t,f=M((0,i.useState)([]),2),v=f[0],h=f[1],y=M((0,i.useState)(!0),2),g=y[0],b=y[1],A=M((0,i.useState)(!1),2),E=A[0],w=A[1],k=M((0,i.useState)(S.H0),1)[0],C=M((0,i.useState)(!0),2),R=C[0],T=C[1];(0,i.useEffect)((function(){x()}),[]);var x=function(){var e=N(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b(!0),(0,u.pR)({params:{secretType:k}}).then((function(e){h(e.data)})).catch((function(e){var t,r;e.response&&e.response.data&&e.response.data.description?n((0,o.addAlert)({description:null===(t=e.response.data)||void 0===t?void 0:t.description,level:a.AlertLevels.ERROR,message:null===(r=e.response.data)||void 0===r?void 0:r.message})):n((0,o.addAlert)({description:p("console:develop.features.secrets.errors.generic.description"),level:a.AlertLevels.ERROR,message:p("console:develop.features.secrets.errors.generic.message")}))})).finally((function(){b(!1),T(!1)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=N(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),I=function(){w(!0)};return i.createElement(c.PageLayout,{action:!R&&!((null===v||void 0===v?void 0:v.length)<=0)&&i.createElement(r.di,{when:r.TA.SECRET_WRITE},i.createElement(c.PrimaryButton,{onClick:I,"data-testid":"".concat(t,"-add-button")},i.createElement(d.Z,{name:"add"}),p("console:develop.features.secrets.page.primaryActionButtonText"))),isLoading:g,title:p("console:develop.features.secrets.page.title"),pageTitle:p("console:develop.features.secrets.page.title"),description:p("console:develop.features.secrets.page.description")},i.createElement(r.di,{when:r.TA.SECRET_READ},i.createElement(P,{whenSecretDeleted:function(e,t){t&&L()},isSecretListLoading:g,secretList:v,selectedSecretType:k,onAddNewSecretButtonClick:I,onSearchQueryClear:x})),E&&i.createElement(m.Z,{onClose:function(e){w(!1),e&&L()}}))};O.defaultProps={"data-componentid":"secrets-page"};var Z=O}}]);