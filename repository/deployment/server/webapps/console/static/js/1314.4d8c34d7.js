(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[1314],{58681:function(e,t,r){var n=r(10550);r(81903),r(13992),r(83726);var a=e.exports=n.pkcs1=n.pkcs1||{};function s(e,t,r){r||(r=n.md.sha1.create());for(var a="",s=Math.ceil(t/r.digestLength),i=0;i<s;++i){var o=String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,255&i);r.start(),r.update(e+o),a+=r.digest().getBytes()}return a.substring(0,t)}a.encode_rsa_oaep=function(e,t,r){var a,i,o,c;"string"===typeof r?(a=r,i=arguments[3]||void 0,o=arguments[4]||void 0):r&&(a=r.label||void 0,i=r.seed||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(c=r.mgf1.md)),o?o.start():o=n.md.sha1.create(),c||(c=o);var l=Math.ceil(e.n.bitLength()/8),u=l-2*o.digestLength-2;if(t.length>u)throw(h=new Error("RSAES-OAEP input message length is too long.")).length=t.length,h.maxLength=u,h;a||(a=""),o.update(a,"raw");for(var p=o.digest(),d="",f=u-t.length,y=0;y<f;y++)d+="\0";var g=p.getBytes()+d+"\x01"+t;if(i){if(i.length!==o.digestLength){var h;throw(h=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.")).seedLength=i.length,h.digestLength=o.digestLength,h}}else i=n.random.getBytes(o.digestLength);var C=s(i,l-o.digestLength-1,c),m=n.util.xorBytes(g,C,g.length),v=s(m,o.digestLength,c),E=n.util.xorBytes(i,v,i.length);return"\0"+E+m},a.decode_rsa_oaep=function(e,t,r){var a,i,o;"string"===typeof r?(a=r,i=arguments[3]||void 0):r&&(a=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md));var c=Math.ceil(e.n.bitLength()/8);if(t.length!==c)throw(m=new Error("RSAES-OAEP encoded message length is invalid.")).length=t.length,m.expectedLength=c,m;if(void 0===i?i=n.md.sha1.create():i.start(),o||(o=i),c<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");a||(a=""),i.update(a,"raw");for(var l=i.digest().getBytes(),u=t.charAt(0),p=t.substring(1,i.digestLength+1),d=t.substring(1+i.digestLength),f=s(d,i.digestLength,o),y=n.util.xorBytes(p,f,p.length),g=s(y,c-i.digestLength-1,o),h=n.util.xorBytes(d,g,d.length),C=h.substring(0,i.digestLength),m="\0"!==u,v=0;v<i.digestLength;++v)m|=l.charAt(v)!==C.charAt(v);for(var E=1,S=i.digestLength,I=i.digestLength;I<h.length;I++){var T=h.charCodeAt(I),A=1&T^1,N=E?65534:0;m|=T&N,S+=E&=A}if(m||1!==h.charCodeAt(S))throw new Error("Invalid RSAES-OAEP padding.");return h.substring(S+1)}},65009:function(e,t,r){var n=r(10550);r(29700),r(45479),r(28648),r(31038),r(45831),r(13992),r(44109),r(83726),r(81903),r(16886);var a=n.asn1,s=n.pki,i=e.exports=n.pkcs12=n.pkcs12||{},o={name:"ContentInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:a.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},c={name:"PFX",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"version"},o,{name:"PFX.macData",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:a.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},l={name:"SafeBag",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:a.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:a.Class.UNIVERSAL,type:a.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},u={name:"Attribute",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:a.Class.UNIVERSAL,type:a.Type.SET,constructed:!0,capture:"values"}]},p={name:"CertBag",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:a.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:a.Class.UNIVERSAL,type:a.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function d(e,t,r,n){for(var a=[],s=0;s<e.length;s++)for(var i=0;i<e[s].safeBags.length;i++){var o=e[s].safeBags[i];void 0!==n&&o.type!==n||(null!==t?void 0!==o.attributes[t]&&o.attributes[t].indexOf(r)>=0&&a.push(o):a.push(o))}return a}function f(e){if(e.composed||e.constructed){for(var t=n.util.createBuffer(),r=0;r<e.value.length;++r)t.putBytes(e.value[r].value);e.composed=e.constructed=!1,e.value=t.getBytes()}return e}function y(e,t){var r={},i=[];if(!a.validate(e,n.pkcs7.asn1.encryptedDataValidator,r,i))throw(o=new Error("Cannot read EncryptedContentInfo.")).errors=i,o;var o,c=a.derToOid(r.contentType);if(c!==s.oids.data)throw(o=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.")).oid=c,o;c=a.derToOid(r.encAlgorithm);var l=s.pbe.getCipher(c,r.encParameter,t),u=f(r.encryptedContentAsn1),p=n.util.createBuffer(u.value);if(l.update(p),!l.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return l.output.getBytes()}function g(e,t,r){if(!t&&0===e.length)return[];if((e=a.fromDer(e,t)).tagClass!==a.Class.UNIVERSAL||e.type!==a.Type.SEQUENCE||!0!==e.constructed)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],i=0;i<e.value.length;i++){var o=e.value[i],c={},u=[];if(!a.validate(o,l,c,u))throw(C=new Error("Cannot read SafeBag.")).errors=u,C;var d,f,y={type:a.derToOid(c.bagId),attributes:h(c.bagAttributes)};n.push(y);var g=c.bagValue.value[0];switch(y.type){case s.oids.pkcs8ShroudedKeyBag:if(null===(g=s.decryptPrivateKeyInfo(g,r)))throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case s.oids.keyBag:try{y.key=s.privateKeyFromAsn1(g)}catch(e){y.key=null,y.asn1=g}continue;case s.oids.certBag:d=p,f=function(){if(a.derToOid(c.certId)!==s.oids.x509Certificate){var e=new Error("Unsupported certificate type, only X.509 supported.");throw e.oid=a.derToOid(c.certId),e}var r=a.fromDer(c.cert,t);try{y.cert=s.certificateFromAsn1(r,!0)}catch(e){y.cert=null,y.asn1=r}};break;default:var C;throw(C=new Error("Unsupported PKCS#12 SafeBag type.")).oid=y.type,C}if(void 0!==d&&!a.validate(g,d,c,u))throw(C=new Error("Cannot read PKCS#12 "+d.name)).errors=u,C;f()}return n}function h(e){var t={};if(void 0!==e)for(var r=0;r<e.length;++r){var n={},i=[];if(!a.validate(e[r],u,n,i)){var o=new Error("Cannot read PKCS#12 BagAttribute.");throw o.errors=i,o}var c=a.derToOid(n.oid);if(void 0!==s.oids[c]){t[s.oids[c]]=[];for(var l=0;l<n.values.length;++l)t[s.oids[c]].push(n.values[l].value)}}return t}i.pkcs12FromAsn1=function(e,t,r){"string"===typeof t?(r=t,t=!0):void 0===t&&(t=!0);var l={};if(!a.validate(e,c,l,[]))throw(u=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.")).errors=u,u;var u,p={version:l.version.charCodeAt(0),safeContents:[],getBags:function(e){var t,r={};return"localKeyId"in e?t=e.localKeyId:"localKeyIdHex"in e&&(t=n.util.hexToBytes(e.localKeyIdHex)),void 0===t&&!("friendlyName"in e)&&"bagType"in e&&(r[e.bagType]=d(p.safeContents,null,null,e.bagType)),void 0!==t&&(r.localKeyId=d(p.safeContents,"localKeyId",t,e.bagType)),"friendlyName"in e&&(r.friendlyName=d(p.safeContents,"friendlyName",e.friendlyName,e.bagType)),r},getBagsByFriendlyName:function(e,t){return d(p.safeContents,"friendlyName",e,t)},getBagsByLocalKeyId:function(e,t){return d(p.safeContents,"localKeyId",e,t)}};if(3!==l.version.charCodeAt(0))throw(u=new Error("PKCS#12 PFX of version other than 3 not supported.")).version=l.version.charCodeAt(0),u;if(a.derToOid(l.contentType)!==s.oids.data)throw(u=new Error("Only PKCS#12 PFX in password integrity mode supported.")).oid=a.derToOid(l.contentType),u;var h=l.content.value[0];if(h.tagClass!==a.Class.UNIVERSAL||h.type!==a.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(h=f(h),l.mac){var C=null,m=0,v=a.derToOid(l.macAlgorithm);switch(v){case s.oids.sha1:C=n.md.sha1.create(),m=20;break;case s.oids.sha256:C=n.md.sha256.create(),m=32;break;case s.oids.sha384:C=n.md.sha384.create(),m=48;break;case s.oids.sha512:C=n.md.sha512.create(),m=64;break;case s.oids.md5:C=n.md.md5.create(),m=16}if(null===C)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+v);var E=new n.util.ByteBuffer(l.macSalt),S="macIterations"in l?parseInt(n.util.bytesToHex(l.macIterations),16):1,I=i.generateKey(r,E,3,S,m,C),T=n.hmac.create();if(T.start(C,I),T.update(h.value),T.getMac().getBytes()!==l.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return function(e,t,r,n){if((t=a.fromDer(t,r)).tagClass!==a.Class.UNIVERSAL||t.type!==a.Type.SEQUENCE||!0!==t.constructed)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var i=0;i<t.value.length;i++){var c=t.value[i],l={},u=[];if(!a.validate(c,o,l,u))throw(C=new Error("Cannot read ContentInfo.")).errors=u,C;var p={encrypted:!1},d=null,h=l.content.value[0];switch(a.derToOid(l.contentType)){case s.oids.data:if(h.tagClass!==a.Class.UNIVERSAL||h.type!==a.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");d=f(h).value;break;case s.oids.encryptedData:d=y(h,n),p.encrypted=!0;break;default:var C;throw(C=new Error("Unsupported PKCS#12 contentType.")).contentType=a.derToOid(l.contentType),C}p.safeBags=g(d,r,n),e.safeContents.push(p)}}(p,h.value,t,r),p},i.toPkcs12Asn1=function(e,t,r,o){(o=o||{}).saltSize=o.saltSize||8,o.count=o.count||2048,o.algorithm=o.algorithm||o.encAlgorithm||"aes128","useMac"in o||(o.useMac=!0),"localKeyId"in o||(o.localKeyId=null),"generateLocalKeyId"in o||(o.generateLocalKeyId=!0);var c,l=o.localKeyId;if(null!==l)l=n.util.hexToBytes(l);else if(o.generateLocalKeyId)if(t){var u=n.util.isArray(t)?t[0]:t;"string"===typeof u&&(u=s.certificateFromPem(u)),(R=n.md.sha1.create()).update(a.toDer(s.certificateToAsn1(u)).getBytes()),l=R.digest().getBytes()}else l=n.random.getBytes(20);var p=[];null!==l&&p.push(a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.localKeyId).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SET,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,l)])])),"friendlyName"in o&&p.push(a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.friendlyName).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SET,!0,[a.create(a.Class.UNIVERSAL,a.Type.BMPSTRING,!1,o.friendlyName)])])),p.length>0&&(c=a.create(a.Class.UNIVERSAL,a.Type.SET,!0,p));var d=[],f=[];null!==t&&(f=n.util.isArray(t)?t:[t]);for(var y=[],g=0;g<f.length;++g){"string"===typeof(t=f[g])&&(t=s.certificateFromPem(t));var h=0===g?c:void 0,C=s.certificateToAsn1(t),m=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.certBag).getBytes()),a.create(a.Class.CONTEXT_SPECIFIC,0,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.x509Certificate).getBytes()),a.create(a.Class.CONTEXT_SPECIFIC,0,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,a.toDer(C).getBytes())])])]),h]);y.push(m)}if(y.length>0){var v=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,y),E=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.data).getBytes()),a.create(a.Class.CONTEXT_SPECIFIC,0,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,a.toDer(v).getBytes())])]);d.push(E)}var S=null;if(null!==e){var I=s.wrapRsaPrivateKey(s.privateKeyToAsn1(e));S=null===r?a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.keyBag).getBytes()),a.create(a.Class.CONTEXT_SPECIFIC,0,!0,[I]),c]):a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.pkcs8ShroudedKeyBag).getBytes()),a.create(a.Class.CONTEXT_SPECIFIC,0,!0,[s.encryptPrivateKeyInfo(I,r,o)]),c]);var T=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[S]),A=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.data).getBytes()),a.create(a.Class.CONTEXT_SPECIFIC,0,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,a.toDer(T).getBytes())])]);d.push(A)}var N,b=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,d);if(o.useMac){var R=n.md.sha1.create(),L=new n.util.ByteBuffer(n.random.getBytes(o.saltSize)),B=o.count,k=(e=i.generateKey(r,L,3,B,20),n.hmac.create());k.start(R,e),k.update(a.toDer(b).getBytes());var U=k.getMac();N=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.sha1).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")]),a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,U.getBytes())]),a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,L.getBytes()),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,a.integerToDer(B).getBytes())])}return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,a.integerToDer(3).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.data).getBytes()),a.create(a.Class.CONTEXT_SPECIFIC,0,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,a.toDer(b).getBytes())])]),N])},i.generateKey=n.pbe.generatePkcs12Key},49442:function(e,t,r){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var a=r(10550);r(90878),r(29700),r(267),r(28648),r(61684),r(31038),r(13992),r(81903),r(16886);var s=a.asn1,i=e.exports=a.pkcs7=a.pkcs7||{};function o(e){var t={},r=[];if(!s.validate(e,i.asn1.recipientInfoValidator,t,r)){var n=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw n.errors=r,n}return{version:t.version.charCodeAt(0),issuer:a.pki.RDNAttributesAsArray(t.issuer),serialNumber:a.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:s.derToOid(t.encAlgorithm),parameter:t.encParameter.value,content:t.encKey}}}function c(e){for(var t,r=[],n=0;n<e.length;++n)r.push((t=e[n],s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(t.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:t.issuer}),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,a.util.hexToBytes(t.serialNumber))]),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.encryptedContent.algorithm).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,t.encryptedContent.content)])));return r}function l(e){var t=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:e.issuer}),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,a.util.hexToBytes(e.serialNumber))]),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.digestAlgorithm).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.signatureAlgorithm).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])),t.value.push(s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var r=s.create(s.Class.CONTEXT_SPECIFIC,1,!0,[]),n=0;n<e.unauthenticatedAttributes.length;++n){var i=e.unauthenticatedAttributes[n];r.values.push(u(i))}t.value.push(r)}return t}function u(e){var t;if(e.type===a.pki.oids.contentType)t=s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.value).getBytes());else if(e.type===a.pki.oids.messageDigest)t=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===a.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),n=new Date("2050-01-01T00:00:00Z"),i=e.value;if("string"===typeof i){var o=Date.parse(i);i=isNaN(o)?13===i.length?s.utcTimeToDate(i):s.generalizedTimeToDate(i):new Date(o)}t=i>=r&&i<n?s.create(s.Class.UNIVERSAL,s.Type.UTCTIME,!1,s.dateToUtcTime(i)):s.create(s.Class.UNIVERSAL,s.Type.GENERALIZEDTIME,!1,s.dateToGeneralizedTime(i))}return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.type).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,[t])])}function p(e,t,r){var n={};if(!s.validate(t,r,n,[])){var i=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw i.errors=i,i}if(s.derToOid(n.contentType)!==a.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(n.encryptedContent){var o="";if(a.util.isArray(n.encryptedContent))for(var c=0;c<n.encryptedContent.length;++c){if(n.encryptedContent[c].type!==s.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");o+=n.encryptedContent[c].value}else o=n.encryptedContent;e.encryptedContent={algorithm:s.derToOid(n.encAlgorithm),parameter:a.util.createBuffer(n.encParameter.value),content:a.util.createBuffer(o)}}if(n.content){o="";if(a.util.isArray(n.content))for(c=0;c<n.content.length;++c){if(n.content[c].type!==s.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");o+=n.content[c].value}else o=n.content;e.content=a.util.createBuffer(o)}return e.version=n.version.charCodeAt(0),e.rawCapture=n,n}function d(e){if(void 0===e.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===e.content){var t;switch(e.encryptedContent.algorithm){case a.pki.oids["aes128-CBC"]:case a.pki.oids["aes192-CBC"]:case a.pki.oids["aes256-CBC"]:t=a.aes.createDecryptionCipher(e.encryptedContent.key);break;case a.pki.oids.desCBC:case a.pki.oids["des-EDE3-CBC"]:t=a.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}i.messageFromPem=function(e){var t=a.pem.decode(e)[0];if("PKCS7"!==t.type){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var n=s.fromDer(t.body);return i.messageFromAsn1(n)},i.messageToPem=function(e,t){var r={type:"PKCS7",body:s.toDer(e.toAsn1()).getBytes()};return a.pem.encode(r,{maxline:t})},i.messageFromAsn1=function(e){var t={},r=[];if(!s.validate(e,i.asn1.contentInfoValidator,t,r)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw n.errors=r,n}var o,c=s.derToOid(t.contentType);switch(c){case a.pki.oids.envelopedData:o=i.createEnvelopedData();break;case a.pki.oids.encryptedData:o=i.createEncryptedData();break;case a.pki.oids.signedData:o=i.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+c+" is not (yet) supported.")}return o.fromAsn1(t.content.value[0]),o},i.createSignedData=function(){var e=null;return e={type:a.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){if(p(e,t,i.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var r=e.rawCapture.certificates.value,n=0;n<r.length;++n)e.certificates.push(a.pki.certificateFromAsn1(r[n]))},toAsn1:function(){e.contentInfo||e.sign();for(var t=[],r=0;r<e.certificates.length;++r)t.push(a.pki.certificateToAsn1(e.certificates[r]));var n=[],i=s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return t.length>0&&i.value[0].value.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!0,t)),n.length>0&&i.value[0].value.push(s.create(s.Class.CONTEXT_SPECIFIC,1,!0,n)),i.value[0].value.push(s.create(s.Class.UNIVERSAL,s.Type.SET,!0,e.signerInfos)),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.type).getBytes()),i])},addSigner:function(t){var r=t.issuer,n=t.serialNumber;if(t.certificate){var s=t.certificate;"string"===typeof s&&(s=a.pki.certificateFromPem(s)),r=s.issuer.attributes,n=s.serialNumber}var i=t.key;if(!i)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"===typeof i&&(i=a.pki.privateKeyFromPem(i));var o=t.digestAlgorithm||a.pki.oids.sha1;switch(o){case a.pki.oids.sha1:case a.pki.oids.sha256:case a.pki.oids.sha384:case a.pki.oids.sha512:case a.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+o)}var c=t.authenticatedAttributes||[];if(c.length>0){for(var l=!1,u=!1,p=0;p<c.length;++p){var d=c[p];if(l||d.type!==a.pki.oids.contentType){if(u||d.type!==a.pki.oids.messageDigest);else if(u=!0,l)break}else if(l=!0,u)break}if(!l||!u)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:i,version:1,issuer:r,serialNumber:n,digestAlgorithm:o,signatureAlgorithm:a.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:c,unauthenticatedAttributes:[]})},sign:function(t){var r;(t=t||{},"object"!==n(e.content)||null===e.contentInfo)&&(e.contentInfo=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(a.pki.oids.data).getBytes())]),"content"in e&&(e.content instanceof a.util.ByteBuffer?r=e.content.bytes():"string"===typeof e.content&&(r=a.util.encodeUtf8(e.content)),t.detached?e.detachedContent=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,r):e.contentInfo.value.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,r)]))));0!==e.signers.length&&function(t){var r;r=e.detachedContent?e.detachedContent:(r=e.contentInfo.value[1]).value[0];if(!r)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var n=s.derToOid(e.contentInfo.value[0].value),i=s.toDer(r);for(var o in i.getByte(),s.getBerValueLength(i),i=i.getBytes(),t)t[o].start().update(i);for(var c=new Date,p=0;p<e.signers.length;++p){var d=e.signers[p];if(0===d.authenticatedAttributes.length){if(n!==a.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{d.authenticatedAttributesAsn1=s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var f=s.create(s.Class.UNIVERSAL,s.Type.SET,!0,[]),y=0;y<d.authenticatedAttributes.length;++y){var g=d.authenticatedAttributes[y];g.type===a.pki.oids.messageDigest?g.value=t[d.digestAlgorithm].digest():g.type===a.pki.oids.signingTime&&(g.value||(g.value=c)),f.value.push(u(g)),d.authenticatedAttributesAsn1.value.push(u(g))}i=s.toDer(f).getBytes(),d.md.start().update(i)}d.signature=d.key.sign(d.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=function(e){for(var t=[],r=0;r<e.length;++r)t.push(l(e[r]));return t}(e.signers)}(function(){for(var t={},r=0;r<e.signers.length;++r){var n=e.signers[r];(i=n.digestAlgorithm)in t||(t[i]=a.md[a.pki.oids[i]].create()),0===n.authenticatedAttributes.length?n.md=t[i]:n.md=a.md[a.pki.oids[i]].create()}for(var i in e.digestAlgorithmIdentifiers=[],t)e.digestAlgorithmIdentifiers.push(s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(i).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]));return t}())},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){"string"===typeof t&&(t=a.pki.certificateFromPem(t)),e.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}}},i.createEncryptedData=function(){var e=null;return e={type:a.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(t){p(e,t,i.asn1.encryptedDataValidator)},decrypt:function(t){void 0!==t&&(e.encryptedContent.key=t),d(e)}}},i.createEnvelopedData=function(){var e=null;return e={type:a.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(t){var r=p(e,t,i.asn1.envelopedDataValidator);e.recipients=function(e){for(var t=[],r=0;r<e.length;++r)t.push(o(e[r]));return t}(r.recipientInfos.value)},toAsn1:function(){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.type).getBytes()),s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,c(e.recipients)),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,(t=e.encryptedContent,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(a.pki.oids.data).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.algorithm).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,t.parameter.getBytes())]),s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,t.content.getBytes())])]))])])]);var t},findRecipient:function(t){for(var r=t.issuer.attributes,n=0;n<e.recipients.length;++n){var a=e.recipients[n],s=a.issuer;if(a.serialNumber===t.serialNumber&&s.length===r.length){for(var i=!0,o=0;o<r.length;++o)if(s[o].type!==r[o].type||s[o].value!==r[o].value){i=!1;break}if(i)return a}}return null},decrypt:function(t,r){if(void 0===e.encryptedContent.key&&void 0!==t&&void 0!==r)switch(t.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:case a.pki.oids.desCBC:var n=r.decrypt(t.encryptedContent.content);e.encryptedContent.key=a.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}d(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:a.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,r){if(void 0===e.encryptedContent.content){var n,s,i;switch(r=r||e.encryptedContent.algorithm,t=t||e.encryptedContent.key,r){case a.pki.oids["aes128-CBC"]:n=16,s=16,i=a.aes.createEncryptionCipher;break;case a.pki.oids["aes192-CBC"]:n=24,s=16,i=a.aes.createEncryptionCipher;break;case a.pki.oids["aes256-CBC"]:n=32,s=16,i=a.aes.createEncryptionCipher;break;case a.pki.oids["des-EDE3-CBC"]:n=24,s=8,i=a.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(void 0===t)t=a.util.createBuffer(a.random.getBytes(n));else if(t.length()!=n)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+n+".");e.encryptedContent.algorithm=r,e.encryptedContent.key=t,e.encryptedContent.parameter=a.util.createBuffer(a.random.getBytes(s));var o=i(t);if(o.start(e.encryptedContent.parameter.copy()),o.update(e.content),!o.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=o.output}for(var c=0;c<e.recipients.length;++c){var l=e.recipients[c];if(void 0===l.encryptedContent.content){if(l.encryptedContent.algorithm!==a.pki.oids.rsaEncryption)throw new Error("Unsupported asymmetric cipher, OID "+l.encryptedContent.algorithm);l.encryptedContent.content=l.encryptedContent.key.encrypt(e.encryptedContent.key.data)}}}}}},31038:function(e,t,r){var n=r(10550);r(29700),r(81903);var a=n.asn1,s=e.exports=n.pkcs7asn1=n.pkcs7asn1||{};n.pkcs7=n.pkcs7||{},n.pkcs7.asn1=s;var i={name:"ContentInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:a.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};s.contentInfoValidator=i;var o={name:"EncryptedContentInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:a.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:a.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};s.envelopedDataValidator={name:"EnvelopedData",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:a.Class.UNIVERSAL,type:a.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(o)},s.encryptedDataValidator={name:"EncryptedData",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"version"}].concat(o)};var c={name:"SignerInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:a.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:a.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:a.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};s.signedDataValidator={name:"SignedData",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:a.Class.UNIVERSAL,type:a.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},i,{name:"SignedData.Certificates",tagClass:a.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:a.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:a.Class.UNIVERSAL,type:a.Type.SET,capture:"signerInfos",optional:!0,value:[c]}]},s.recipientInfoValidator={name:"RecipientInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:a.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},2096:function(e,t,r){var n=r(10550);r(29700),r(28648),r(45831),r(61684),r(53323),r(65009),r(39010),r(44109),r(81903),r(16886);var a=n.asn1,s=e.exports=n.pki=n.pki||{};s.pemToDer=function(e){var t=n.pem.decode(e)[0];if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return n.util.createBuffer(t.body)},s.privateKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("PRIVATE KEY"!==t.type&&"RSA PRIVATE KEY"!==t.type){var r=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var i=a.fromDer(t.body);return s.privateKeyFromAsn1(i)},s.privateKeyToPem=function(e,t){var r={type:"RSA PRIVATE KEY",body:a.toDer(s.privateKeyToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},s.privateKeyInfoToPem=function(e,t){var r={type:"PRIVATE KEY",body:a.toDer(e).getBytes()};return n.pem.encode(r,{maxline:t})}},33255:function(e,t,r){var n=r(10550);r(81903),r(50452),r(13992),function(){if(n.prime)e.exports=n.prime;else{var t=e.exports=n.prime=n.prime||{},r=n.jsbn.BigInteger,a=[6,4,2,4,2,4,6,2],s=new r(null);s.fromInt(30);var i=function(e,t){return e|t};t.generateProbablePrime=function(e,t,a){"function"===typeof t&&(a=t,t={});var s=(t=t||{}).algorithm||"PRIMEINC";"string"===typeof s&&(s={name:s}),s.options=s.options||{};var i=t.prng||n.random,c={nextBytes:function(e){for(var t=i.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}};if("PRIMEINC"===s.name)return function(e,t,a,s){if("workers"in a)return function(e,t,a,s){if("undefined"===typeof Worker)return o(e,t,a,s);var i=l(e,t),c=a.workers,u=a.workLoad||100,p=30*u/8,d=a.workerScript||"forge/prime.worker.js";if(-1===c)return n.util.estimateCores((function(e,t){e&&(t=2),c=t-1,f()}));function f(){c=Math.max(1,c);for(var n=[],a=0;a<c;++a)n[a]=new Worker(d);for(a=0;a<c;++a)n[a].addEventListener("message",f);var o=!1;function f(a){if(!o){0;var c=a.data;if(c.found){for(var d=0;d<n.length;++d)n[d].terminate();return o=!0,s(null,new r(c.prime,16))}i.bitLength()>e&&(i=l(e,t));var f=i.toString(16);a.target.postMessage({hex:f,workLoad:u}),i.dAddOffset(p,0)}}}f()}(e,t,a,s);return o(e,t,a,s)}(e,c,s.options,a);throw new Error("Invalid prime generation algorithm: "+s.name)}}function o(e,t,r,n){var a=l(e,t),s=function(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}(a.bitLength());"millerRabinTests"in r&&(s=r.millerRabinTests);var i=10;"maxBlockTime"in r&&(i=r.maxBlockTime),c(a,e,t,0,s,i,n)}function c(e,t,r,s,i,o,u){var p=+new Date;do{if(e.bitLength()>t&&(e=l(t,r)),e.isProbablePrime(i))return u(null,e);e.dAddOffset(a[s++%8],0)}while(o<0||+new Date-p<o);n.util.setImmediate((function(){c(e,t,r,s,i,o,u)}))}function l(e,t){var n=new r(e,t),a=e-1;return n.testBit(a)||n.bitwiseTo(r.ONE.shiftLeft(a),i,n),n.dAddOffset(31-n.mod(s).byteValue(),0),n}}()},97381:function(e,t,r){var n=r(81602),a=r(10550);r(81903);var s=null;!a.util.isNodejs||a.options.usePureJavaScript||n.versions["node-webkit"]||(s=r(25819)),(e.exports=a.prng=a.prng||{}).create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();function o(){if(t.pools[0].messageLength>=32)return c();var e=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(e)),c()}function c(){t.reseeds=4294967295===t.reseeds?0:t.reseeds+1;var e=t.plugin.md.create();e.update(t.keyBytes);for(var r=1,n=0;n<32;++n)t.reseeds%r===0&&(e.update(t.pools[n].digest().getBytes()),t.pools[n].start()),r<<=1;t.keyBytes=e.digest().getBytes(),e.start(),e.update(t.keyBytes);var a=e.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(a),t.generated=0}function l(e){var t=null,r=a.util.globalScope,n=r.crypto||r.msCrypto;n&&n.getRandomValues&&(t=function(e){return n.getRandomValues(e)});var s=a.util.createBuffer();if(t)for(;s.length()<e;){var i=Math.max(1,Math.min(e-s.length(),65536)/4),o=new Uint32Array(Math.floor(i));try{t(o);for(var c=0;c<o.length;++c)s.putInt32(o[c])}catch(e){if(!("undefined"!==typeof QuotaExceededError&&e instanceof QuotaExceededError))throw e}}if(s.length()<e)for(var l,u,p,d=Math.floor(65536*Math.random());s.length()<e;){u=16807*(65535&d),u+=(32767&(l=16807*(d>>16)))<<16,d=4294967295&(u=(2147483647&(u+=l>>15))+(u>>31));for(c=0;c<3;++c)p=d>>>(c<<3),p^=Math.floor(256*Math.random()),s.putByte(String.fromCharCode(255&p))}return s.getBytes(e)}return t.pools=n,t.pool=0,t.generate=function(e,r){if(!r)return t.generateSync(e);var n=t.plugin.cipher,s=t.plugin.increment,i=t.plugin.formatKey,o=t.plugin.formatSeed,l=a.util.createBuffer();t.key=null,function u(p){if(p)return r(p);if(l.length()>=e)return r(null,l.getBytes(e));t.generated>1048575&&(t.key=null);if(null===t.key)return a.util.nextTick((function(){!function(e){if(t.pools[0].messageLength>=32)return c(),e();var r=32-t.pools[0].messageLength<<5;t.seedFile(r,(function(r,n){if(r)return e(r);t.collect(n),c(),e()}))}(u)}));var d=n(t.key,t.seed);t.generated+=d.length,l.putBytes(d),t.key=i(n(t.key,s(t.seed))),t.seed=o(n(t.key,t.seed)),a.util.setImmediate(u)}()},t.generateSync=function(e){var r=t.plugin.cipher,n=t.plugin.increment,s=t.plugin.formatKey,i=t.plugin.formatSeed;t.key=null;for(var c=a.util.createBuffer();c.length()<e;){t.generated>1048575&&(t.key=null),null===t.key&&o();var l=r(t.key,t.seed);t.generated+=l.length,c.putBytes(l),t.key=s(r(t.key,n(t.seed))),t.seed=i(r(t.key,t.seed))}return c.getBytes(e)},s?(t.seedFile=function(e,t){s.randomBytes(e,(function(e,r){if(e)return t(e);t(null,r.toString())}))},t.seedFileSync=function(e){return s.randomBytes(e).toString()}):(t.seedFile=function(e,t){try{t(null,l(e))}catch(e){t(e)}},t.seedFileSync=l),t.collect=function(e){for(var r=e.length,n=0;n<r;++n)t.pools[t.pool].update(e.substr(n,1)),t.pool=31===t.pool?0:t.pool+1},t.collectInt=function(e,r){for(var n="",a=0;a<r;a+=8)n+=String.fromCharCode(e>>a&255);t.collect(n)},t.registerWorker=function(e){if(e===self)t.seedFile=function(e,t){self.addEventListener("message",(function e(r){var n=r.data;n.forge&&n.forge.prng&&(self.removeEventListener("message",e),t(n.forge.prng.err,n.forge.prng.bytes))})),self.postMessage({forge:{prng:{needed:e}}})};else{e.addEventListener("message",(function(r){var n=r.data;n.forge&&n.forge.prng&&t.seedFile(n.forge.prng.needed,(function(t,r){e.postMessage({forge:{prng:{err:t,bytes:r}}})}))}))}},t}},39010:function(e,t,r){var n=r(10550);r(13992),r(81903),(e.exports=n.pss=n.pss||{}).create=function(e){3===arguments.length&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t,r=e.md,a=e.mgf,s=r.digestLength,i=e.salt||null;if("string"===typeof i&&(i=n.util.createBuffer(i)),"saltLength"in e)t=e.saltLength;else{if(null===i)throw new Error("Salt length not specified or specific salt not given.");t=i.length()}if(null!==i&&i.length()!==t)throw new Error("Given salt length does not match length of given salt.");var o=e.prng||n.random,c={encode:function(e,c){var l,u,p=c-1,d=Math.ceil(p/8),f=e.digest().getBytes();if(d<s+t+2)throw new Error("Message is too long to encrypt.");u=null===i?o.getBytesSync(t):i.bytes();var y=new n.util.ByteBuffer;y.fillWithByte(0,8),y.putBytes(f),y.putBytes(u),r.start(),r.update(y.getBytes());var g=r.digest().getBytes(),h=new n.util.ByteBuffer;h.fillWithByte(0,d-t-s-2),h.putByte(1),h.putBytes(u);var C=h.getBytes(),m=d-s-1,v=a.generate(g,m),E="";for(l=0;l<m;l++)E+=String.fromCharCode(C.charCodeAt(l)^v.charCodeAt(l));var S=65280>>8*d-p&255;return(E=String.fromCharCode(E.charCodeAt(0)&~S)+E.substr(1))+g+String.fromCharCode(188)},verify:function(e,i,o){var c,l=o-1,u=Math.ceil(l/8);if(i=i.substr(-u),u<s+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==i.charCodeAt(u-1))throw new Error("Encoded message does not end in 0xBC.");var p=u-s-1,d=i.substr(0,p),f=i.substr(p,s),y=65280>>8*u-l&255;if(0!==(d.charCodeAt(0)&y))throw new Error("Bits beyond keysize not zero as expected.");var g=a.generate(f,p),h="";for(c=0;c<p;c++)h+=String.fromCharCode(d.charCodeAt(c)^g.charCodeAt(c));h=String.fromCharCode(h.charCodeAt(0)&~y)+h.substr(1);var C=u-s-t-2;for(c=0;c<C;c++)if(0!==h.charCodeAt(c))throw new Error("Leftmost octets not zero as expected");if(1!==h.charCodeAt(C))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var m=h.substr(-t),v=new n.util.ByteBuffer;return v.fillWithByte(0,8),v.putBytes(e),v.putBytes(m),r.start(),r.update(v.getBytes()),f===r.digest().getBytes()}};return c}},13992:function(e,t,r){var n=r(10550);r(90878),r(11234),r(97381),r(81903),n.random&&n.random.getBytes?e.exports=n.random:function(t){var r={},a=new Array(4),s=n.util.createBuffer();function i(){var e=n.prng.create(r);return e.getBytes=function(t,r){return e.generate(t,r)},e.getBytesSync=function(t){return e.generate(t)},e}r.formatKey=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),n.aes._expandKey(e,!1)},r.formatSeed=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},r.cipher=function(e,t){return n.aes._updateBlock(e,t,a,!1),s.putInt32(a[0]),s.putInt32(a[1]),s.putInt32(a[2]),s.putInt32(a[3]),s.getBytes()},r.increment=function(e){return++e[3],e},r.md=n.md.sha256;var o=i(),c=null,l=n.util.globalScope,u=l.crypto||l.msCrypto;if(u&&u.getRandomValues&&(c=function(e){return u.getRandomValues(e)}),n.options.usePureJavaScript||!n.util.isNodejs&&!c){if(window.document,o.collectInt(+new Date,32),"undefined"!==typeof navigator){var p="";for(var d in navigator)try{"string"==typeof navigator[d]&&(p+=navigator[d])}catch(e){}o.collect(p),p=null}t&&(t().mousemove((function(e){o.collectInt(e.clientX,16),o.collectInt(e.clientY,16)})),t().keypress((function(e){o.collectInt(e.charCode,8)})))}if(n.random)for(var d in o)n.random[d]=o[d];else n.random=o;n.random.createInstance=i,e.exports=n.random}("undefined"!==typeof jQuery?jQuery:null)},640:function(e,t,r){var n=r(10550);r(81903);var a=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],s=[1,2,3,5],i=function(e,t){return e<<t&65535|(65535&e)>>16-t},o=function(e,t){return(65535&e)>>t|e<<16-t&65535};e.exports=n.rc2=n.rc2||{},n.rc2.expandKey=function(e,t){"string"===typeof e&&(e=n.util.createBuffer(e)),t=t||128;var r,s=e,i=e.length(),o=t,c=Math.ceil(o/8),l=255>>(7&o);for(r=i;r<128;r++)s.putByte(a[s.at(r-1)+s.at(r-i)&255]);for(s.setAt(128-c,a[s.at(128-c)&l]),r=127-c;r>=0;r--)s.setAt(r,a[s.at(r+1)^s.at(r+c)]);return s};var c=function(e,t,r){var a,c,l,u,p=!1,d=null,f=null,y=null,g=[];for(e=n.rc2.expandKey(e,t),l=0;l<64;l++)g.push(e.getInt16Le());r?(a=function(e){for(l=0;l<4;l++)e[l]+=g[u]+(e[(l+3)%4]&e[(l+2)%4])+(~e[(l+3)%4]&e[(l+1)%4]),e[l]=i(e[l],s[l]),u++},c=function(e){for(l=0;l<4;l++)e[l]+=g[63&e[(l+3)%4]]}):(a=function(e){for(l=3;l>=0;l--)e[l]=o(e[l],s[l]),e[l]-=g[u]+(e[(l+3)%4]&e[(l+2)%4])+(~e[(l+3)%4]&e[(l+1)%4]),u--},c=function(e){for(l=3;l>=0;l--)e[l]-=g[63&e[(l+3)%4]]});var h=function(e){var t=[];for(l=0;l<4;l++){var n=d.getInt16Le();null!==y&&(r?n^=y.getInt16Le():y.putInt16Le(n)),t.push(65535&n)}u=r?0:63;for(var a=0;a<e.length;a++)for(var s=0;s<e[a][0];s++)e[a][1](t);for(l=0;l<4;l++)null!==y&&(r?y.putInt16Le(t[l]):t[l]^=y.getInt16Le()),f.putInt16Le(t[l])},C=null;return C={start:function(e,t){e&&"string"===typeof e&&(e=n.util.createBuffer(e)),p=!1,d=n.util.createBuffer(),f=t||new n.util.createBuffer,y=e,C.output=f},update:function(e){for(p||d.putBuffer(e);d.length()>=8;)h([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(e){var t=!0;if(r)if(e)t=e(8,d,!r);else{var n=8===d.length()?8:8-d.length();d.fillWithByte(n,n)}if(t&&(p=!0,C.update()),!r&&(t=0===d.length()))if(e)t=e(8,f,!r);else{var a=f.length(),s=f.at(a-1);s>a?t=!1:f.truncate(s)}return t}}};n.rc2.startEncrypting=function(e,t,r){var a=n.rc2.createEncryptionCipher(e,128);return a.start(t,r),a},n.rc2.createEncryptionCipher=function(e,t){return c(e,t,!0)},n.rc2.startDecrypting=function(e,t,r){var a=n.rc2.createDecryptionCipher(e,128);return a.start(t,r),a},n.rc2.createDecryptionCipher=function(e,t){return c(e,t,!1)}},44109:function(e,t,r){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var a=r(10550);if(r(29700),r(50452),r(28648),r(58681),r(33255),r(13992),r(81903),"undefined"===typeof s)var s=a.jsbn.BigInteger;var i=a.util.isNodejs?r(25819):null,o=a.asn1,c=a.util;a.pki=a.pki||{},e.exports=a.pki.rsa=a.rsa=a.rsa||{};var l=a.pki,u=[6,4,2,4,2,4,6,2],p={name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},d={name:"RSAPrivateKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},f={name:"RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},y=a.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},g=function(e){var t;if(!(e.algorithm in l.oids)){var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}t=l.oids[e.algorithm];var n=o.oidToDer(t).getBytes(),a=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),s=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);s.value.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,n)),s.value.push(o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,""));var i=o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,e.digest().getBytes());return a.value.push(s),a.value.push(i),o.toDer(a).getBytes()},h=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);var n;t.dP||(t.dP=t.d.mod(t.p.subtract(s.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(s.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));do{n=new s(a.util.bytesToHex(a.random.getBytes(t.n.bitLength()/8)),16)}while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(s.ONE));for(var i=(e=e.multiply(n.modPow(t.e,t.n)).mod(t.n)).mod(t.p).modPow(t.dP,t.p),o=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(o)<0;)i=i.add(t.p);var c=i.subtract(o).multiply(t.qInv).mod(t.p).multiply(t.q).add(o);return c=c.multiply(n.modInverse(t.n)).mod(t.n)};function C(e,t,r){var n=a.util.createBuffer(),s=Math.ceil(t.n.bitLength()/8);if(e.length>s-11){var i=new Error("Message is too long for PKCS#1 v1.5 padding.");throw i.length=e.length,i.max=s-11,i}n.putByte(0),n.putByte(r);var o,c=s-3-e.length;if(0===r||1===r){o=0===r?0:255;for(var l=0;l<c;++l)n.putByte(o)}else for(;c>0;){var u=0,p=a.random.getBytes(c);for(l=0;l<c;++l)0===(o=p.charCodeAt(l))?++u:n.putByte(o);c=u}return n.putByte(0),n.putBytes(e),n}function m(e,t,r,n){var s=Math.ceil(t.n.bitLength()/8),i=a.util.createBuffer(e),o=i.getByte(),c=i.getByte();if(0!==o||r&&0!==c&&1!==c||!r&&2!=c||r&&0===c&&"undefined"===typeof n)throw new Error("Encryption block is invalid.");var l=0;if(0===c){l=s-3-n;for(var u=0;u<l;++u)if(0!==i.getByte())throw new Error("Encryption block is invalid.")}else if(1===c)for(l=0;i.length()>1;){if(255!==i.getByte()){--i.read;break}++l}else if(2===c)for(l=0;i.length()>1;){if(0===i.getByte()){--i.read;break}++l}if(0!==i.getByte()||l!==s-3-i.length())throw new Error("Encryption block is invalid.");return i.getBytes()}function v(e,t,r){"function"===typeof t&&(r=t,t={});var n={algorithm:{name:(t=t||{}).algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};function i(){o(e.pBits,(function(t,n){return t?r(t):(e.p=n,null!==e.q?c(t,e.q):void o(e.qBits,c))}))}function o(e,t){a.prime.generateProbablePrime(e,n,t)}function c(t,n){if(t)return r(t);if(e.q=n,e.p.compareTo(e.q)<0){var a=e.p;e.p=e.q,e.q=a}if(0!==e.p.subtract(s.ONE).gcd(e.e).compareTo(s.ONE))return e.p=null,void i();if(0!==e.q.subtract(s.ONE).gcd(e.e).compareTo(s.ONE))return e.q=null,void o(e.qBits,c);if(e.p1=e.p.subtract(s.ONE),e.q1=e.q.subtract(s.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(s.ONE))return e.p=e.q=null,void i();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void o(e.qBits,c);var u=e.e.modInverse(e.phi);e.keys={privateKey:l.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:l.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}"prng"in t&&(n.prng=t.prng),i()}function E(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=a.util.hexToBytes(t);return r.length>1&&(0===r.charCodeAt(0)&&0===(128&r.charCodeAt(1))||255===r.charCodeAt(0)&&128===(128&r.charCodeAt(1)))?r.substr(1):r}function S(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function I(e){return a.util.isNodejs&&"function"===typeof i[e]}function T(e){return"undefined"!==typeof c.globalScope&&"object"===n(c.globalScope.crypto)&&"object"===n(c.globalScope.crypto.subtle)&&"function"===typeof c.globalScope.crypto.subtle[e]}function A(e){return"undefined"!==typeof c.globalScope&&"object"===n(c.globalScope.msCrypto)&&"object"===n(c.globalScope.msCrypto.subtle)&&"function"===typeof c.globalScope.msCrypto.subtle[e]}function N(e){for(var t=a.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}l.rsa.encrypt=function(e,t,r){var n,i=r,o=Math.ceil(t.n.bitLength()/8);!1!==r&&!0!==r?(i=2===r,n=C(e,t,r)):(n=a.util.createBuffer()).putBytes(e);for(var c=new s(n.toHex(),16),l=h(c,t,i).toString(16),u=a.util.createBuffer(),p=o-Math.ceil(l.length/2);p>0;)u.putByte(0),--p;return u.putBytes(a.util.hexToBytes(l)),u.getBytes()},l.rsa.decrypt=function(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var o=new Error("Encrypted message length is invalid.");throw o.length=e.length,o.expected=i,o}var c=new s(a.util.createBuffer(e).toHex(),16);if(c.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var l=h(c,t,r).toString(16),u=a.util.createBuffer(),p=i-Math.ceil(l.length/2);p>0;)u.putByte(0),--p;return u.putBytes(a.util.hexToBytes(l)),!1!==n?m(u.getBytes(),t,r):u.getBytes()},l.rsa.createKeyPairGenerationState=function(e,t,r){"string"===typeof e&&(e=parseInt(e,10)),e=e||2048;var n,i=(r=r||{}).prng||a.random,o={nextBytes:function(e){for(var t=i.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}},c=r.algorithm||"PRIMEINC";if("PRIMEINC"!==c)throw new Error("Invalid key generation algorithm: "+c);return(n={algorithm:c,state:0,bits:e,rng:o,eInt:t||65537,e:new s(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null}).e.fromInt(n.eInt),n},l.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new s(null);r.fromInt(30);for(var n,a=0,i=function(e,t){return e|t},o=+new Date,c=0;null===e.keys&&(t<=0||c<t);){if(0===e.state){var p=null===e.p?e.pBits:e.qBits,d=p-1;0===e.pqState?(e.num=new s(p,e.rng),e.num.testBit(d)||e.num.bitwiseTo(s.ONE.shiftLeft(d),i,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),a=0,++e.pqState):1===e.pqState?e.num.bitLength()>p?e.pqState=0:e.num.isProbablePrime(S(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(u[a++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(s.ONE).gcd(e.e).compareTo(s.ONE)?3:0:3===e.pqState&&(e.pqState=0,null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state,e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(s.ONE),e.q1=e.q.subtract(s.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(s.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var f=e.e.modInverse(e.phi);e.keys={privateKey:l.rsa.setPrivateKey(e.n,e.e,f,e.p,e.q,f.mod(e.p1),f.mod(e.q1),e.q.modInverse(e.p)),publicKey:l.rsa.setPublicKey(e.n,e.e)}}c+=(n=+new Date)-o,o=n}return null!==e.keys},l.rsa.generateKeyPair=function(e,t,r,s){if(1===arguments.length?"object"===n(e)?(r=e,e=void 0):"function"===typeof e&&(s=e,e=void 0):2===arguments.length?"number"===typeof e?"function"===typeof t?(s=t,t=void 0):"number"!==typeof t&&(r=t,t=void 0):(r=e,s=t,e=void 0,t=void 0):3===arguments.length&&("number"===typeof t?"function"===typeof r&&(s=r,r=void 0):(s=r,r=t,t=void 0)),r=r||{},void 0===e&&(e=r.bits||2048),void 0===t&&(t=r.e||65537),!a.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(65537===t||3===t))if(s){if(I("generateKeyPair"))return i.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},(function(e,t,r){if(e)return s(e);s(null,{privateKey:l.privateKeyFromPem(r),publicKey:l.publicKeyFromPem(t)})}));if(T("generateKey")&&T("exportKey"))return c.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:N(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then((function(e){return c.globalScope.crypto.subtle.exportKey("pkcs8",e.privateKey)})).then(void 0,(function(e){s(e)})).then((function(e){if(e){var t=l.privateKeyFromAsn1(o.fromDer(a.util.createBuffer(e)));s(null,{privateKey:t,publicKey:l.setRsaPublicKey(t.n,t.e)})}}));if(A("generateKey")&&A("exportKey")){var u=c.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:N(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);return u.oncomplete=function(e){var t=e.target.result,r=c.globalScope.msCrypto.subtle.exportKey("pkcs8",t.privateKey);r.oncomplete=function(e){var t=e.target.result,r=l.privateKeyFromAsn1(o.fromDer(a.util.createBuffer(t)));s(null,{privateKey:r,publicKey:l.setRsaPublicKey(r.n,r.e)})},r.onerror=function(e){s(e)}},void(u.onerror=function(e){s(e)})}}else if(I("generateKeyPairSync")){var p=i.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:l.privateKeyFromPem(p.privateKey),publicKey:l.publicKeyFromPem(p.publicKey)}}var d=l.rsa.createKeyPairGenerationState(e,t,r);if(!s)return l.rsa.stepKeyPairGenerationState(d,0),d.keys;v(d,r,s)},l.setRsaPublicKey=l.rsa.setPublicKey=function(e,t){var r={n:e,e:t,encrypt:function(e,t,n){if("string"===typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===t)t={encode:function(e,t,r){return C(e,t,2).getBytes()}};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={encode:function(e,t){return a.pkcs1.encode_rsa_oaep(t,e,n)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(t))t={encode:function(e){return e}};else if("string"===typeof t)throw new Error('Unsupported encryption scheme: "'+t+'".');var s=t.encode(e,r,!0);return l.rsa.encrypt(s,r,!0)},verify:function(e,t,n){"string"===typeof n?n=n.toUpperCase():void 0===n&&(n="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===n?n={verify:function(e,t){return t=m(t,r,!0),e===o.fromDer(t).value[1].value}}:"NONE"!==n&&"NULL"!==n&&null!==n||(n={verify:function(e,t){return e===(t=m(t,r,!0))}});var a=l.rsa.decrypt(t,r,!0,!1);return n.verify(e,a,r.n.bitLength())}};return r},l.setRsaPrivateKey=l.rsa.setPrivateKey=function(e,t,r,n,s,i,o,c){var u={n:e,e:t,d:r,p:n,q:s,dP:i,dQ:o,qInv:c,decrypt:function(e,t,r){"string"===typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5");var n=l.rsa.decrypt(e,u,!1,!1);if("RSAES-PKCS1-V1_5"===t)t={decode:m};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={decode:function(e,t){return a.pkcs1.decode_rsa_oaep(t,e,r)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(t))throw new Error('Unsupported encryption scheme: "'+t+'".');t={decode:function(e){return e}}}return t.decode(n,u,!1)},sign:function(e,t){var r=!1;"string"===typeof t&&(t=t.toUpperCase()),void 0===t||"RSASSA-PKCS1-V1_5"===t?(t={encode:g},r=1):"NONE"!==t&&"NULL"!==t&&null!==t||(t={encode:function(){return e}},r=1);var n=t.encode(e,u.n.bitLength());return l.rsa.encrypt(n,u,r)}};return u},l.wrapRsaPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(l.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(e).getBytes())])},l.privateKeyFromAsn1=function(e){var t,r,n,i,c,u,f,y,g={},h=[];if(o.validate(e,p,g,h)&&(e=o.fromDer(a.util.createBuffer(g.privateKey))),g={},h=[],!o.validate(e,d,g,h)){var C=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw C.errors=h,C}return t=a.util.createBuffer(g.privateKeyModulus).toHex(),r=a.util.createBuffer(g.privateKeyPublicExponent).toHex(),n=a.util.createBuffer(g.privateKeyPrivateExponent).toHex(),i=a.util.createBuffer(g.privateKeyPrime1).toHex(),c=a.util.createBuffer(g.privateKeyPrime2).toHex(),u=a.util.createBuffer(g.privateKeyExponent1).toHex(),f=a.util.createBuffer(g.privateKeyExponent2).toHex(),y=a.util.createBuffer(g.privateKeyCoefficient).toHex(),l.setRsaPrivateKey(new s(t,16),new s(r,16),new s(n,16),new s(i,16),new s(c,16),new s(u,16),new s(f,16),new s(y,16))},l.privateKeyToAsn1=l.privateKeyToRSAPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.e)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.d)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.p)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.q)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.dP)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.dQ)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.qInv))])},l.publicKeyFromAsn1=function(e){var t={},r=[];if(o.validate(e,y,t,r)){var n,i=o.derToOid(t.publicKeyOid);if(i!==l.oids.rsaEncryption)throw(n=new Error("Cannot read public key. Unknown OID.")).oid=i,n;e=t.rsaPublicKey}if(r=[],!o.validate(e,f,t,r))throw(n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.")).errors=r,n;var c=a.util.createBuffer(t.publicKeyModulus).toHex(),u=a.util.createBuffer(t.publicKeyExponent).toHex();return l.setRsaPublicKey(new s(c,16),new s(u,16))},l.publicKeyToAsn1=l.publicKeyToSubjectPublicKeyInfo=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(l.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,[l.publicKeyToRSAPublicKey(e)])])},l.publicKeyToRSAPublicKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.e))])}},83726:function(e,t,r){var n=r(10550);r(49659),r(81903);var a=e.exports=n.sha1=n.sha1||{};n.md.sha1=n.md.algorithms.sha1=a,a.create=function(){i||(s=String.fromCharCode(128),s+=n.util.fillString(String.fromCharCode(0),64),i=!0);var e=null,t=n.util.createBuffer(),r=new Array(80),a={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){a.messageLength=0,a.fullMessageLength=a.messageLength64=[];for(var r=a.messageLengthSize/4,s=0;s<r;++s)a.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},a}};return a.start(),a.update=function(s,i){"utf8"===i&&(s=n.util.encodeUtf8(s));var c=s.length;a.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var l=a.fullMessageLength.length-1;l>=0;--l)a.fullMessageLength[l]+=c[1],c[1]=c[0]+(a.fullMessageLength[l]/4294967296>>>0),a.fullMessageLength[l]=a.fullMessageLength[l]>>>0,c[0]=c[1]/4294967296>>>0;return t.putBytes(s),o(e,r,t),(t.read>2048||0===t.length())&&t.compact(),a},a.digest=function(){var i=n.util.createBuffer();i.putBytes(t.bytes());var c,l=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize&a.blockLength-1;i.putBytes(s.substr(0,a.blockLength-l));for(var u=8*a.fullMessageLength[0],p=0;p<a.fullMessageLength.length-1;++p)u+=(c=8*a.fullMessageLength[p+1])/4294967296>>>0,i.putInt32(u>>>0),u=c>>>0;i.putInt32(u);var d={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};o(d,r,i);var f=n.util.createBuffer();return f.putInt32(d.h0),f.putInt32(d.h1),f.putInt32(d.h2),f.putInt32(d.h3),f.putInt32(d.h4),f},a};var s=null,i=!1;function o(e,t,r){for(var n,a,s,i,o,c,l,u=r.length();u>=64;){for(a=e.h0,s=e.h1,i=e.h2,o=e.h3,c=e.h4,l=0;l<16;++l)n=r.getInt32(),t[l]=n,n=(a<<5|a>>>27)+(o^s&(i^o))+c+1518500249+n,c=o,o=i,i=(s<<30|s>>>2)>>>0,s=a,a=n;for(;l<20;++l)n=(n=t[l-3]^t[l-8]^t[l-14]^t[l-16])<<1|n>>>31,t[l]=n,n=(a<<5|a>>>27)+(o^s&(i^o))+c+1518500249+n,c=o,o=i,i=(s<<30|s>>>2)>>>0,s=a,a=n;for(;l<32;++l)n=(n=t[l-3]^t[l-8]^t[l-14]^t[l-16])<<1|n>>>31,t[l]=n,n=(a<<5|a>>>27)+(s^i^o)+c+1859775393+n,c=o,o=i,i=(s<<30|s>>>2)>>>0,s=a,a=n;for(;l<40;++l)n=(n=t[l-6]^t[l-16]^t[l-28]^t[l-32])<<2|n>>>30,t[l]=n,n=(a<<5|a>>>27)+(s^i^o)+c+1859775393+n,c=o,o=i,i=(s<<30|s>>>2)>>>0,s=a,a=n;for(;l<60;++l)n=(n=t[l-6]^t[l-16]^t[l-28]^t[l-32])<<2|n>>>30,t[l]=n,n=(a<<5|a>>>27)+(s&i|o&(s^i))+c+2400959708+n,c=o,o=i,i=(s<<30|s>>>2)>>>0,s=a,a=n;for(;l<80;++l)n=(n=t[l-6]^t[l-16]^t[l-28]^t[l-32])<<2|n>>>30,t[l]=n,n=(a<<5|a>>>27)+(s^i^o)+c+3395469782+n,c=o,o=i,i=(s<<30|s>>>2)>>>0,s=a,a=n;e.h0=e.h0+a|0,e.h1=e.h1+s|0,e.h2=e.h2+i|0,e.h3=e.h3+o|0,e.h4=e.h4+c|0,u-=64}}},11234:function(e,t,r){var n=r(10550);r(49659),r(81903);var a=e.exports=n.sha256=n.sha256||{};n.md.sha256=n.md.algorithms.sha256=a,a.create=function(){i||(s=String.fromCharCode(128),s+=n.util.fillString(String.fromCharCode(0),64),o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],i=!0);var e=null,t=n.util.createBuffer(),r=new Array(64),a={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){a.messageLength=0,a.fullMessageLength=a.messageLength64=[];for(var r=a.messageLengthSize/4,s=0;s<r;++s)a.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},a}};return a.start(),a.update=function(s,i){"utf8"===i&&(s=n.util.encodeUtf8(s));var o=s.length;a.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var l=a.fullMessageLength.length-1;l>=0;--l)a.fullMessageLength[l]+=o[1],o[1]=o[0]+(a.fullMessageLength[l]/4294967296>>>0),a.fullMessageLength[l]=a.fullMessageLength[l]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(s),c(e,r,t),(t.read>2048||0===t.length())&&t.compact(),a},a.digest=function(){var i=n.util.createBuffer();i.putBytes(t.bytes());var o,l=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize&a.blockLength-1;i.putBytes(s.substr(0,a.blockLength-l));for(var u=8*a.fullMessageLength[0],p=0;p<a.fullMessageLength.length-1;++p)u+=(o=8*a.fullMessageLength[p+1])/4294967296>>>0,i.putInt32(u>>>0),u=o>>>0;i.putInt32(u);var d={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};c(d,r,i);var f=n.util.createBuffer();return f.putInt32(d.h0),f.putInt32(d.h1),f.putInt32(d.h2),f.putInt32(d.h3),f.putInt32(d.h4),f.putInt32(d.h5),f.putInt32(d.h6),f.putInt32(d.h7),f},a};var s=null,i=!1,o=null;function c(e,t,r){for(var n,a,s,i,c,l,u,p,d,f,y,g,h,C=r.length();C>=64;){for(c=0;c<16;++c)t[c]=r.getInt32();for(;c<64;++c)n=((n=t[c-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,a=((a=t[c-15])>>>7|a<<25)^(a>>>18|a<<14)^a>>>3,t[c]=n+t[c-7]+a+t[c-16]|0;for(l=e.h0,u=e.h1,p=e.h2,d=e.h3,f=e.h4,y=e.h5,g=e.h6,h=e.h7,c=0;c<64;++c)s=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),i=l&u|p&(l^u),n=h+((f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(g^f&(y^g))+o[c]+t[c],h=g,g=y,y=f,f=d+n>>>0,d=p,p=u,u=l,l=n+(a=s+i)>>>0;e.h0=e.h0+l|0,e.h1=e.h1+u|0,e.h2=e.h2+p|0,e.h3=e.h3+d|0,e.h4=e.h4+f|0,e.h5=e.h5+y|0,e.h6=e.h6+g|0,e.h7=e.h7+h|0,C-=64}}},25125:function(e,t,r){var n=r(10550);r(49659),r(81903);var a=e.exports=n.sha512=n.sha512||{};n.md.sha512=n.md.algorithms.sha512=a;var s=n.sha384=n.sha512.sha384=n.sha512.sha384||{};s.create=function(){return a.create("SHA-384")},n.md.sha384=n.md.algorithms.sha384=s,n.sha512.sha256=n.sha512.sha256||{create:function(){return a.create("SHA-512/256")}},n.md["sha512/256"]=n.md.algorithms["sha512/256"]=n.sha512.sha256,n.sha512.sha224=n.sha512.sha224||{create:function(){return a.create("SHA-512/224")}},n.md["sha512/224"]=n.md.algorithms["sha512/224"]=n.sha512.sha224,a.create=function(e){if(o||(i=String.fromCharCode(128),i+=n.util.fillString(String.fromCharCode(0),128),c=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],(l={})["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],l["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],l["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],l["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],o=!0),"undefined"===typeof e&&(e="SHA-512"),!(e in l))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=l[e],r=null,a=n.util.createBuffer(),s=new Array(80),p=0;p<80;++p)s[p]=new Array(2);var d=64;switch(e){case"SHA-384":d=48;break;case"SHA-512/256":d=32;break;case"SHA-512/224":d=28}var f={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:d,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){f.messageLength=0,f.fullMessageLength=f.messageLength128=[];for(var e=f.messageLengthSize/4,s=0;s<e;++s)f.fullMessageLength.push(0);a=n.util.createBuffer(),r=new Array(t.length);for(s=0;s<t.length;++s)r[s]=t[s].slice(0);return f}};return f.start(),f.update=function(e,t){"utf8"===t&&(e=n.util.encodeUtf8(e));var i=e.length;f.messageLength+=i,i=[i/4294967296>>>0,i>>>0];for(var o=f.fullMessageLength.length-1;o>=0;--o)f.fullMessageLength[o]+=i[1],i[1]=i[0]+(f.fullMessageLength[o]/4294967296>>>0),f.fullMessageLength[o]=f.fullMessageLength[o]>>>0,i[0]=i[1]/4294967296>>>0;return a.putBytes(e),u(r,s,a),(a.read>2048||0===a.length())&&a.compact(),f},f.digest=function(){var t=n.util.createBuffer();t.putBytes(a.bytes());var o,c=f.fullMessageLength[f.fullMessageLength.length-1]+f.messageLengthSize&f.blockLength-1;t.putBytes(i.substr(0,f.blockLength-c));for(var l=8*f.fullMessageLength[0],p=0;p<f.fullMessageLength.length-1;++p)l+=(o=8*f.fullMessageLength[p+1])/4294967296>>>0,t.putInt32(l>>>0),l=o>>>0;t.putInt32(l);var d=new Array(r.length);for(p=0;p<r.length;++p)d[p]=r[p].slice(0);u(d,s,t);var y,g=n.util.createBuffer();y="SHA-512"===e?d.length:"SHA-384"===e?d.length-2:d.length-4;for(p=0;p<y;++p)g.putInt32(d[p][0]),p===y-1&&"SHA-512/224"===e||g.putInt32(d[p][1]);return g},f};var i=null,o=!1,c=null,l=null;function u(e,t,r){for(var n,a,s,i,o,l,u,p,d,f,y,g,h,C,m,v,E,S,I,T,A,N,b,R,L,B,k,U,w,V,P,K,D,_=r.length();_>=128;){for(k=0;k<16;++k)t[k][0]=r.getInt32()>>>0,t[k][1]=r.getInt32()>>>0;for(;k<80;++k)n=(((U=(V=t[k-2])[0])>>>19|(w=V[1])<<13)^(w>>>29|U<<3)^U>>>6)>>>0,a=((U<<13|w>>>19)^(w<<3|U>>>29)^(U<<26|w>>>6))>>>0,s=(((U=(K=t[k-15])[0])>>>1|(w=K[1])<<31)^(U>>>8|w<<24)^U>>>7)>>>0,i=((U<<31|w>>>1)^(U<<24|w>>>8)^(U<<25|w>>>7))>>>0,P=t[k-7],D=t[k-16],w=a+P[1]+i+D[1],t[k][0]=n+P[0]+s+D[0]+(w/4294967296>>>0)>>>0,t[k][1]=w>>>0;for(y=e[0][0],g=e[0][1],h=e[1][0],C=e[1][1],m=e[2][0],v=e[2][1],E=e[3][0],S=e[3][1],I=e[4][0],T=e[4][1],A=e[5][0],N=e[5][1],b=e[6][0],R=e[6][1],L=e[7][0],B=e[7][1],k=0;k<80;++k)u=((I>>>14|T<<18)^(I>>>18|T<<14)^(T>>>9|I<<23))>>>0,p=(b^I&(A^b))>>>0,o=((y>>>28|g<<4)^(g>>>2|y<<30)^(g>>>7|y<<25))>>>0,l=((y<<4|g>>>28)^(g<<30|y>>>2)^(g<<25|y>>>7))>>>0,d=(y&h|m&(y^h))>>>0,f=(g&C|v&(g^C))>>>0,w=B+(((I<<18|T>>>14)^(I<<14|T>>>18)^(T<<23|I>>>9))>>>0)+((R^T&(N^R))>>>0)+c[k][1]+t[k][1],n=L+u+p+c[k][0]+t[k][0]+(w/4294967296>>>0)>>>0,a=w>>>0,s=o+d+((w=l+f)/4294967296>>>0)>>>0,i=w>>>0,L=b,B=R,b=A,R=N,A=I,N=T,I=E+n+((w=S+a)/4294967296>>>0)>>>0,T=w>>>0,E=m,S=v,m=h,v=C,h=y,C=g,y=n+s+((w=a+i)/4294967296>>>0)>>>0,g=w>>>0;w=e[0][1]+g,e[0][0]=e[0][0]+y+(w/4294967296>>>0)>>>0,e[0][1]=w>>>0,w=e[1][1]+C,e[1][0]=e[1][0]+h+(w/4294967296>>>0)>>>0,e[1][1]=w>>>0,w=e[2][1]+v,e[2][0]=e[2][0]+m+(w/4294967296>>>0)>>>0,e[2][1]=w>>>0,w=e[3][1]+S,e[3][0]=e[3][0]+E+(w/4294967296>>>0)>>>0,e[3][1]=w>>>0,w=e[4][1]+T,e[4][0]=e[4][0]+I+(w/4294967296>>>0)>>>0,e[4][1]=w>>>0,w=e[5][1]+N,e[5][0]=e[5][0]+A+(w/4294967296>>>0)>>>0,e[5][1]=w>>>0,w=e[6][1]+R,e[6][0]=e[6][0]+b+(w/4294967296>>>0)>>>0,e[6][1]=w>>>0,w=e[7][1]+B,e[7][0]=e[7][0]+L+(w/4294967296>>>0)>>>0,e[7][1]=w>>>0,_-=128}}},97314:function(e,t,r){var n=r(10550);r(90878),r(45479),r(4233),r(83726),r(81903);var a=e.exports=n.ssh=n.ssh||{};function s(e,t){var r=t.toString(16);r[0]>="8"&&(r="00"+r);var a=n.util.hexToBytes(r);e.putInt32(a.length),e.putBytes(a)}function i(e,t){e.putInt32(t.length),e.putString(t)}function o(){for(var e=n.md.sha1.create(),t=arguments.length,r=0;r<t;++r)e.update(arguments[r]);return e.digest()}a.privateKeyToPutty=function(e,t,r){var a="ssh-rsa",c=""===(t=t||"")?"none":"aes256-cbc",l="PuTTY-User-Key-File-2: ssh-rsa\r\n";l+="Encryption: "+c+"\r\n",l+="Comment: "+(r=r||"")+"\r\n";var u=n.util.createBuffer();i(u,a),s(u,e.e),s(u,e.n);var p=n.util.encode64(u.bytes(),64),d=Math.floor(p.length/66)+1;l+="Public-Lines: "+d+"\r\n",l+=p;var f,y=n.util.createBuffer();if(s(y,e.d),s(y,e.p),s(y,e.q),s(y,e.qInv),t){var g=y.length()+16-1;g-=g%16;var h=o(y.bytes());h.truncate(h.length()-g+y.length()),y.putBuffer(h);var C=n.util.createBuffer();C.putBuffer(o("\0\0\0\0",t)),C.putBuffer(o("\0\0\0\x01",t));var m=n.aes.createEncryptionCipher(C.truncate(8),"CBC");m.start(n.util.createBuffer().fillWithByte(0,16)),m.update(y.copy()),m.finish();var v=m.output;v.truncate(16),f=n.util.encode64(v.bytes(),64)}else f=n.util.encode64(y.bytes(),64);l+="\r\nPrivate-Lines: "+(d=Math.floor(f.length/66)+1)+"\r\n",l+=f;var E=o("putty-private-key-file-mac-key",t),S=n.util.createBuffer();i(S,a),i(S,c),i(S,r),S.putInt32(u.length()),S.putBuffer(u),S.putInt32(y.length()),S.putBuffer(y);var I=n.hmac.create();return I.start("sha1",E),I.update(S.bytes()),l+="\r\nPrivate-MAC: "+I.digest().toHex()+"\r\n"},a.publicKeyToOpenSSH=function(e,t){var r="ssh-rsa";t=t||"";var a=n.util.createBuffer();return i(a,r),s(a,e.e),s(a,e.n),r+" "+n.util.encode64(a.bytes())+" "+t},a.privateKeyToOpenSSH=function(e,t){return t?n.pki.encryptRsaPrivateKey(e,t,{legacy:!0,algorithm:"aes128"}):n.pki.privateKeyToPem(e)},a.getPublicKeyFingerprint=function(e,t){var r=(t=t||{}).md||n.md.md5.create(),a=n.util.createBuffer();i(a,"ssh-rsa"),s(a,e.e),s(a,e.n),r.start(),r.update(a.getBytes());var o=r.digest();if("hex"===t.encoding){var c=o.toHex();return t.delimiter?c.match(/.{2}/g).join(t.delimiter):c}if("binary"===t.encoding)return o.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".');return o}},35571:function(e,t,r){var n=r(10550);r(99196),r(47847),r(81903);var a="forge.task",s={},i=0;n.debug.set(a,"tasks",s);var o={};n.debug.set(a,"queues",o);var c="ready",l="running",u="blocked",p="sleeping",d="done",f="error",y={ready:{}};y.ready.stop=c,y.ready.start=l,y.ready.cancel=d,y.ready.fail=f,y.running={},y.running.stop=c,y.running.start=l,y.running.block=u,y.running.unblock=l,y.running.sleep=p,y.running.wakeup=l,y.running.cancel=d,y.running.fail=f,y.blocked={},y.blocked.stop=u,y.blocked.start=u,y.blocked.block=u,y.blocked.unblock=u,y.blocked.sleep=u,y.blocked.wakeup=u,y.blocked.cancel=d,y.blocked.fail=f,y.sleeping={},y.sleeping.stop=p,y.sleeping.start=p,y.sleeping.block=p,y.sleeping.unblock=p,y.sleeping.sleep=p,y.sleeping.wakeup=p,y.sleeping.cancel=d,y.sleeping.fail=f,y.done={},y.done.stop=d,y.done.start=d,y.done.block=d,y.done.unblock=d,y.done.sleep=d,y.done.wakeup=d,y.done.cancel=d,y.done.fail=f,y.error={},y.error.stop=f,y.error.start=f,y.error.block=f,y.error.unblock=f,y.error.sleep=f,y.error.wakeup=f,y.error.cancel=f,y.error.fail=f;var g=function(e){this.id=-1,this.name=e.name||"?",this.parent=e.parent||null,this.run=e.run,this.subtasks=[],this.error=!1,this.state=c,this.blocks=0,this.timeoutId=null,this.swapTime=null,this.userData=null,this.id=i++,s[this.id]=this};g.prototype.debug=function(e){e=e||"",n.log.debug(a,e,"[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",o)},g.prototype.next=function(e,t){"function"===typeof e&&(t=e,e=this.name);var r=new g({run:t,name:e,parent:this});return r.state=l,r.type=this.type,r.successCallback=this.successCallback||null,r.failureCallback=this.failureCallback||null,this.subtasks.push(r),this},g.prototype.parallel=function(e,t){return n.util.isArray(e)&&(t=e,e=this.name),this.next(e,(function(r){var a=r;a.block(t.length);for(var s=function(e,r){n.task.start({type:e,run:function(e){t[r](e)},success:function(e){a.unblock()},failure:function(e){a.unblock()}})},i=0;i<t.length;i++){s(e+"__parallel-"+r.id+"-"+i,i)}}))},g.prototype.stop=function(){this.state=y[this.state].stop},g.prototype.start=function(){this.error=!1,this.state=y[this.state].start,this.state===l&&(this.start=new Date,this.run(this),h(this,0))},g.prototype.block=function(e){e="undefined"===typeof e?1:e,this.blocks+=e,this.blocks>0&&(this.state=y[this.state].block)},g.prototype.unblock=function(e){return e="undefined"===typeof e?1:e,this.blocks-=e,0===this.blocks&&this.state!==d&&(this.state=l,h(this,0)),this.blocks},g.prototype.sleep=function(e){e="undefined"===typeof e?0:e,this.state=y[this.state].sleep;var t=this;this.timeoutId=setTimeout((function(){t.timeoutId=null,t.state=l,h(t,0)}),e)},g.prototype.wait=function(e){e.wait(this)},g.prototype.wakeup=function(){this.state===p&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state=l,h(this,0))},g.prototype.cancel=function(){this.state=y[this.state].cancel,this.permitsNeeded=0,null!==this.timeoutId&&(cancelTimeout(this.timeoutId),this.timeoutId=null),this.subtasks=[]},g.prototype.fail=function(e){if(this.error=!0,C(this,!0),e)e.error=this.error,e.swapTime=this.swapTime,e.userData=this.userData,h(e,0);else{if(null!==this.parent){for(var t=this.parent;null!==t.parent;)t.error=this.error,t.swapTime=this.swapTime,t.userData=this.userData,t=t.parent;C(t,!0)}this.failureCallback&&this.failureCallback(this)}};var h=function e(t,r){var n=r>30||+new Date-t.swapTime>20,a=function(r){if(r++,t.state===l)if(n&&(t.swapTime=+new Date),t.subtasks.length>0){var a=t.subtasks.shift();a.error=t.error,a.swapTime=t.swapTime,a.userData=t.userData,a.run(a),a.error||e(a,r)}else C(t),t.error||null!==t.parent&&(t.parent.error=t.error,t.parent.swapTime=t.swapTime,t.parent.userData=t.userData,e(t.parent,r))};n?setTimeout(a,0):a(r)},C=function(e,t){e.state=d,delete s[e.id],null===e.parent&&(e.type in o?0===o[e.type].length?n.log.error(a,"[%s][%s] task queue empty [%s]",e.id,e.name,e.type):o[e.type][0]!==e?n.log.error(a,"[%s][%s] task not first in queue [%s]",e.id,e.name,e.type):(o[e.type].shift(),0===o[e.type].length?delete o[e.type]:o[e.type][0].start()):n.log.error(a,"[%s][%s] task queue missing [%s]",e.id,e.name,e.type),t||(e.error&&e.failureCallback?e.failureCallback(e):!e.error&&e.successCallback&&e.successCallback(e)))};e.exports=n.task=n.task||{},n.task.start=function(e){var t=new g({run:e.run,name:e.name||"?"});t.type=e.type,t.successCallback=e.success||null,t.failureCallback=e.failure||null,t.type in o?o[e.type].push(t):(o[t.type]=[t],function(e){e.error=!1,e.state=y[e.state].start,setTimeout((function(){e.state===l&&(e.swapTime=+new Date,e.run(e),h(e,0))}),0)}(t))},n.task.cancel=function(e){e in o&&(o[e]=[o[e][0]])},n.task.createCondition=function(){var e={tasks:{},wait:function(t){t.id in e.tasks||(t.block(),e.tasks[t.id]=t)},notify:function(){var t=e.tasks;for(var r in e.tasks={},t)t[r].unblock()}};return e}},74867:function(e,t,r){var n=r(63780);r(73937),r(50888),r(91127);var a=e.exports=n.pkcs1=n.pkcs1||{};function s(e,t,r){r||(r=n.md.sha1.create());for(var a="",s=Math.ceil(t/r.digestLength),i=0;i<s;++i){var o=String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,255&i);r.start(),r.update(e+o),a+=r.digest().getBytes()}return a.substring(0,t)}a.encode_rsa_oaep=function(e,t,r){var a,i,o,c;"string"===typeof r?(a=r,i=arguments[3]||void 0,o=arguments[4]||void 0):r&&(a=r.label||void 0,i=r.seed||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(c=r.mgf1.md)),o?o.start():o=n.md.sha1.create(),c||(c=o);var l=Math.ceil(e.n.bitLength()/8),u=l-2*o.digestLength-2;if(t.length>u)throw(h=new Error("RSAES-OAEP input message length is too long.")).length=t.length,h.maxLength=u,h;a||(a=""),o.update(a,"raw");for(var p=o.digest(),d="",f=u-t.length,y=0;y<f;y++)d+="\0";var g=p.getBytes()+d+"\x01"+t;if(i){if(i.length!==o.digestLength){var h;throw(h=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.")).seedLength=i.length,h.digestLength=o.digestLength,h}}else i=n.random.getBytes(o.digestLength);var C=s(i,l-o.digestLength-1,c),m=n.util.xorBytes(g,C,g.length),v=s(m,o.digestLength,c),E=n.util.xorBytes(i,v,i.length);return"\0"+E+m},a.decode_rsa_oaep=function(e,t,r){var a,i,o;"string"===typeof r?(a=r,i=arguments[3]||void 0):r&&(a=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md));var c=Math.ceil(e.n.bitLength()/8);if(t.length!==c)throw(m=new Error("RSAES-OAEP encoded message length is invalid.")).length=t.length,m.expectedLength=c,m;if(void 0===i?i=n.md.sha1.create():i.start(),o||(o=i),c<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");a||(a=""),i.update(a,"raw");for(var l=i.digest().getBytes(),u=t.charAt(0),p=t.substring(1,i.digestLength+1),d=t.substring(1+i.digestLength),f=s(d,i.digestLength,o),y=n.util.xorBytes(p,f,p.length),g=s(y,c-i.digestLength-1,o),h=n.util.xorBytes(d,g,d.length),C=h.substring(0,i.digestLength),m="\0"!==u,v=0;v<i.digestLength;++v)m|=l.charAt(v)!==C.charAt(v);for(var E=1,S=i.digestLength,I=i.digestLength;I<h.length;I++){var T=h.charCodeAt(I),A=1&T^1,N=E?65534:0;m|=T&N,S+=E&=A}if(m||1!==h.charCodeAt(S))throw new Error("Invalid RSAES-OAEP padding.");return h.substring(S+1)}},65066:function(e,t,r){var n=r(63780);r(4056),r(37603),r(29333),r(42763),r(31479),r(50888),r(55147),r(91127),r(73937),r(73690);var a=n.asn1,s=n.pki,i=e.exports=n.pkcs12=n.pkcs12||{},o={name:"ContentInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:a.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},c={name:"PFX",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"version"},o,{name:"PFX.macData",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:a.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},l={name:"SafeBag",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:a.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:a.Class.UNIVERSAL,type:a.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},u={name:"Attribute",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:a.Class.UNIVERSAL,type:a.Type.SET,constructed:!0,capture:"values"}]},p={name:"CertBag",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:a.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:a.Class.UNIVERSAL,type:a.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function d(e,t,r,n){for(var a=[],s=0;s<e.length;s++)for(var i=0;i<e[s].safeBags.length;i++){var o=e[s].safeBags[i];void 0!==n&&o.type!==n||(null!==t?void 0!==o.attributes[t]&&o.attributes[t].indexOf(r)>=0&&a.push(o):a.push(o))}return a}function f(e){if(e.composed||e.constructed){for(var t=n.util.createBuffer(),r=0;r<e.value.length;++r)t.putBytes(e.value[r].value);e.composed=e.constructed=!1,e.value=t.getBytes()}return e}function y(e,t){var r={},i=[];if(!a.validate(e,n.pkcs7.asn1.encryptedDataValidator,r,i))throw(o=new Error("Cannot read EncryptedContentInfo.")).errors=i,o;var o,c=a.derToOid(r.contentType);if(c!==s.oids.data)throw(o=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.")).oid=c,o;c=a.derToOid(r.encAlgorithm);var l=s.pbe.getCipher(c,r.encParameter,t),u=f(r.encryptedContentAsn1),p=n.util.createBuffer(u.value);if(l.update(p),!l.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return l.output.getBytes()}function g(e,t,r){if(!t&&0===e.length)return[];if((e=a.fromDer(e,t)).tagClass!==a.Class.UNIVERSAL||e.type!==a.Type.SEQUENCE||!0!==e.constructed)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],i=0;i<e.value.length;i++){var o=e.value[i],c={},u=[];if(!a.validate(o,l,c,u))throw(C=new Error("Cannot read SafeBag.")).errors=u,C;var d,f,y={type:a.derToOid(c.bagId),attributes:h(c.bagAttributes)};n.push(y);var g=c.bagValue.value[0];switch(y.type){case s.oids.pkcs8ShroudedKeyBag:if(null===(g=s.decryptPrivateKeyInfo(g,r)))throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case s.oids.keyBag:try{y.key=s.privateKeyFromAsn1(g)}catch(e){y.key=null,y.asn1=g}continue;case s.oids.certBag:d=p,f=function(){if(a.derToOid(c.certId)!==s.oids.x509Certificate){var e=new Error("Unsupported certificate type, only X.509 supported.");throw e.oid=a.derToOid(c.certId),e}var r=a.fromDer(c.cert,t);try{y.cert=s.certificateFromAsn1(r,!0)}catch(e){y.cert=null,y.asn1=r}};break;default:var C;throw(C=new Error("Unsupported PKCS#12 SafeBag type.")).oid=y.type,C}if(void 0!==d&&!a.validate(g,d,c,u))throw(C=new Error("Cannot read PKCS#12 "+d.name)).errors=u,C;f()}return n}function h(e){var t={};if(void 0!==e)for(var r=0;r<e.length;++r){var n={},i=[];if(!a.validate(e[r],u,n,i)){var o=new Error("Cannot read PKCS#12 BagAttribute.");throw o.errors=i,o}var c=a.derToOid(n.oid);if(void 0!==s.oids[c]){t[s.oids[c]]=[];for(var l=0;l<n.values.length;++l)t[s.oids[c]].push(n.values[l].value)}}return t}i.pkcs12FromAsn1=function(e,t,r){"string"===typeof t?(r=t,t=!0):void 0===t&&(t=!0);var l={};if(!a.validate(e,c,l,[]))throw(u=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.")).errors=u,u;var u,p={version:l.version.charCodeAt(0),safeContents:[],getBags:function(e){var t,r={};return"localKeyId"in e?t=e.localKeyId:"localKeyIdHex"in e&&(t=n.util.hexToBytes(e.localKeyIdHex)),void 0===t&&!("friendlyName"in e)&&"bagType"in e&&(r[e.bagType]=d(p.safeContents,null,null,e.bagType)),void 0!==t&&(r.localKeyId=d(p.safeContents,"localKeyId",t,e.bagType)),"friendlyName"in e&&(r.friendlyName=d(p.safeContents,"friendlyName",e.friendlyName,e.bagType)),r},getBagsByFriendlyName:function(e,t){return d(p.safeContents,"friendlyName",e,t)},getBagsByLocalKeyId:function(e,t){return d(p.safeContents,"localKeyId",e,t)}};if(3!==l.version.charCodeAt(0))throw(u=new Error("PKCS#12 PFX of version other than 3 not supported.")).version=l.version.charCodeAt(0),u;if(a.derToOid(l.contentType)!==s.oids.data)throw(u=new Error("Only PKCS#12 PFX in password integrity mode supported.")).oid=a.derToOid(l.contentType),u;var h=l.content.value[0];if(h.tagClass!==a.Class.UNIVERSAL||h.type!==a.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(h=f(h),l.mac){var C=null,m=0,v=a.derToOid(l.macAlgorithm);switch(v){case s.oids.sha1:C=n.md.sha1.create(),m=20;break;case s.oids.sha256:C=n.md.sha256.create(),m=32;break;case s.oids.sha384:C=n.md.sha384.create(),m=48;break;case s.oids.sha512:C=n.md.sha512.create(),m=64;break;case s.oids.md5:C=n.md.md5.create(),m=16}if(null===C)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+v);var E=new n.util.ByteBuffer(l.macSalt),S="macIterations"in l?parseInt(n.util.bytesToHex(l.macIterations),16):1,I=i.generateKey(r,E,3,S,m,C),T=n.hmac.create();if(T.start(C,I),T.update(h.value),T.getMac().getBytes()!==l.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return function(e,t,r,n){if((t=a.fromDer(t,r)).tagClass!==a.Class.UNIVERSAL||t.type!==a.Type.SEQUENCE||!0!==t.constructed)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var i=0;i<t.value.length;i++){var c=t.value[i],l={},u=[];if(!a.validate(c,o,l,u))throw(C=new Error("Cannot read ContentInfo.")).errors=u,C;var p={encrypted:!1},d=null,h=l.content.value[0];switch(a.derToOid(l.contentType)){case s.oids.data:if(h.tagClass!==a.Class.UNIVERSAL||h.type!==a.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");d=f(h).value;break;case s.oids.encryptedData:d=y(h,n),p.encrypted=!0;break;default:var C;throw(C=new Error("Unsupported PKCS#12 contentType.")).contentType=a.derToOid(l.contentType),C}p.safeBags=g(d,r,n),e.safeContents.push(p)}}(p,h.value,t,r),p},i.toPkcs12Asn1=function(e,t,r,o){(o=o||{}).saltSize=o.saltSize||8,o.count=o.count||2048,o.algorithm=o.algorithm||o.encAlgorithm||"aes128","useMac"in o||(o.useMac=!0),"localKeyId"in o||(o.localKeyId=null),"generateLocalKeyId"in o||(o.generateLocalKeyId=!0);var c,l=o.localKeyId;if(null!==l)l=n.util.hexToBytes(l);else if(o.generateLocalKeyId)if(t){var u=n.util.isArray(t)?t[0]:t;"string"===typeof u&&(u=s.certificateFromPem(u)),(R=n.md.sha1.create()).update(a.toDer(s.certificateToAsn1(u)).getBytes()),l=R.digest().getBytes()}else l=n.random.getBytes(20);var p=[];null!==l&&p.push(a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.localKeyId).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SET,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,l)])])),"friendlyName"in o&&p.push(a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.friendlyName).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SET,!0,[a.create(a.Class.UNIVERSAL,a.Type.BMPSTRING,!1,o.friendlyName)])])),p.length>0&&(c=a.create(a.Class.UNIVERSAL,a.Type.SET,!0,p));var d=[],f=[];null!==t&&(f=n.util.isArray(t)?t:[t]);for(var y=[],g=0;g<f.length;++g){"string"===typeof(t=f[g])&&(t=s.certificateFromPem(t));var h=0===g?c:void 0,C=s.certificateToAsn1(t),m=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.certBag).getBytes()),a.create(a.Class.CONTEXT_SPECIFIC,0,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.x509Certificate).getBytes()),a.create(a.Class.CONTEXT_SPECIFIC,0,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,a.toDer(C).getBytes())])])]),h]);y.push(m)}if(y.length>0){var v=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,y),E=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.data).getBytes()),a.create(a.Class.CONTEXT_SPECIFIC,0,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,a.toDer(v).getBytes())])]);d.push(E)}var S=null;if(null!==e){var I=s.wrapRsaPrivateKey(s.privateKeyToAsn1(e));S=null===r?a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.keyBag).getBytes()),a.create(a.Class.CONTEXT_SPECIFIC,0,!0,[I]),c]):a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.pkcs8ShroudedKeyBag).getBytes()),a.create(a.Class.CONTEXT_SPECIFIC,0,!0,[s.encryptPrivateKeyInfo(I,r,o)]),c]);var T=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[S]),A=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.data).getBytes()),a.create(a.Class.CONTEXT_SPECIFIC,0,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,a.toDer(T).getBytes())])]);d.push(A)}var N,b=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,d);if(o.useMac){var R=n.md.sha1.create(),L=new n.util.ByteBuffer(n.random.getBytes(o.saltSize)),B=o.count,k=(e=i.generateKey(r,L,3,B,20),n.hmac.create());k.start(R,e),k.update(a.toDer(b).getBytes());var U=k.getMac();N=a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.sha1).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.NULL,!1,"")]),a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,U.getBytes())]),a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,L.getBytes()),a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,a.integerToDer(B).getBytes())])}return a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.INTEGER,!1,a.integerToDer(3).getBytes()),a.create(a.Class.UNIVERSAL,a.Type.SEQUENCE,!0,[a.create(a.Class.UNIVERSAL,a.Type.OID,!1,a.oidToDer(s.oids.data).getBytes()),a.create(a.Class.CONTEXT_SPECIFIC,0,!0,[a.create(a.Class.UNIVERSAL,a.Type.OCTETSTRING,!1,a.toDer(b).getBytes())])]),N])},i.generateKey=n.pbe.generatePkcs12Key},66237:function(e,t,r){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var a=r(63780);r(6591),r(4056),r(66470),r(29333),r(90141),r(42763),r(50888),r(73937),r(73690);var s=a.asn1,i=e.exports=a.pkcs7=a.pkcs7||{};function o(e){var t={},r=[];if(!s.validate(e,i.asn1.recipientInfoValidator,t,r)){var n=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw n.errors=r,n}return{version:t.version.charCodeAt(0),issuer:a.pki.RDNAttributesAsArray(t.issuer),serialNumber:a.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:s.derToOid(t.encAlgorithm),parameter:t.encParameter.value,content:t.encKey}}}function c(e){for(var t,r=[],n=0;n<e.length;++n)r.push((t=e[n],s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(t.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:t.issuer}),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,a.util.hexToBytes(t.serialNumber))]),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.encryptedContent.algorithm).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,t.encryptedContent.content)])));return r}function l(e){var t=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[a.pki.distinguishedNameToAsn1({attributes:e.issuer}),s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,a.util.hexToBytes(e.serialNumber))]),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.digestAlgorithm).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.signatureAlgorithm).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")])),t.value.push(s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var r=s.create(s.Class.CONTEXT_SPECIFIC,1,!0,[]),n=0;n<e.unauthenticatedAttributes.length;++n){var i=e.unauthenticatedAttributes[n];r.values.push(u(i))}t.value.push(r)}return t}function u(e){var t;if(e.type===a.pki.oids.contentType)t=s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.value).getBytes());else if(e.type===a.pki.oids.messageDigest)t=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===a.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),n=new Date("2050-01-01T00:00:00Z"),i=e.value;if("string"===typeof i){var o=Date.parse(i);i=isNaN(o)?13===i.length?s.utcTimeToDate(i):s.generalizedTimeToDate(i):new Date(o)}t=i>=r&&i<n?s.create(s.Class.UNIVERSAL,s.Type.UTCTIME,!1,s.dateToUtcTime(i)):s.create(s.Class.UNIVERSAL,s.Type.GENERALIZEDTIME,!1,s.dateToGeneralizedTime(i))}return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.type).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,[t])])}function p(e,t,r){var n={};if(!s.validate(t,r,n,[])){var i=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw i.errors=i,i}if(s.derToOid(n.contentType)!==a.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(n.encryptedContent){var o="";if(a.util.isArray(n.encryptedContent))for(var c=0;c<n.encryptedContent.length;++c){if(n.encryptedContent[c].type!==s.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");o+=n.encryptedContent[c].value}else o=n.encryptedContent;e.encryptedContent={algorithm:s.derToOid(n.encAlgorithm),parameter:a.util.createBuffer(n.encParameter.value),content:a.util.createBuffer(o)}}if(n.content){o="";if(a.util.isArray(n.content))for(c=0;c<n.content.length;++c){if(n.content[c].type!==s.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");o+=n.content[c].value}else o=n.content;e.content=a.util.createBuffer(o)}return e.version=n.version.charCodeAt(0),e.rawCapture=n,n}function d(e){if(void 0===e.encryptedContent.key)throw new Error("Symmetric key not available.");if(void 0===e.content){var t;switch(e.encryptedContent.algorithm){case a.pki.oids["aes128-CBC"]:case a.pki.oids["aes192-CBC"]:case a.pki.oids["aes256-CBC"]:t=a.aes.createDecryptionCipher(e.encryptedContent.key);break;case a.pki.oids.desCBC:case a.pki.oids["des-EDE3-CBC"]:t=a.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}i.messageFromPem=function(e){var t=a.pem.decode(e)[0];if("PKCS7"!==t.type){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var n=s.fromDer(t.body);return i.messageFromAsn1(n)},i.messageToPem=function(e,t){var r={type:"PKCS7",body:s.toDer(e.toAsn1()).getBytes()};return a.pem.encode(r,{maxline:t})},i.messageFromAsn1=function(e){var t={},r=[];if(!s.validate(e,i.asn1.contentInfoValidator,t,r)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw n.errors=r,n}var o,c=s.derToOid(t.contentType);switch(c){case a.pki.oids.envelopedData:o=i.createEnvelopedData();break;case a.pki.oids.encryptedData:o=i.createEncryptedData();break;case a.pki.oids.signedData:o=i.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+c+" is not (yet) supported.")}return o.fromAsn1(t.content.value[0]),o},i.createSignedData=function(){var e=null;return e={type:a.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(t){if(p(e,t,i.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var r=e.rawCapture.certificates.value,n=0;n<r.length;++n)e.certificates.push(a.pki.certificateFromAsn1(r[n]))},toAsn1:function(){e.contentInfo||e.sign();for(var t=[],r=0;r<e.certificates.length;++r)t.push(a.pki.certificateToAsn1(e.certificates[r]));var n=[],i=s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return t.length>0&&i.value[0].value.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!0,t)),n.length>0&&i.value[0].value.push(s.create(s.Class.CONTEXT_SPECIFIC,1,!0,n)),i.value[0].value.push(s.create(s.Class.UNIVERSAL,s.Type.SET,!0,e.signerInfos)),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.type).getBytes()),i])},addSigner:function(t){var r=t.issuer,n=t.serialNumber;if(t.certificate){var s=t.certificate;"string"===typeof s&&(s=a.pki.certificateFromPem(s)),r=s.issuer.attributes,n=s.serialNumber}var i=t.key;if(!i)throw new Error("Could not add PKCS#7 signer; no private key specified.");"string"===typeof i&&(i=a.pki.privateKeyFromPem(i));var o=t.digestAlgorithm||a.pki.oids.sha1;switch(o){case a.pki.oids.sha1:case a.pki.oids.sha256:case a.pki.oids.sha384:case a.pki.oids.sha512:case a.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+o)}var c=t.authenticatedAttributes||[];if(c.length>0){for(var l=!1,u=!1,p=0;p<c.length;++p){var d=c[p];if(l||d.type!==a.pki.oids.contentType){if(u||d.type!==a.pki.oids.messageDigest);else if(u=!0,l)break}else if(l=!0,u)break}if(!l||!u)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:i,version:1,issuer:r,serialNumber:n,digestAlgorithm:o,signatureAlgorithm:a.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:c,unauthenticatedAttributes:[]})},sign:function(t){var r;(t=t||{},"object"!==n(e.content)||null===e.contentInfo)&&(e.contentInfo=s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(a.pki.oids.data).getBytes())]),"content"in e&&(e.content instanceof a.util.ByteBuffer?r=e.content.bytes():"string"===typeof e.content&&(r=a.util.encodeUtf8(e.content)),t.detached?e.detachedContent=s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,r):e.contentInfo.value.push(s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,r)]))));0!==e.signers.length&&function(t){var r;r=e.detachedContent?e.detachedContent:(r=e.contentInfo.value[1]).value[0];if(!r)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var n=s.derToOid(e.contentInfo.value[0].value),i=s.toDer(r);for(var o in i.getByte(),s.getBerValueLength(i),i=i.getBytes(),t)t[o].start().update(i);for(var c=new Date,p=0;p<e.signers.length;++p){var d=e.signers[p];if(0===d.authenticatedAttributes.length){if(n!==a.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{d.authenticatedAttributesAsn1=s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var f=s.create(s.Class.UNIVERSAL,s.Type.SET,!0,[]),y=0;y<d.authenticatedAttributes.length;++y){var g=d.authenticatedAttributes[y];g.type===a.pki.oids.messageDigest?g.value=t[d.digestAlgorithm].digest():g.type===a.pki.oids.signingTime&&(g.value||(g.value=c)),f.value.push(u(g)),d.authenticatedAttributesAsn1.value.push(u(g))}i=s.toDer(f).getBytes(),d.md.start().update(i)}d.signature=d.key.sign(d.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=function(e){for(var t=[],r=0;r<e.length;++r)t.push(l(e[r]));return t}(e.signers)}(function(){for(var t={},r=0;r<e.signers.length;++r){var n=e.signers[r];(i=n.digestAlgorithm)in t||(t[i]=a.md[a.pki.oids[i]].create()),0===n.authenticatedAttributes.length?n.md=t[i]:n.md=a.md[a.pki.oids[i]].create()}for(var i in e.digestAlgorithmIdentifiers=[],t)e.digestAlgorithmIdentifiers.push(s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(i).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.NULL,!1,"")]));return t}())},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(t){"string"===typeof t&&(t=a.pki.certificateFromPem(t)),e.certificates.push(t)},addCertificateRevokationList:function(e){throw new Error("PKCS#7 CRL support not yet implemented.")}}},i.createEncryptedData=function(){var e=null;return e={type:a.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(t){p(e,t,i.asn1.encryptedDataValidator)},decrypt:function(t){void 0!==t&&(e.encryptedContent.key=t),d(e)}}},i.createEnvelopedData=function(){var e=null;return e={type:a.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:a.pki.oids["aes256-CBC"]},fromAsn1:function(t){var r=p(e,t,i.asn1.envelopedDataValidator);e.recipients=function(e){for(var t=[],r=0;r<e.length;++r)t.push(o(e[r]));return t}(r.recipientInfos.value)},toAsn1:function(){return s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(e.type).getBytes()),s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.INTEGER,!1,s.integerToDer(e.version).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SET,!0,c(e.recipients)),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,(t=e.encryptedContent,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(a.pki.oids.data).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.SEQUENCE,!0,[s.create(s.Class.UNIVERSAL,s.Type.OID,!1,s.oidToDer(t.algorithm).getBytes()),s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,t.parameter.getBytes())]),s.create(s.Class.CONTEXT_SPECIFIC,0,!0,[s.create(s.Class.UNIVERSAL,s.Type.OCTETSTRING,!1,t.content.getBytes())])]))])])]);var t},findRecipient:function(t){for(var r=t.issuer.attributes,n=0;n<e.recipients.length;++n){var a=e.recipients[n],s=a.issuer;if(a.serialNumber===t.serialNumber&&s.length===r.length){for(var i=!0,o=0;o<r.length;++o)if(s[o].type!==r[o].type||s[o].value!==r[o].value){i=!1;break}if(i)return a}}return null},decrypt:function(t,r){if(void 0===e.encryptedContent.key&&void 0!==t&&void 0!==r)switch(t.encryptedContent.algorithm){case a.pki.oids.rsaEncryption:case a.pki.oids.desCBC:var n=r.decrypt(t.encryptedContent.content);e.encryptedContent.key=a.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}d(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:a.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,r){if(void 0===e.encryptedContent.content){var n,s,i;switch(r=r||e.encryptedContent.algorithm,t=t||e.encryptedContent.key,r){case a.pki.oids["aes128-CBC"]:n=16,s=16,i=a.aes.createEncryptionCipher;break;case a.pki.oids["aes192-CBC"]:n=24,s=16,i=a.aes.createEncryptionCipher;break;case a.pki.oids["aes256-CBC"]:n=32,s=16,i=a.aes.createEncryptionCipher;break;case a.pki.oids["des-EDE3-CBC"]:n=24,s=8,i=a.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(void 0===t)t=a.util.createBuffer(a.random.getBytes(n));else if(t.length()!=n)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+n+".");e.encryptedContent.algorithm=r,e.encryptedContent.key=t,e.encryptedContent.parameter=a.util.createBuffer(a.random.getBytes(s));var o=i(t);if(o.start(e.encryptedContent.parameter.copy()),o.update(e.content),!o.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=o.output}for(var c=0;c<e.recipients.length;++c){var l=e.recipients[c];if(void 0===l.encryptedContent.content){if(l.encryptedContent.algorithm!==a.pki.oids.rsaEncryption)throw new Error("Unsupported asymmetric cipher, OID "+l.encryptedContent.algorithm);l.encryptedContent.content=l.encryptedContent.key.encrypt(e.encryptedContent.key.data)}}}}}},42763:function(e,t,r){var n=r(63780);r(4056),r(73937);var a=n.asn1,s=e.exports=n.pkcs7asn1=n.pkcs7asn1||{};n.pkcs7=n.pkcs7||{},n.pkcs7.asn1=s;var i={name:"ContentInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:a.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};s.contentInfoValidator=i;var o={name:"EncryptedContentInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:a.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:a.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};s.envelopedDataValidator={name:"EnvelopedData",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:a.Class.UNIVERSAL,type:a.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(o)},s.encryptedDataValidator={name:"EncryptedData",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"version"}].concat(o)};var c={name:"SignerInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:a.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:a.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:a.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};s.signedDataValidator={name:"SignedData",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:a.Class.UNIVERSAL,type:a.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},i,{name:"SignedData.Certificates",tagClass:a.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:a.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:a.Class.UNIVERSAL,type:a.Type.SET,capture:"signerInfos",optional:!0,value:[c]}]},s.recipientInfoValidator={name:"RecipientInfo",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:a.Class.UNIVERSAL,type:a.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:a.Class.UNIVERSAL,type:a.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:a.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter"}]},{name:"RecipientInfo.encryptedKey",tagClass:a.Class.UNIVERSAL,type:a.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}},94199:function(e,t,r){var n=r(63780);r(4056),r(29333),r(31479),r(90141),r(97397),r(65066),r(54401),r(55147),r(73937),r(73690);var a=n.asn1,s=e.exports=n.pki=n.pki||{};s.pemToDer=function(e){var t=n.pem.decode(e)[0];if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert PEM to DER; PEM is encrypted.");return n.util.createBuffer(t.body)},s.privateKeyFromPem=function(e){var t=n.pem.decode(e)[0];if("PRIVATE KEY"!==t.type&&"RSA PRIVATE KEY"!==t.type){var r=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&"ENCRYPTED"===t.procType.type)throw new Error("Could not convert private key from PEM; PEM is encrypted.");var i=a.fromDer(t.body);return s.privateKeyFromAsn1(i)},s.privateKeyToPem=function(e,t){var r={type:"RSA PRIVATE KEY",body:a.toDer(s.privateKeyToAsn1(e)).getBytes()};return n.pem.encode(r,{maxline:t})},s.privateKeyInfoToPem=function(e,t){var r={type:"PRIVATE KEY",body:a.toDer(e).getBytes()};return n.pem.encode(r,{maxline:t})}},33519:function(e,t,r){var n=r(63780);r(73937),r(48461),r(50888),function(){if(n.prime)e.exports=n.prime;else{var t=e.exports=n.prime=n.prime||{},r=n.jsbn.BigInteger,a=[6,4,2,4,2,4,6,2],s=new r(null);s.fromInt(30);var i=function(e,t){return e|t};t.generateProbablePrime=function(e,t,a){"function"===typeof t&&(a=t,t={});var s=(t=t||{}).algorithm||"PRIMEINC";"string"===typeof s&&(s={name:s}),s.options=s.options||{};var i=t.prng||n.random,c={nextBytes:function(e){for(var t=i.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}};if("PRIMEINC"===s.name)return function(e,t,a,s){if("workers"in a)return function(e,t,a,s){if("undefined"===typeof Worker)return o(e,t,a,s);var i=l(e,t),c=a.workers,u=a.workLoad||100,p=30*u/8,d=a.workerScript||"forge/prime.worker.js";if(-1===c)return n.util.estimateCores((function(e,t){e&&(t=2),c=t-1,f()}));function f(){c=Math.max(1,c);for(var n=[],a=0;a<c;++a)n[a]=new Worker(d);for(a=0;a<c;++a)n[a].addEventListener("message",f);var o=!1;function f(a){if(!o){0;var c=a.data;if(c.found){for(var d=0;d<n.length;++d)n[d].terminate();return o=!0,s(null,new r(c.prime,16))}i.bitLength()>e&&(i=l(e,t));var f=i.toString(16);a.target.postMessage({hex:f,workLoad:u}),i.dAddOffset(p,0)}}}f()}(e,t,a,s);return o(e,t,a,s)}(e,c,s.options,a);throw new Error("Invalid prime generation algorithm: "+s.name)}}function o(e,t,r,n){var a=l(e,t),s=function(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}(a.bitLength());"millerRabinTests"in r&&(s=r.millerRabinTests);var i=10;"maxBlockTime"in r&&(i=r.maxBlockTime),c(a,e,t,0,s,i,n)}function c(e,t,r,s,i,o,u){var p=+new Date;do{if(e.bitLength()>t&&(e=l(t,r)),e.isProbablePrime(i))return u(null,e);e.dAddOffset(a[s++%8],0)}while(o<0||+new Date-p<o);n.util.setImmediate((function(){c(e,t,r,s,i,o,u)}))}function l(e,t){var n=new r(e,t),a=e-1;return n.testBit(a)||n.bitwiseTo(r.ONE.shiftLeft(a),i,n),n.dAddOffset(31-n.mod(s).byteValue(),0),n}}()},89927:function(e,t,r){var n=r(14471),a=r(63780);r(73937);var s=null;!a.util.isNodejs||a.options.usePureJavaScript||n.versions["node-webkit"]||(s=r(95942)),(e.exports=a.prng=a.prng||{}).create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();function o(){if(t.pools[0].messageLength>=32)return c();var e=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(e)),c()}function c(){t.reseeds=4294967295===t.reseeds?0:t.reseeds+1;var e=t.plugin.md.create();e.update(t.keyBytes);for(var r=1,n=0;n<32;++n)t.reseeds%r===0&&(e.update(t.pools[n].digest().getBytes()),t.pools[n].start()),r<<=1;t.keyBytes=e.digest().getBytes(),e.start(),e.update(t.keyBytes);var a=e.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(a),t.generated=0}function l(e){var t=null,r=a.util.globalScope,n=r.crypto||r.msCrypto;n&&n.getRandomValues&&(t=function(e){return n.getRandomValues(e)});var s=a.util.createBuffer();if(t)for(;s.length()<e;){var i=Math.max(1,Math.min(e-s.length(),65536)/4),o=new Uint32Array(Math.floor(i));try{t(o);for(var c=0;c<o.length;++c)s.putInt32(o[c])}catch(e){if(!("undefined"!==typeof QuotaExceededError&&e instanceof QuotaExceededError))throw e}}if(s.length()<e)for(var l,u,p,d=Math.floor(65536*Math.random());s.length()<e;){u=16807*(65535&d),u+=(32767&(l=16807*(d>>16)))<<16,d=4294967295&(u=(2147483647&(u+=l>>15))+(u>>31));for(c=0;c<3;++c)p=d>>>(c<<3),p^=Math.floor(256*Math.random()),s.putByte(String.fromCharCode(255&p))}return s.getBytes(e)}return t.pools=n,t.pool=0,t.generate=function(e,r){if(!r)return t.generateSync(e);var n=t.plugin.cipher,s=t.plugin.increment,i=t.plugin.formatKey,o=t.plugin.formatSeed,l=a.util.createBuffer();t.key=null,function u(p){if(p)return r(p);if(l.length()>=e)return r(null,l.getBytes(e));t.generated>1048575&&(t.key=null);if(null===t.key)return a.util.nextTick((function(){!function(e){if(t.pools[0].messageLength>=32)return c(),e();var r=32-t.pools[0].messageLength<<5;t.seedFile(r,(function(r,n){if(r)return e(r);t.collect(n),c(),e()}))}(u)}));var d=n(t.key,t.seed);t.generated+=d.length,l.putBytes(d),t.key=i(n(t.key,s(t.seed))),t.seed=o(n(t.key,t.seed)),a.util.setImmediate(u)}()},t.generateSync=function(e){var r=t.plugin.cipher,n=t.plugin.increment,s=t.plugin.formatKey,i=t.plugin.formatSeed;t.key=null;for(var c=a.util.createBuffer();c.length()<e;){t.generated>1048575&&(t.key=null),null===t.key&&o();var l=r(t.key,t.seed);t.generated+=l.length,c.putBytes(l),t.key=s(r(t.key,n(t.seed))),t.seed=i(r(t.key,t.seed))}return c.getBytes(e)},s?(t.seedFile=function(e,t){s.randomBytes(e,(function(e,r){if(e)return t(e);t(null,r.toString())}))},t.seedFileSync=function(e){return s.randomBytes(e).toString()}):(t.seedFile=function(e,t){try{t(null,l(e))}catch(e){t(e)}},t.seedFileSync=l),t.collect=function(e){for(var r=e.length,n=0;n<r;++n)t.pools[t.pool].update(e.substr(n,1)),t.pool=31===t.pool?0:t.pool+1},t.collectInt=function(e,r){for(var n="",a=0;a<r;a+=8)n+=String.fromCharCode(e>>a&255);t.collect(n)},t.registerWorker=function(e){if(e===self)t.seedFile=function(e,t){self.addEventListener("message",(function e(r){var n=r.data;n.forge&&n.forge.prng&&(self.removeEventListener("message",e),t(n.forge.prng.err,n.forge.prng.bytes))})),self.postMessage({forge:{prng:{needed:e}}})};else{e.addEventListener("message",(function(r){var n=r.data;n.forge&&n.forge.prng&&t.seedFile(n.forge.prng.needed,(function(t,r){e.postMessage({forge:{prng:{err:t,bytes:r}}})}))}))}},t}},54401:function(e,t,r){var n=r(63780);r(50888),r(73937),(e.exports=n.pss=n.pss||{}).create=function(e){3===arguments.length&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t,r=e.md,a=e.mgf,s=r.digestLength,i=e.salt||null;if("string"===typeof i&&(i=n.util.createBuffer(i)),"saltLength"in e)t=e.saltLength;else{if(null===i)throw new Error("Salt length not specified or specific salt not given.");t=i.length()}if(null!==i&&i.length()!==t)throw new Error("Given salt length does not match length of given salt.");var o=e.prng||n.random,c={encode:function(e,c){var l,u,p=c-1,d=Math.ceil(p/8),f=e.digest().getBytes();if(d<s+t+2)throw new Error("Message is too long to encrypt.");u=null===i?o.getBytesSync(t):i.bytes();var y=new n.util.ByteBuffer;y.fillWithByte(0,8),y.putBytes(f),y.putBytes(u),r.start(),r.update(y.getBytes());var g=r.digest().getBytes(),h=new n.util.ByteBuffer;h.fillWithByte(0,d-t-s-2),h.putByte(1),h.putBytes(u);var C=h.getBytes(),m=d-s-1,v=a.generate(g,m),E="";for(l=0;l<m;l++)E+=String.fromCharCode(C.charCodeAt(l)^v.charCodeAt(l));var S=65280>>8*d-p&255;return(E=String.fromCharCode(E.charCodeAt(0)&~S)+E.substr(1))+g+String.fromCharCode(188)},verify:function(e,i,o){var c,l=o-1,u=Math.ceil(l/8);if(i=i.substr(-u),u<s+t+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(188!==i.charCodeAt(u-1))throw new Error("Encoded message does not end in 0xBC.");var p=u-s-1,d=i.substr(0,p),f=i.substr(p,s),y=65280>>8*u-l&255;if(0!==(d.charCodeAt(0)&y))throw new Error("Bits beyond keysize not zero as expected.");var g=a.generate(f,p),h="";for(c=0;c<p;c++)h+=String.fromCharCode(d.charCodeAt(c)^g.charCodeAt(c));h=String.fromCharCode(h.charCodeAt(0)&~y)+h.substr(1);var C=u-s-t-2;for(c=0;c<C;c++)if(0!==h.charCodeAt(c))throw new Error("Leftmost octets not zero as expected");if(1!==h.charCodeAt(C))throw new Error("Inconsistent PSS signature, 0x01 marker not found");var m=h.substr(-t),v=new n.util.ByteBuffer;return v.fillWithByte(0,8),v.putBytes(e),v.putBytes(m),r.start(),r.update(v.getBytes()),f===r.digest().getBytes()}};return c}},50888:function(e,t,r){var n=r(63780);r(6591),r(54975),r(89927),r(73937),n.random&&n.random.getBytes?e.exports=n.random:function(t){var r={},a=new Array(4),s=n.util.createBuffer();function i(){var e=n.prng.create(r);return e.getBytes=function(t,r){return e.generate(t,r)},e.getBytesSync=function(t){return e.generate(t)},e}r.formatKey=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),n.aes._expandKey(e,!1)},r.formatSeed=function(e){var t=n.util.createBuffer(e);return(e=new Array(4))[0]=t.getInt32(),e[1]=t.getInt32(),e[2]=t.getInt32(),e[3]=t.getInt32(),e},r.cipher=function(e,t){return n.aes._updateBlock(e,t,a,!1),s.putInt32(a[0]),s.putInt32(a[1]),s.putInt32(a[2]),s.putInt32(a[3]),s.getBytes()},r.increment=function(e){return++e[3],e},r.md=n.md.sha256;var o=i(),c=null,l=n.util.globalScope,u=l.crypto||l.msCrypto;if(u&&u.getRandomValues&&(c=function(e){return u.getRandomValues(e)}),n.options.usePureJavaScript||!n.util.isNodejs&&!c){if(window.document,o.collectInt(+new Date,32),"undefined"!==typeof navigator){var p="";for(var d in navigator)try{"string"==typeof navigator[d]&&(p+=navigator[d])}catch(e){}o.collect(p),p=null}t&&(t().mousemove((function(e){o.collectInt(e.clientX,16),o.collectInt(e.clientY,16)})),t().keypress((function(e){o.collectInt(e.charCode,8)})))}if(n.random)for(var d in o)n.random[d]=o[d];else n.random=o;n.random.createInstance=i,e.exports=n.random}("undefined"!==typeof jQuery?jQuery:null)},72785:function(e,t,r){var n=r(63780);r(73937);var a=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],s=[1,2,3,5],i=function(e,t){return e<<t&65535|(65535&e)>>16-t},o=function(e,t){return(65535&e)>>t|e<<16-t&65535};e.exports=n.rc2=n.rc2||{},n.rc2.expandKey=function(e,t){"string"===typeof e&&(e=n.util.createBuffer(e)),t=t||128;var r,s=e,i=e.length(),o=t,c=Math.ceil(o/8),l=255>>(7&o);for(r=i;r<128;r++)s.putByte(a[s.at(r-1)+s.at(r-i)&255]);for(s.setAt(128-c,a[s.at(128-c)&l]),r=127-c;r>=0;r--)s.setAt(r,a[s.at(r+1)^s.at(r+c)]);return s};var c=function(e,t,r){var a,c,l,u,p=!1,d=null,f=null,y=null,g=[];for(e=n.rc2.expandKey(e,t),l=0;l<64;l++)g.push(e.getInt16Le());r?(a=function(e){for(l=0;l<4;l++)e[l]+=g[u]+(e[(l+3)%4]&e[(l+2)%4])+(~e[(l+3)%4]&e[(l+1)%4]),e[l]=i(e[l],s[l]),u++},c=function(e){for(l=0;l<4;l++)e[l]+=g[63&e[(l+3)%4]]}):(a=function(e){for(l=3;l>=0;l--)e[l]=o(e[l],s[l]),e[l]-=g[u]+(e[(l+3)%4]&e[(l+2)%4])+(~e[(l+3)%4]&e[(l+1)%4]),u--},c=function(e){for(l=3;l>=0;l--)e[l]-=g[63&e[(l+3)%4]]});var h=function(e){var t=[];for(l=0;l<4;l++){var n=d.getInt16Le();null!==y&&(r?n^=y.getInt16Le():y.putInt16Le(n)),t.push(65535&n)}u=r?0:63;for(var a=0;a<e.length;a++)for(var s=0;s<e[a][0];s++)e[a][1](t);for(l=0;l<4;l++)null!==y&&(r?y.putInt16Le(t[l]):t[l]^=y.getInt16Le()),f.putInt16Le(t[l])},C=null;return C={start:function(e,t){e&&"string"===typeof e&&(e=n.util.createBuffer(e)),p=!1,d=n.util.createBuffer(),f=t||new n.util.createBuffer,y=e,C.output=f},update:function(e){for(p||d.putBuffer(e);d.length()>=8;)h([[5,a],[1,c],[6,a],[1,c],[5,a]])},finish:function(e){var t=!0;if(r)if(e)t=e(8,d,!r);else{var n=8===d.length()?8:8-d.length();d.fillWithByte(n,n)}if(t&&(p=!0,C.update()),!r&&(t=0===d.length()))if(e)t=e(8,f,!r);else{var a=f.length(),s=f.at(a-1);s>a?t=!1:f.truncate(s)}return t}}};n.rc2.startEncrypting=function(e,t,r){var a=n.rc2.createEncryptionCipher(e,128);return a.start(t,r),a},n.rc2.createEncryptionCipher=function(e,t){return c(e,t,!0)},n.rc2.startDecrypting=function(e,t,r){var a=n.rc2.createDecryptionCipher(e,128);return a.start(t,r),a},n.rc2.createDecryptionCipher=function(e,t){return c(e,t,!1)}},55147:function(e,t,r){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var a=r(63780);if(r(4056),r(48461),r(29333),r(74867),r(33519),r(50888),r(73937),"undefined"===typeof s)var s=a.jsbn.BigInteger;var i=a.util.isNodejs?r(95942):null,o=a.asn1,c=a.util;a.pki=a.pki||{},e.exports=a.pki.rsa=a.rsa=a.rsa||{};var l=a.pki,u=[6,4,2,4,2,4,6,2],p={name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},d={name:"RSAPrivateKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},f={name:"RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:o.Class.UNIVERSAL,type:o.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},y=a.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:o.Class.UNIVERSAL,type:o.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:o.Class.UNIVERSAL,type:o.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},g=function(e){var t;if(!(e.algorithm in l.oids)){var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}t=l.oids[e.algorithm];var n=o.oidToDer(t).getBytes(),a=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]),s=o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[]);s.value.push(o.create(o.Class.UNIVERSAL,o.Type.OID,!1,n)),s.value.push(o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,""));var i=o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,e.digest().getBytes());return a.value.push(s),a.value.push(i),o.toDer(a).getBytes()},h=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);var n;t.dP||(t.dP=t.d.mod(t.p.subtract(s.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(s.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));do{n=new s(a.util.bytesToHex(a.random.getBytes(t.n.bitLength()/8)),16)}while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(s.ONE));for(var i=(e=e.multiply(n.modPow(t.e,t.n)).mod(t.n)).mod(t.p).modPow(t.dP,t.p),o=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(o)<0;)i=i.add(t.p);var c=i.subtract(o).multiply(t.qInv).mod(t.p).multiply(t.q).add(o);return c=c.multiply(n.modInverse(t.n)).mod(t.n)};function C(e,t,r){var n=a.util.createBuffer(),s=Math.ceil(t.n.bitLength()/8);if(e.length>s-11){var i=new Error("Message is too long for PKCS#1 v1.5 padding.");throw i.length=e.length,i.max=s-11,i}n.putByte(0),n.putByte(r);var o,c=s-3-e.length;if(0===r||1===r){o=0===r?0:255;for(var l=0;l<c;++l)n.putByte(o)}else for(;c>0;){var u=0,p=a.random.getBytes(c);for(l=0;l<c;++l)0===(o=p.charCodeAt(l))?++u:n.putByte(o);c=u}return n.putByte(0),n.putBytes(e),n}function m(e,t,r,n){var s=Math.ceil(t.n.bitLength()/8),i=a.util.createBuffer(e),o=i.getByte(),c=i.getByte();if(0!==o||r&&0!==c&&1!==c||!r&&2!=c||r&&0===c&&"undefined"===typeof n)throw new Error("Encryption block is invalid.");var l=0;if(0===c){l=s-3-n;for(var u=0;u<l;++u)if(0!==i.getByte())throw new Error("Encryption block is invalid.")}else if(1===c)for(l=0;i.length()>1;){if(255!==i.getByte()){--i.read;break}++l}else if(2===c)for(l=0;i.length()>1;){if(0===i.getByte()){--i.read;break}++l}if(0!==i.getByte()||l!==s-3-i.length())throw new Error("Encryption block is invalid.");return i.getBytes()}function v(e,t,r){"function"===typeof t&&(r=t,t={});var n={algorithm:{name:(t=t||{}).algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};function i(){o(e.pBits,(function(t,n){return t?r(t):(e.p=n,null!==e.q?c(t,e.q):void o(e.qBits,c))}))}function o(e,t){a.prime.generateProbablePrime(e,n,t)}function c(t,n){if(t)return r(t);if(e.q=n,e.p.compareTo(e.q)<0){var a=e.p;e.p=e.q,e.q=a}if(0!==e.p.subtract(s.ONE).gcd(e.e).compareTo(s.ONE))return e.p=null,void i();if(0!==e.q.subtract(s.ONE).gcd(e.e).compareTo(s.ONE))return e.q=null,void o(e.qBits,c);if(e.p1=e.p.subtract(s.ONE),e.q1=e.q.subtract(s.ONE),e.phi=e.p1.multiply(e.q1),0!==e.phi.gcd(e.e).compareTo(s.ONE))return e.p=e.q=null,void i();if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits)return e.q=null,void o(e.qBits,c);var u=e.e.modInverse(e.phi);e.keys={privateKey:l.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:l.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}"prng"in t&&(n.prng=t.prng),i()}function E(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=a.util.hexToBytes(t);return r.length>1&&(0===r.charCodeAt(0)&&0===(128&r.charCodeAt(1))||255===r.charCodeAt(0)&&128===(128&r.charCodeAt(1)))?r.substr(1):r}function S(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function I(e){return a.util.isNodejs&&"function"===typeof i[e]}function T(e){return"undefined"!==typeof c.globalScope&&"object"===n(c.globalScope.crypto)&&"object"===n(c.globalScope.crypto.subtle)&&"function"===typeof c.globalScope.crypto.subtle[e]}function A(e){return"undefined"!==typeof c.globalScope&&"object"===n(c.globalScope.msCrypto)&&"object"===n(c.globalScope.msCrypto.subtle)&&"function"===typeof c.globalScope.msCrypto.subtle[e]}function N(e){for(var t=a.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}l.rsa.encrypt=function(e,t,r){var n,i=r,o=Math.ceil(t.n.bitLength()/8);!1!==r&&!0!==r?(i=2===r,n=C(e,t,r)):(n=a.util.createBuffer()).putBytes(e);for(var c=new s(n.toHex(),16),l=h(c,t,i).toString(16),u=a.util.createBuffer(),p=o-Math.ceil(l.length/2);p>0;)u.putByte(0),--p;return u.putBytes(a.util.hexToBytes(l)),u.getBytes()},l.rsa.decrypt=function(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var o=new Error("Encrypted message length is invalid.");throw o.length=e.length,o.expected=i,o}var c=new s(a.util.createBuffer(e).toHex(),16);if(c.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var l=h(c,t,r).toString(16),u=a.util.createBuffer(),p=i-Math.ceil(l.length/2);p>0;)u.putByte(0),--p;return u.putBytes(a.util.hexToBytes(l)),!1!==n?m(u.getBytes(),t,r):u.getBytes()},l.rsa.createKeyPairGenerationState=function(e,t,r){"string"===typeof e&&(e=parseInt(e,10)),e=e||2048;var n,i=(r=r||{}).prng||a.random,o={nextBytes:function(e){for(var t=i.getBytesSync(e.length),r=0;r<e.length;++r)e[r]=t.charCodeAt(r)}},c=r.algorithm||"PRIMEINC";if("PRIMEINC"!==c)throw new Error("Invalid key generation algorithm: "+c);return(n={algorithm:c,state:0,bits:e,rng:o,eInt:t||65537,e:new s(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null}).e.fromInt(n.eInt),n},l.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new s(null);r.fromInt(30);for(var n,a=0,i=function(e,t){return e|t},o=+new Date,c=0;null===e.keys&&(t<=0||c<t);){if(0===e.state){var p=null===e.p?e.pBits:e.qBits,d=p-1;0===e.pqState?(e.num=new s(p,e.rng),e.num.testBit(d)||e.num.bitwiseTo(s.ONE.shiftLeft(d),i,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),a=0,++e.pqState):1===e.pqState?e.num.bitLength()>p?e.pqState=0:e.num.isProbablePrime(S(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(u[a++%8],0):2===e.pqState?e.pqState=0===e.num.subtract(s.ONE).gcd(e.e).compareTo(s.ONE)?3:0:3===e.pqState&&(e.pqState=0,null===e.p?e.p=e.num:e.q=e.num,null!==e.p&&null!==e.q&&++e.state,e.num=null)}else if(1===e.state)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(2===e.state)e.p1=e.p.subtract(s.ONE),e.q1=e.q.subtract(s.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(3===e.state)0===e.phi.gcd(e.e).compareTo(s.ONE)?++e.state:(e.p=null,e.q=null,e.state=0);else if(4===e.state)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(5===e.state){var f=e.e.modInverse(e.phi);e.keys={privateKey:l.rsa.setPrivateKey(e.n,e.e,f,e.p,e.q,f.mod(e.p1),f.mod(e.q1),e.q.modInverse(e.p)),publicKey:l.rsa.setPublicKey(e.n,e.e)}}c+=(n=+new Date)-o,o=n}return null!==e.keys},l.rsa.generateKeyPair=function(e,t,r,s){if(1===arguments.length?"object"===n(e)?(r=e,e=void 0):"function"===typeof e&&(s=e,e=void 0):2===arguments.length?"number"===typeof e?"function"===typeof t?(s=t,t=void 0):"number"!==typeof t&&(r=t,t=void 0):(r=e,s=t,e=void 0,t=void 0):3===arguments.length&&("number"===typeof t?"function"===typeof r&&(s=r,r=void 0):(s=r,r=t,t=void 0)),r=r||{},void 0===e&&(e=r.bits||2048),void 0===t&&(t=r.e||65537),!a.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(65537===t||3===t))if(s){if(I("generateKeyPair"))return i.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},(function(e,t,r){if(e)return s(e);s(null,{privateKey:l.privateKeyFromPem(r),publicKey:l.publicKeyFromPem(t)})}));if(T("generateKey")&&T("exportKey"))return c.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:N(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then((function(e){return c.globalScope.crypto.subtle.exportKey("pkcs8",e.privateKey)})).then(void 0,(function(e){s(e)})).then((function(e){if(e){var t=l.privateKeyFromAsn1(o.fromDer(a.util.createBuffer(e)));s(null,{privateKey:t,publicKey:l.setRsaPublicKey(t.n,t.e)})}}));if(A("generateKey")&&A("exportKey")){var u=c.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:N(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);return u.oncomplete=function(e){var t=e.target.result,r=c.globalScope.msCrypto.subtle.exportKey("pkcs8",t.privateKey);r.oncomplete=function(e){var t=e.target.result,r=l.privateKeyFromAsn1(o.fromDer(a.util.createBuffer(t)));s(null,{privateKey:r,publicKey:l.setRsaPublicKey(r.n,r.e)})},r.onerror=function(e){s(e)}},void(u.onerror=function(e){s(e)})}}else if(I("generateKeyPairSync")){var p=i.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:l.privateKeyFromPem(p.privateKey),publicKey:l.publicKeyFromPem(p.publicKey)}}var d=l.rsa.createKeyPairGenerationState(e,t,r);if(!s)return l.rsa.stepKeyPairGenerationState(d,0),d.keys;v(d,r,s)},l.setRsaPublicKey=l.rsa.setPublicKey=function(e,t){var r={n:e,e:t,encrypt:function(e,t,n){if("string"===typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5"),"RSAES-PKCS1-V1_5"===t)t={encode:function(e,t,r){return C(e,t,2).getBytes()}};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={encode:function(e,t){return a.pkcs1.encode_rsa_oaep(t,e,n)}};else if(-1!==["RAW","NONE","NULL",null].indexOf(t))t={encode:function(e){return e}};else if("string"===typeof t)throw new Error('Unsupported encryption scheme: "'+t+'".');var s=t.encode(e,r,!0);return l.rsa.encrypt(s,r,!0)},verify:function(e,t,n){"string"===typeof n?n=n.toUpperCase():void 0===n&&(n="RSASSA-PKCS1-V1_5"),"RSASSA-PKCS1-V1_5"===n?n={verify:function(e,t){return t=m(t,r,!0),e===o.fromDer(t).value[1].value}}:"NONE"!==n&&"NULL"!==n&&null!==n||(n={verify:function(e,t){return e===(t=m(t,r,!0))}});var a=l.rsa.decrypt(t,r,!0,!1);return n.verify(e,a,r.n.bitLength())}};return r},l.setRsaPrivateKey=l.rsa.setPrivateKey=function(e,t,r,n,s,i,o,c){var u={n:e,e:t,d:r,p:n,q:s,dP:i,dQ:o,qInv:c,decrypt:function(e,t,r){"string"===typeof t?t=t.toUpperCase():void 0===t&&(t="RSAES-PKCS1-V1_5");var n=l.rsa.decrypt(e,u,!1,!1);if("RSAES-PKCS1-V1_5"===t)t={decode:m};else if("RSA-OAEP"===t||"RSAES-OAEP"===t)t={decode:function(e,t){return a.pkcs1.decode_rsa_oaep(t,e,r)}};else{if(-1===["RAW","NONE","NULL",null].indexOf(t))throw new Error('Unsupported encryption scheme: "'+t+'".');t={decode:function(e){return e}}}return t.decode(n,u,!1)},sign:function(e,t){var r=!1;"string"===typeof t&&(t=t.toUpperCase()),void 0===t||"RSASSA-PKCS1-V1_5"===t?(t={encode:g},r=1):"NONE"!==t&&"NULL"!==t&&null!==t||(t={encode:function(){return e}},r=1);var n=t.encode(e,u.n.bitLength());return l.rsa.encrypt(n,u,r)}};return u},l.wrapRsaPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(l.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.OCTETSTRING,!1,o.toDer(e).getBytes())])},l.privateKeyFromAsn1=function(e){var t,r,n,i,c,u,f,y,g={},h=[];if(o.validate(e,p,g,h)&&(e=o.fromDer(a.util.createBuffer(g.privateKey))),g={},h=[],!o.validate(e,d,g,h)){var C=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw C.errors=h,C}return t=a.util.createBuffer(g.privateKeyModulus).toHex(),r=a.util.createBuffer(g.privateKeyPublicExponent).toHex(),n=a.util.createBuffer(g.privateKeyPrivateExponent).toHex(),i=a.util.createBuffer(g.privateKeyPrime1).toHex(),c=a.util.createBuffer(g.privateKeyPrime2).toHex(),u=a.util.createBuffer(g.privateKeyExponent1).toHex(),f=a.util.createBuffer(g.privateKeyExponent2).toHex(),y=a.util.createBuffer(g.privateKeyCoefficient).toHex(),l.setRsaPrivateKey(new s(t,16),new s(r,16),new s(n,16),new s(i,16),new s(c,16),new s(u,16),new s(f,16),new s(y,16))},l.privateKeyToAsn1=l.privateKeyToRSAPrivateKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,o.integerToDer(0).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.e)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.d)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.p)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.q)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.dP)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.dQ)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.qInv))])},l.publicKeyFromAsn1=function(e){var t={},r=[];if(o.validate(e,y,t,r)){var n,i=o.derToOid(t.publicKeyOid);if(i!==l.oids.rsaEncryption)throw(n=new Error("Cannot read public key. Unknown OID.")).oid=i,n;e=t.rsaPublicKey}if(r=[],!o.validate(e,f,t,r))throw(n=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.")).errors=r,n;var c=a.util.createBuffer(t.publicKeyModulus).toHex(),u=a.util.createBuffer(t.publicKeyExponent).toHex();return l.setRsaPublicKey(new s(c,16),new s(u,16))},l.publicKeyToAsn1=l.publicKeyToSubjectPublicKeyInfo=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.OID,!1,o.oidToDer(l.oids.rsaEncryption).getBytes()),o.create(o.Class.UNIVERSAL,o.Type.NULL,!1,"")]),o.create(o.Class.UNIVERSAL,o.Type.BITSTRING,!1,[l.publicKeyToRSAPublicKey(e)])])},l.publicKeyToRSAPublicKey=function(e){return o.create(o.Class.UNIVERSAL,o.Type.SEQUENCE,!0,[o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.n)),o.create(o.Class.UNIVERSAL,o.Type.INTEGER,!1,E(e.e))])}},91127:function(e,t,r){var n=r(63780);r(24614),r(73937);var a=e.exports=n.sha1=n.sha1||{};n.md.sha1=n.md.algorithms.sha1=a,a.create=function(){i||(s=String.fromCharCode(128),s+=n.util.fillString(String.fromCharCode(0),64),i=!0);var e=null,t=n.util.createBuffer(),r=new Array(80),a={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){a.messageLength=0,a.fullMessageLength=a.messageLength64=[];for(var r=a.messageLengthSize/4,s=0;s<r;++s)a.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},a}};return a.start(),a.update=function(s,i){"utf8"===i&&(s=n.util.encodeUtf8(s));var c=s.length;a.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var l=a.fullMessageLength.length-1;l>=0;--l)a.fullMessageLength[l]+=c[1],c[1]=c[0]+(a.fullMessageLength[l]/4294967296>>>0),a.fullMessageLength[l]=a.fullMessageLength[l]>>>0,c[0]=c[1]/4294967296>>>0;return t.putBytes(s),o(e,r,t),(t.read>2048||0===t.length())&&t.compact(),a},a.digest=function(){var i=n.util.createBuffer();i.putBytes(t.bytes());var c,l=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize&a.blockLength-1;i.putBytes(s.substr(0,a.blockLength-l));for(var u=8*a.fullMessageLength[0],p=0;p<a.fullMessageLength.length-1;++p)u+=(c=8*a.fullMessageLength[p+1])/4294967296>>>0,i.putInt32(u>>>0),u=c>>>0;i.putInt32(u);var d={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};o(d,r,i);var f=n.util.createBuffer();return f.putInt32(d.h0),f.putInt32(d.h1),f.putInt32(d.h2),f.putInt32(d.h3),f.putInt32(d.h4),f},a};var s=null,i=!1;function o(e,t,r){for(var n,a,s,i,o,c,l,u=r.length();u>=64;){for(a=e.h0,s=e.h1,i=e.h2,o=e.h3,c=e.h4,l=0;l<16;++l)n=r.getInt32(),t[l]=n,n=(a<<5|a>>>27)+(o^s&(i^o))+c+1518500249+n,c=o,o=i,i=(s<<30|s>>>2)>>>0,s=a,a=n;for(;l<20;++l)n=(n=t[l-3]^t[l-8]^t[l-14]^t[l-16])<<1|n>>>31,t[l]=n,n=(a<<5|a>>>27)+(o^s&(i^o))+c+1518500249+n,c=o,o=i,i=(s<<30|s>>>2)>>>0,s=a,a=n;for(;l<32;++l)n=(n=t[l-3]^t[l-8]^t[l-14]^t[l-16])<<1|n>>>31,t[l]=n,n=(a<<5|a>>>27)+(s^i^o)+c+1859775393+n,c=o,o=i,i=(s<<30|s>>>2)>>>0,s=a,a=n;for(;l<40;++l)n=(n=t[l-6]^t[l-16]^t[l-28]^t[l-32])<<2|n>>>30,t[l]=n,n=(a<<5|a>>>27)+(s^i^o)+c+1859775393+n,c=o,o=i,i=(s<<30|s>>>2)>>>0,s=a,a=n;for(;l<60;++l)n=(n=t[l-6]^t[l-16]^t[l-28]^t[l-32])<<2|n>>>30,t[l]=n,n=(a<<5|a>>>27)+(s&i|o&(s^i))+c+2400959708+n,c=o,o=i,i=(s<<30|s>>>2)>>>0,s=a,a=n;for(;l<80;++l)n=(n=t[l-6]^t[l-16]^t[l-28]^t[l-32])<<2|n>>>30,t[l]=n,n=(a<<5|a>>>27)+(s^i^o)+c+3395469782+n,c=o,o=i,i=(s<<30|s>>>2)>>>0,s=a,a=n;e.h0=e.h0+a|0,e.h1=e.h1+s|0,e.h2=e.h2+i|0,e.h3=e.h3+o|0,e.h4=e.h4+c|0,u-=64}}},54975:function(e,t,r){var n=r(63780);r(24614),r(73937);var a=e.exports=n.sha256=n.sha256||{};n.md.sha256=n.md.algorithms.sha256=a,a.create=function(){i||(s=String.fromCharCode(128),s+=n.util.fillString(String.fromCharCode(0),64),o=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],i=!0);var e=null,t=n.util.createBuffer(),r=new Array(64),a={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){a.messageLength=0,a.fullMessageLength=a.messageLength64=[];for(var r=a.messageLengthSize/4,s=0;s<r;++s)a.fullMessageLength.push(0);return t=n.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},a}};return a.start(),a.update=function(s,i){"utf8"===i&&(s=n.util.encodeUtf8(s));var o=s.length;a.messageLength+=o,o=[o/4294967296>>>0,o>>>0];for(var l=a.fullMessageLength.length-1;l>=0;--l)a.fullMessageLength[l]+=o[1],o[1]=o[0]+(a.fullMessageLength[l]/4294967296>>>0),a.fullMessageLength[l]=a.fullMessageLength[l]>>>0,o[0]=o[1]/4294967296>>>0;return t.putBytes(s),c(e,r,t),(t.read>2048||0===t.length())&&t.compact(),a},a.digest=function(){var i=n.util.createBuffer();i.putBytes(t.bytes());var o,l=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize&a.blockLength-1;i.putBytes(s.substr(0,a.blockLength-l));for(var u=8*a.fullMessageLength[0],p=0;p<a.fullMessageLength.length-1;++p)u+=(o=8*a.fullMessageLength[p+1])/4294967296>>>0,i.putInt32(u>>>0),u=o>>>0;i.putInt32(u);var d={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};c(d,r,i);var f=n.util.createBuffer();return f.putInt32(d.h0),f.putInt32(d.h1),f.putInt32(d.h2),f.putInt32(d.h3),f.putInt32(d.h4),f.putInt32(d.h5),f.putInt32(d.h6),f.putInt32(d.h7),f},a};var s=null,i=!1,o=null;function c(e,t,r){for(var n,a,s,i,c,l,u,p,d,f,y,g,h,C=r.length();C>=64;){for(c=0;c<16;++c)t[c]=r.getInt32();for(;c<64;++c)n=((n=t[c-2])>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,a=((a=t[c-15])>>>7|a<<25)^(a>>>18|a<<14)^a>>>3,t[c]=n+t[c-7]+a+t[c-16]|0;for(l=e.h0,u=e.h1,p=e.h2,d=e.h3,f=e.h4,y=e.h5,g=e.h6,h=e.h7,c=0;c<64;++c)s=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),i=l&u|p&(l^u),n=h+((f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(g^f&(y^g))+o[c]+t[c],h=g,g=y,y=f,f=d+n>>>0,d=p,p=u,u=l,l=n+(a=s+i)>>>0;e.h0=e.h0+l|0,e.h1=e.h1+u|0,e.h2=e.h2+p|0,e.h3=e.h3+d|0,e.h4=e.h4+f|0,e.h5=e.h5+y|0,e.h6=e.h6+g|0,e.h7=e.h7+h|0,C-=64}}},59307:function(e,t,r){var n=r(63780);r(24614),r(73937);var a=e.exports=n.sha512=n.sha512||{};n.md.sha512=n.md.algorithms.sha512=a;var s=n.sha384=n.sha512.sha384=n.sha512.sha384||{};s.create=function(){return a.create("SHA-384")},n.md.sha384=n.md.algorithms.sha384=s,n.sha512.sha256=n.sha512.sha256||{create:function(){return a.create("SHA-512/256")}},n.md["sha512/256"]=n.md.algorithms["sha512/256"]=n.sha512.sha256,n.sha512.sha224=n.sha512.sha224||{create:function(){return a.create("SHA-512/224")}},n.md["sha512/224"]=n.md.algorithms["sha512/224"]=n.sha512.sha224,a.create=function(e){if(o||(i=String.fromCharCode(128),i+=n.util.fillString(String.fromCharCode(0),128),c=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],(l={})["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],l["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],l["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],l["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],o=!0),"undefined"===typeof e&&(e="SHA-512"),!(e in l))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=l[e],r=null,a=n.util.createBuffer(),s=new Array(80),p=0;p<80;++p)s[p]=new Array(2);var d=64;switch(e){case"SHA-384":d=48;break;case"SHA-512/256":d=32;break;case"SHA-512/224":d=28}var f={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:d,messageLength:0,fullMessageLength:null,messageLengthSize:16,start:function(){f.messageLength=0,f.fullMessageLength=f.messageLength128=[];for(var e=f.messageLengthSize/4,s=0;s<e;++s)f.fullMessageLength.push(0);a=n.util.createBuffer(),r=new Array(t.length);for(s=0;s<t.length;++s)r[s]=t[s].slice(0);return f}};return f.start(),f.update=function(e,t){"utf8"===t&&(e=n.util.encodeUtf8(e));var i=e.length;f.messageLength+=i,i=[i/4294967296>>>0,i>>>0];for(var o=f.fullMessageLength.length-1;o>=0;--o)f.fullMessageLength[o]+=i[1],i[1]=i[0]+(f.fullMessageLength[o]/4294967296>>>0),f.fullMessageLength[o]=f.fullMessageLength[o]>>>0,i[0]=i[1]/4294967296>>>0;return a.putBytes(e),u(r,s,a),(a.read>2048||0===a.length())&&a.compact(),f},f.digest=function(){var t=n.util.createBuffer();t.putBytes(a.bytes());var o,c=f.fullMessageLength[f.fullMessageLength.length-1]+f.messageLengthSize&f.blockLength-1;t.putBytes(i.substr(0,f.blockLength-c));for(var l=8*f.fullMessageLength[0],p=0;p<f.fullMessageLength.length-1;++p)l+=(o=8*f.fullMessageLength[p+1])/4294967296>>>0,t.putInt32(l>>>0),l=o>>>0;t.putInt32(l);var d=new Array(r.length);for(p=0;p<r.length;++p)d[p]=r[p].slice(0);u(d,s,t);var y,g=n.util.createBuffer();y="SHA-512"===e?d.length:"SHA-384"===e?d.length-2:d.length-4;for(p=0;p<y;++p)g.putInt32(d[p][0]),p===y-1&&"SHA-512/224"===e||g.putInt32(d[p][1]);return g},f};var i=null,o=!1,c=null,l=null;function u(e,t,r){for(var n,a,s,i,o,l,u,p,d,f,y,g,h,C,m,v,E,S,I,T,A,N,b,R,L,B,k,U,w,V,P,K,D,_=r.length();_>=128;){for(k=0;k<16;++k)t[k][0]=r.getInt32()>>>0,t[k][1]=r.getInt32()>>>0;for(;k<80;++k)n=(((U=(V=t[k-2])[0])>>>19|(w=V[1])<<13)^(w>>>29|U<<3)^U>>>6)>>>0,a=((U<<13|w>>>19)^(w<<3|U>>>29)^(U<<26|w>>>6))>>>0,s=(((U=(K=t[k-15])[0])>>>1|(w=K[1])<<31)^(U>>>8|w<<24)^U>>>7)>>>0,i=((U<<31|w>>>1)^(U<<24|w>>>8)^(U<<25|w>>>7))>>>0,P=t[k-7],D=t[k-16],w=a+P[1]+i+D[1],t[k][0]=n+P[0]+s+D[0]+(w/4294967296>>>0)>>>0,t[k][1]=w>>>0;for(y=e[0][0],g=e[0][1],h=e[1][0],C=e[1][1],m=e[2][0],v=e[2][1],E=e[3][0],S=e[3][1],I=e[4][0],T=e[4][1],A=e[5][0],N=e[5][1],b=e[6][0],R=e[6][1],L=e[7][0],B=e[7][1],k=0;k<80;++k)u=((I>>>14|T<<18)^(I>>>18|T<<14)^(T>>>9|I<<23))>>>0,p=(b^I&(A^b))>>>0,o=((y>>>28|g<<4)^(g>>>2|y<<30)^(g>>>7|y<<25))>>>0,l=((y<<4|g>>>28)^(g<<30|y>>>2)^(g<<25|y>>>7))>>>0,d=(y&h|m&(y^h))>>>0,f=(g&C|v&(g^C))>>>0,w=B+(((I<<18|T>>>14)^(I<<14|T>>>18)^(T<<23|I>>>9))>>>0)+((R^T&(N^R))>>>0)+c[k][1]+t[k][1],n=L+u+p+c[k][0]+t[k][0]+(w/4294967296>>>0)>>>0,a=w>>>0,s=o+d+((w=l+f)/4294967296>>>0)>>>0,i=w>>>0,L=b,B=R,b=A,R=N,A=I,N=T,I=E+n+((w=S+a)/4294967296>>>0)>>>0,T=w>>>0,E=m,S=v,m=h,v=C,h=y,C=g,y=n+s+((w=a+i)/4294967296>>>0)>>>0,g=w>>>0;w=e[0][1]+g,e[0][0]=e[0][0]+y+(w/4294967296>>>0)>>>0,e[0][1]=w>>>0,w=e[1][1]+C,e[1][0]=e[1][0]+h+(w/4294967296>>>0)>>>0,e[1][1]=w>>>0,w=e[2][1]+v,e[2][0]=e[2][0]+m+(w/4294967296>>>0)>>>0,e[2][1]=w>>>0,w=e[3][1]+S,e[3][0]=e[3][0]+E+(w/4294967296>>>0)>>>0,e[3][1]=w>>>0,w=e[4][1]+T,e[4][0]=e[4][0]+I+(w/4294967296>>>0)>>>0,e[4][1]=w>>>0,w=e[5][1]+N,e[5][0]=e[5][0]+A+(w/4294967296>>>0)>>>0,e[5][1]=w>>>0,w=e[6][1]+R,e[6][0]=e[6][0]+b+(w/4294967296>>>0)>>>0,e[6][1]=w>>>0,w=e[7][1]+B,e[7][0]=e[7][0]+L+(w/4294967296>>>0)>>>0,e[7][1]=w>>>0,_-=128}}},33065:function(e,t,r){var n=r(63780);r(6591),r(37603),r(49815),r(91127),r(73937);var a=e.exports=n.ssh=n.ssh||{};function s(e,t){var r=t.toString(16);r[0]>="8"&&(r="00"+r);var a=n.util.hexToBytes(r);e.putInt32(a.length),e.putBytes(a)}function i(e,t){e.putInt32(t.length),e.putString(t)}function o(){for(var e=n.md.sha1.create(),t=arguments.length,r=0;r<t;++r)e.update(arguments[r]);return e.digest()}a.privateKeyToPutty=function(e,t,r){var a="ssh-rsa",c=""===(t=t||"")?"none":"aes256-cbc",l="PuTTY-User-Key-File-2: ssh-rsa\r\n";l+="Encryption: "+c+"\r\n",l+="Comment: "+(r=r||"")+"\r\n";var u=n.util.createBuffer();i(u,a),s(u,e.e),s(u,e.n);var p=n.util.encode64(u.bytes(),64),d=Math.floor(p.length/66)+1;l+="Public-Lines: "+d+"\r\n",l+=p;var f,y=n.util.createBuffer();if(s(y,e.d),s(y,e.p),s(y,e.q),s(y,e.qInv),t){var g=y.length()+16-1;g-=g%16;var h=o(y.bytes());h.truncate(h.length()-g+y.length()),y.putBuffer(h);var C=n.util.createBuffer();C.putBuffer(o("\0\0\0\0",t)),C.putBuffer(o("\0\0\0\x01",t));var m=n.aes.createEncryptionCipher(C.truncate(8),"CBC");m.start(n.util.createBuffer().fillWithByte(0,16)),m.update(y.copy()),m.finish();var v=m.output;v.truncate(16),f=n.util.encode64(v.bytes(),64)}else f=n.util.encode64(y.bytes(),64);l+="\r\nPrivate-Lines: "+(d=Math.floor(f.length/66)+1)+"\r\n",l+=f;var E=o("putty-private-key-file-mac-key",t),S=n.util.createBuffer();i(S,a),i(S,c),i(S,r),S.putInt32(u.length()),S.putBuffer(u),S.putInt32(y.length()),S.putBuffer(y);var I=n.hmac.create();return I.start("sha1",E),I.update(S.bytes()),l+="\r\nPrivate-MAC: "+I.digest().toHex()+"\r\n"},a.publicKeyToOpenSSH=function(e,t){var r="ssh-rsa";t=t||"";var a=n.util.createBuffer();return i(a,r),s(a,e.e),s(a,e.n),r+" "+n.util.encode64(a.bytes())+" "+t},a.privateKeyToOpenSSH=function(e,t){return t?n.pki.encryptRsaPrivateKey(e,t,{legacy:!0,algorithm:"aes128"}):n.pki.privateKeyToPem(e)},a.getPublicKeyFingerprint=function(e,t){var r=(t=t||{}).md||n.md.md5.create(),a=n.util.createBuffer();i(a,"ssh-rsa"),s(a,e.e),s(a,e.n),r.start(),r.update(a.getBytes());var o=r.digest();if("hex"===t.encoding){var c=o.toHex();return t.delimiter?c.match(/.{2}/g).join(t.delimiter):c}if("binary"===t.encoding)return o.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".');return o}},81412:function(e,t,r){var n=r(63780);r(28834),r(95111),r(73937);var a="forge.task",s={},i=0;n.debug.set(a,"tasks",s);var o={};n.debug.set(a,"queues",o);var c="ready",l="running",u="blocked",p="sleeping",d="done",f="error",y={ready:{}};y.ready.stop=c,y.ready.start=l,y.ready.cancel=d,y.ready.fail=f,y.running={},y.running.stop=c,y.running.start=l,y.running.block=u,y.running.unblock=l,y.running.sleep=p,y.running.wakeup=l,y.running.cancel=d,y.running.fail=f,y.blocked={},y.blocked.stop=u,y.blocked.start=u,y.blocked.block=u,y.blocked.unblock=u,y.blocked.sleep=u,y.blocked.wakeup=u,y.blocked.cancel=d,y.blocked.fail=f,y.sleeping={},y.sleeping.stop=p,y.sleeping.start=p,y.sleeping.block=p,y.sleeping.unblock=p,y.sleeping.sleep=p,y.sleeping.wakeup=p,y.sleeping.cancel=d,y.sleeping.fail=f,y.done={},y.done.stop=d,y.done.start=d,y.done.block=d,y.done.unblock=d,y.done.sleep=d,y.done.wakeup=d,y.done.cancel=d,y.done.fail=f,y.error={},y.error.stop=f,y.error.start=f,y.error.block=f,y.error.unblock=f,y.error.sleep=f,y.error.wakeup=f,y.error.cancel=f,y.error.fail=f;var g=function(e){this.id=-1,this.name=e.name||"?",this.parent=e.parent||null,this.run=e.run,this.subtasks=[],this.error=!1,this.state=c,this.blocks=0,this.timeoutId=null,this.swapTime=null,this.userData=null,this.id=i++,s[this.id]=this};g.prototype.debug=function(e){e=e||"",n.log.debug(a,e,"[%s][%s] task:",this.id,this.name,this,"subtasks:",this.subtasks.length,"queue:",o)},g.prototype.next=function(e,t){"function"===typeof e&&(t=e,e=this.name);var r=new g({run:t,name:e,parent:this});return r.state=l,r.type=this.type,r.successCallback=this.successCallback||null,r.failureCallback=this.failureCallback||null,this.subtasks.push(r),this},g.prototype.parallel=function(e,t){return n.util.isArray(e)&&(t=e,e=this.name),this.next(e,(function(r){var a=r;a.block(t.length);for(var s=function(e,r){n.task.start({type:e,run:function(e){t[r](e)},success:function(e){a.unblock()},failure:function(e){a.unblock()}})},i=0;i<t.length;i++){s(e+"__parallel-"+r.id+"-"+i,i)}}))},g.prototype.stop=function(){this.state=y[this.state].stop},g.prototype.start=function(){this.error=!1,this.state=y[this.state].start,this.state===l&&(this.start=new Date,this.run(this),h(this,0))},g.prototype.block=function(e){e="undefined"===typeof e?1:e,this.blocks+=e,this.blocks>0&&(this.state=y[this.state].block)},g.prototype.unblock=function(e){return e="undefined"===typeof e?1:e,this.blocks-=e,0===this.blocks&&this.state!==d&&(this.state=l,h(this,0)),this.blocks},g.prototype.sleep=function(e){e="undefined"===typeof e?0:e,this.state=y[this.state].sleep;var t=this;this.timeoutId=setTimeout((function(){t.timeoutId=null,t.state=l,h(t,0)}),e)},g.prototype.wait=function(e){e.wait(this)},g.prototype.wakeup=function(){this.state===p&&(cancelTimeout(this.timeoutId),this.timeoutId=null,this.state=l,h(this,0))},g.prototype.cancel=function(){this.state=y[this.state].cancel,this.permitsNeeded=0,null!==this.timeoutId&&(cancelTimeout(this.timeoutId),this.timeoutId=null),this.subtasks=[]},g.prototype.fail=function(e){if(this.error=!0,C(this,!0),e)e.error=this.error,e.swapTime=this.swapTime,e.userData=this.userData,h(e,0);else{if(null!==this.parent){for(var t=this.parent;null!==t.parent;)t.error=this.error,t.swapTime=this.swapTime,t.userData=this.userData,t=t.parent;C(t,!0)}this.failureCallback&&this.failureCallback(this)}};var h=function e(t,r){var n=r>30||+new Date-t.swapTime>20,a=function(r){if(r++,t.state===l)if(n&&(t.swapTime=+new Date),t.subtasks.length>0){var a=t.subtasks.shift();a.error=t.error,a.swapTime=t.swapTime,a.userData=t.userData,a.run(a),a.error||e(a,r)}else C(t),t.error||null!==t.parent&&(t.parent.error=t.error,t.parent.swapTime=t.swapTime,t.parent.userData=t.userData,e(t.parent,r))};n?setTimeout(a,0):a(r)},C=function(e,t){e.state=d,delete s[e.id],null===e.parent&&(e.type in o?0===o[e.type].length?n.log.error(a,"[%s][%s] task queue empty [%s]",e.id,e.name,e.type):o[e.type][0]!==e?n.log.error(a,"[%s][%s] task not first in queue [%s]",e.id,e.name,e.type):(o[e.type].shift(),0===o[e.type].length?delete o[e.type]:o[e.type][0].start()):n.log.error(a,"[%s][%s] task queue missing [%s]",e.id,e.name,e.type),t||(e.error&&e.failureCallback?e.failureCallback(e):!e.error&&e.successCallback&&e.successCallback(e)))};e.exports=n.task=n.task||{},n.task.start=function(e){var t=new g({run:e.run,name:e.name||"?"});t.type=e.type,t.successCallback=e.success||null,t.failureCallback=e.failure||null,t.type in o?o[e.type].push(t):(o[t.type]=[t],function(e){e.error=!1,e.state=y[e.state].start,setTimeout((function(){e.state===l&&(e.swapTime=+new Date,e.run(e),h(e,0))}),0)}(t))},n.task.cancel=function(e){e in o&&(o[e]=[o[e][0]])},n.task.createCondition=function(){var e={tasks:{},wait:function(t){t.id in e.tasks||(t.block(),e.tasks[t.id]=t)},notify:function(){var t=e.tasks;for(var r in e.tasks={},t)t[r].unblock()}};return e}},60465:function(e,t,r){function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var a=r(63780);r(4056),r(37603),r(49815),r(90141),r(94199),r(50888),r(91127),r(73937);var s=function(e,t,r,n){var s=a.util.createBuffer(),i=e.length>>1,o=i+(1&e.length),c=e.substr(0,o),l=e.substr(i,o),u=a.util.createBuffer(),p=a.hmac.create();r=t+r;var d=Math.ceil(n/16),f=Math.ceil(n/20);p.start("MD5",c);var y=a.util.createBuffer();u.putBytes(r);for(var g=0;g<d;++g)p.start(null,null),p.update(u.getBytes()),u.putBuffer(p.digest()),p.start(null,null),p.update(u.bytes()+r),y.putBuffer(p.digest());p.start("SHA1",l);var h=a.util.createBuffer();u.clear(),u.putBytes(r);for(g=0;g<f;++g)p.start(null,null),p.update(u.getBytes()),u.putBuffer(p.digest()),p.start(null,null),p.update(u.bytes()+r),h.putBuffer(p.digest());return s.putBytes(a.util.xorBytes(y.getBytes(),h.getBytes(),n)),s},i=function(e,t,r){var n=!1;try{var s=e.deflate(t.fragment.getBytes());t.fragment=a.util.createBuffer(s),t.length=s.length,n=!0}catch(e){}return n},o=function(e,t,r){var n=!1;try{var s=e.inflate(t.fragment.getBytes());t.fragment=a.util.createBuffer(s),t.length=s.length,n=!0}catch(e){}return n},c=function(e,t){var r=0;switch(t){case 1:r=e.getByte();break;case 2:r=e.getInt16();break;case 3:r=e.getInt24();break;case 4:r=e.getInt32()}return a.util.createBuffer(e.getBytes(r))},l=function(e,t,r){e.putInt(r.length(),t<<3),e.putBuffer(r)},u={Versions:{TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}}};u.SupportedVersions=[u.Versions.TLS_1_1,u.Versions.TLS_1_0],u.Version=u.SupportedVersions[0],u.MaxFragment=15360,u.ConnectionEnd={server:0,client:1},u.PRFAlgorithm={tls_prf_sha256:0},u.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2},u.CipherType={stream:0,block:1,aead:2},u.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4},u.CompressionMethod={none:0,deflate:1},u.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24},u.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20},u.Alert={},u.Alert.Level={warning:1,fatal:2},u.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100},u.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2},u.CipherSuites={},u.getCipherSuite=function(e){var t=null;for(var r in u.CipherSuites){var n=u.CipherSuites[r];if(n.id[0]===e.charCodeAt(0)&&n.id[1]===e.charCodeAt(1)){t=n;break}}return t},u.handleUnexpected=function(e,t){!e.open&&e.entity===u.ConnectionEnd.client||e.error(e,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.unexpected_message}})},u.handleHelloRequest=function(e,t,r){!e.handshaking&&e.handshakes>0&&(u.queue(e,u.createAlert(e,{level:u.Alert.Level.warning,description:u.Alert.Description.no_renegotiation})),u.flush(e)),e.process()},u.parseHelloMessage=function(e,t,r){var n=null,s=e.entity===u.ConnectionEnd.client;if(r<38)e.error(e,{message:s?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});else{var i=t.fragment,o=i.length();if(n={version:{major:i.getByte(),minor:i.getByte()},random:a.util.createBuffer(i.getBytes(32)),session_id:c(i,1),extensions:[]},s?(n.cipher_suite=i.getBytes(2),n.compression_method=i.getByte()):(n.cipher_suites=c(i,2),n.compression_methods=c(i,1)),(o=r-(o-i.length()))>0){for(var l=c(i,2);l.length()>0;)n.extensions.push({type:[l.getByte(),l.getByte()],data:c(l,2)});if(!s)for(var p=0;p<n.extensions.length;++p){var d=n.extensions[p];if(0===d.type[0]&&0===d.type[1])for(var f=c(d.data,2);f.length()>0;){if(0!==f.getByte())break;e.session.extensions.server_name.serverNameList.push(c(f,2).getBytes())}}}if(e.session.version&&(n.version.major!==e.session.version.major||n.version.minor!==e.session.version.minor))return e.error(e,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.protocol_version}});if(s)e.session.cipherSuite=u.getCipherSuite(n.cipher_suite);else for(var y=a.util.createBuffer(n.cipher_suites.bytes());y.length()>0&&(e.session.cipherSuite=u.getCipherSuite(y.getBytes(2)),null===e.session.cipherSuite););if(null===e.session.cipherSuite)return e.error(e,{message:"No cipher suites in common.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.handshake_failure},cipherSuite:a.util.bytesToHex(n.cipher_suite)});e.session.compressionMethod=s?n.compression_method:u.CompressionMethod.none}return n},u.createSecurityParameters=function(e,t){var r=e.entity===u.ConnectionEnd.client,n=t.random.bytes(),a=r?e.session.sp.client_random:n,s=r?n:u.createRandom().getBytes();e.session.sp={entity:e.entity,prf_algorithm:u.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:e.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:a,server_random:s}},u.handleServerHello=function(e,t,r){var n=u.parseHelloMessage(e,t,r);if(!e.fail){if(!(n.version.minor<=e.version.minor))return e.error(e,{message:"Incompatible TLS version.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.protocol_version}});e.version.minor=n.version.minor,e.session.version=e.version;var a=n.session_id.bytes();a.length>0&&a===e.session.id?(e.expect=g,e.session.resuming=!0,e.session.sp.server_random=n.random.bytes()):(e.expect=p,e.session.resuming=!1,u.createSecurityParameters(e,n)),e.session.id=a,e.process()}},u.handleClientHello=function(e,t,r){var n=u.parseHelloMessage(e,t,r);if(!e.fail){var s=n.session_id.bytes(),i=null;if(e.sessionCache&&(null===(i=e.sessionCache.getSession(s))?s="":(i.version.major!==n.version.major||i.version.minor>n.version.minor)&&(i=null,s="")),0===s.length&&(s=a.random.getBytes(32)),e.session.id=s,e.session.clientHelloVersion=n.version,e.session.sp={},i)e.version=e.session.version=i.version,e.session.sp=i.sp;else{for(var o,c=1;c<u.SupportedVersions.length&&!((o=u.SupportedVersions[c]).minor<=n.version.minor);++c);e.version={major:o.major,minor:o.minor},e.session.version=e.version}null!==i?(e.expect=I,e.session.resuming=!0,e.session.sp.client_random=n.random.bytes()):(e.expect=!1!==e.verifyClient?v:E,e.session.resuming=!1,u.createSecurityParameters(e,n)),e.open=!0,u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createServerHello(e)})),e.session.resuming?(u.queue(e,u.createRecord(e,{type:u.ContentType.change_cipher_spec,data:u.createChangeCipherSpec()})),e.state.pending=u.createConnectionState(e),e.state.current.write=e.state.pending.write,u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createFinished(e)}))):(u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createCertificate(e)})),e.fail||(u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createServerKeyExchange(e)})),!1!==e.verifyClient&&u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createCertificateRequest(e)})),u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createServerHelloDone(e)})))),u.flush(e),e.process()}},u.handleCertificate=function(e,t,r){if(r<3)return e.error(e,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});var n,s,i=t.fragment,o={certificate_list:c(i,3)},l=[];try{for(;o.certificate_list.length()>0;)n=c(o.certificate_list,3),s=a.asn1.fromDer(n),n=a.pki.certificateFromAsn1(s,!0),l.push(n)}catch(t){return e.error(e,{message:"Could not parse certificate list.",cause:t,send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.bad_certificate}})}var p=e.entity===u.ConnectionEnd.client;!p&&!0!==e.verifyClient||0!==l.length?0===l.length?e.expect=p?d:E:(p?e.session.serverCertificate=l[0]:e.session.clientCertificate=l[0],u.verifyCertificateChain(e,l)&&(e.expect=p?d:E)):e.error(e,{message:p?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}}),e.process()},u.handleServerKeyExchange=function(e,t,r){if(r>0)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.unsupported_certificate}});e.expect=f,e.process()},u.handleClientKeyExchange=function(e,t,r){if(r<48)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.unsupported_certificate}});var n=t.fragment,s={enc_pre_master_secret:c(n,2).getBytes()},i=null;if(e.getPrivateKey)try{i=e.getPrivateKey(e,e.session.serverCertificate),i=a.pki.privateKeyFromPem(i)}catch(t){e.error(e,{message:"Could not get private key.",cause:t,send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}})}if(null===i)return e.error(e,{message:"No private key set.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}});try{var o=e.session.sp;o.pre_master_secret=i.decrypt(s.enc_pre_master_secret);var l=e.session.clientHelloVersion;if(l.major!==o.pre_master_secret.charCodeAt(0)||l.minor!==o.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch(e){o.pre_master_secret=a.random.getBytes(48)}e.expect=I,null!==e.session.clientCertificate&&(e.expect=S),e.process()},u.handleCertificateRequest=function(e,t,r){if(r<3)return e.error(e,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});var n=t.fragment,a={certificate_types:c(n,1),certificate_authorities:c(n,2)};e.session.certificateRequest=a,e.expect=y,e.process()},u.handleCertificateVerify=function(e,t,r){if(r<2)return e.error(e,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});var n=t.fragment;n.read-=4;var s=n.bytes();n.read+=4;var i={signature:c(n,2).getBytes()},o=a.util.createBuffer();o.putBuffer(e.session.md5.digest()),o.putBuffer(e.session.sha1.digest()),o=o.getBytes();try{if(!e.session.clientCertificate.publicKey.verify(o,i.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");e.session.md5.update(s),e.session.sha1.update(s)}catch(t){return e.error(e,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.handshake_failure}})}e.expect=I,e.process()},u.handleServerHelloDone=function(e,t,r){if(r>0)return e.error(e,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.record_overflow}});if(null===e.serverCertificate){var s={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.insufficient_security}},i=e.verify(e,s.alert.description,0,[]);if(!0!==i)return(i||0===i)&&("object"!==n(i)||a.util.isArray(i)?"number"===typeof i&&(s.alert.description=i):(i.message&&(s.message=i.message),i.alert&&(s.alert.description=i.alert))),e.error(e,s)}null!==e.session.certificateRequest&&(t=u.createRecord(e,{type:u.ContentType.handshake,data:u.createCertificate(e)}),u.queue(e,t)),t=u.createRecord(e,{type:u.ContentType.handshake,data:u.createClientKeyExchange(e)}),u.queue(e,t),e.expect=m;var o=function(e,t){null!==e.session.certificateRequest&&null!==e.session.clientCertificate&&u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createCertificateVerify(e,t)})),u.queue(e,u.createRecord(e,{type:u.ContentType.change_cipher_spec,data:u.createChangeCipherSpec()})),e.state.pending=u.createConnectionState(e),e.state.current.write=e.state.pending.write,u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createFinished(e)})),e.expect=g,u.flush(e),e.process()};if(null===e.session.certificateRequest||null===e.session.clientCertificate)return o(e,null);u.getClientSignature(e,o)},u.handleChangeCipherSpec=function(e,t){if(1!==t.fragment.getByte())return e.error(e,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.illegal_parameter}});var r=e.entity===u.ConnectionEnd.client;(e.session.resuming&&r||!e.session.resuming&&!r)&&(e.state.pending=u.createConnectionState(e)),e.state.current.read=e.state.pending.read,(!e.session.resuming&&r||e.session.resuming&&!r)&&(e.state.pending=null),e.expect=r?h:T,e.process()},u.handleFinished=function(e,t,r){var n=t.fragment;n.read-=4;var i=n.bytes();n.read+=4;var o=t.fragment.getBytes();(n=a.util.createBuffer()).putBuffer(e.session.md5.digest()),n.putBuffer(e.session.sha1.digest());var c=e.entity===u.ConnectionEnd.client,l=c?"server finished":"client finished",p=e.session.sp;if((n=s(p.master_secret,l,n.getBytes(),12)).getBytes()!==o)return e.error(e,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.decrypt_error}});e.session.md5.update(i),e.session.sha1.update(i),(e.session.resuming&&c||!e.session.resuming&&!c)&&(u.queue(e,u.createRecord(e,{type:u.ContentType.change_cipher_spec,data:u.createChangeCipherSpec()})),e.state.current.write=e.state.pending.write,e.state.pending=null,u.queue(e,u.createRecord(e,{type:u.ContentType.handshake,data:u.createFinished(e)}))),e.expect=c?C:A,e.handshaking=!1,++e.handshakes,e.peerCertificate=c?e.session.serverCertificate:e.session.clientCertificate,u.flush(e),e.isConnected=!0,e.connected(e),e.process()},u.handleAlert=function(e,t){var r,n=t.fragment,a={level:n.getByte(),description:n.getByte()};switch(a.description){case u.Alert.Description.close_notify:r="Connection closed.";break;case u.Alert.Description.unexpected_message:r="Unexpected message.";break;case u.Alert.Description.bad_record_mac:r="Bad record MAC.";break;case u.Alert.Description.decryption_failed:r="Decryption failed.";break;case u.Alert.Description.record_overflow:r="Record overflow.";break;case u.Alert.Description.decompression_failure:r="Decompression failed.";break;case u.Alert.Description.handshake_failure:r="Handshake failure.";break;case u.Alert.Description.bad_certificate:r="Bad certificate.";break;case u.Alert.Description.unsupported_certificate:r="Unsupported certificate.";break;case u.Alert.Description.certificate_revoked:r="Certificate revoked.";break;case u.Alert.Description.certificate_expired:r="Certificate expired.";break;case u.Alert.Description.certificate_unknown:r="Certificate unknown.";break;case u.Alert.Description.illegal_parameter:r="Illegal parameter.";break;case u.Alert.Description.unknown_ca:r="Unknown certificate authority.";break;case u.Alert.Description.access_denied:r="Access denied.";break;case u.Alert.Description.decode_error:r="Decode error.";break;case u.Alert.Description.decrypt_error:r="Decrypt error.";break;case u.Alert.Description.export_restriction:r="Export restriction.";break;case u.Alert.Description.protocol_version:r="Unsupported protocol version.";break;case u.Alert.Description.insufficient_security:r="Insufficient security.";break;case u.Alert.Description.internal_error:r="Internal error.";break;case u.Alert.Description.user_canceled:r="User canceled.";break;case u.Alert.Description.no_renegotiation:r="Renegotiation not supported.";break;default:r="Unknown error."}if(a.description===u.Alert.Description.close_notify)return e.close();e.error(e,{message:r,send:!1,origin:e.entity===u.ConnectionEnd.client?"server":"client",alert:a}),e.process()},u.handleHandshake=function(e,t){var r=t.fragment,n=r.getByte(),s=r.getInt24();if(s>r.length())return e.fragmented=t,t.fragment=a.util.createBuffer(),r.read-=4,e.process();e.fragmented=null,r.read-=4;var i=r.bytes(s+4);r.read+=4,n in x[e.entity][e.expect]?(e.entity!==u.ConnectionEnd.server||e.open||e.fail||(e.handshaking=!0,e.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:a.md.md5.create(),sha1:a.md.sha1.create()}),n!==u.HandshakeType.hello_request&&n!==u.HandshakeType.certificate_verify&&n!==u.HandshakeType.finished&&(e.session.md5.update(i),e.session.sha1.update(i)),x[e.entity][e.expect][n](e,t,s)):u.handleUnexpected(e,t)},u.handleApplicationData=function(e,t){e.data.putBuffer(t.fragment),e.dataReady(e),e.process()},u.handleHeartbeat=function(e,t){var r=t.fragment,n=r.getByte(),s=r.getInt16(),i=r.getBytes(s);if(n===u.HeartbeatMessageType.heartbeat_request){if(e.handshaking||s>i.length)return e.process();u.queue(e,u.createRecord(e,{type:u.ContentType.heartbeat,data:u.createHeartbeat(u.HeartbeatMessageType.heartbeat_response,i)})),u.flush(e)}else if(n===u.HeartbeatMessageType.heartbeat_response){if(i!==e.expectedHeartbeatPayload)return e.process();e.heartbeatReceived&&e.heartbeatReceived(e,a.util.createBuffer(i))}e.process()};var p=1,d=2,f=3,y=4,g=5,h=6,C=7,m=8,v=1,E=2,S=3,I=4,T=5,A=6,N=u.handleUnexpected,b=u.handleChangeCipherSpec,R=u.handleAlert,L=u.handleHandshake,B=u.handleApplicationData,k=u.handleHeartbeat,U=[];U[u.ConnectionEnd.client]=[[N,R,L,N,k],[N,R,L,N,k],[N,R,L,N,k],[N,R,L,N,k],[N,R,L,N,k],[b,R,N,N,k],[N,R,L,N,k],[N,R,L,B,k],[N,R,L,N,k]],U[u.ConnectionEnd.server]=[[N,R,L,N,k],[N,R,L,N,k],[N,R,L,N,k],[N,R,L,N,k],[b,R,N,N,k],[N,R,L,N,k],[N,R,L,B,k],[N,R,L,N,k]];var w=u.handleHelloRequest,V=u.handleServerHello,P=u.handleCertificate,K=u.handleServerKeyExchange,D=u.handleCertificateRequest,_=u.handleServerHelloDone,O=u.handleFinished,x=[];x[u.ConnectionEnd.client]=[[N,N,V,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N],[w,N,N,N,N,N,N,N,N,N,N,P,K,D,_,N,N,N,N,N,N],[w,N,N,N,N,N,N,N,N,N,N,N,K,D,_,N,N,N,N,N,N],[w,N,N,N,N,N,N,N,N,N,N,N,N,D,_,N,N,N,N,N,N],[w,N,N,N,N,N,N,N,N,N,N,N,N,N,_,N,N,N,N,N,N],[w,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N],[w,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,O],[w,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N],[w,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N]];var M=u.handleClientHello,q=u.handleClientKeyExchange,F=u.handleCertificateVerify;x[u.ConnectionEnd.server]=[[N,M,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N,P,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,q,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,F,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,O],[N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N],[N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N]],u.generateKeys=function(e,t){var r=s,n=t.client_random+t.server_random;e.session.resuming||(t.master_secret=r(t.pre_master_secret,"master secret",n,48).bytes(),t.pre_master_secret=null),n=t.server_random+t.client_random;var a=2*t.mac_key_length+2*t.enc_key_length,i=e.version.major===u.Versions.TLS_1_0.major&&e.version.minor===u.Versions.TLS_1_0.minor;i&&(a+=2*t.fixed_iv_length);var o=r(t.master_secret,"key expansion",n,a),c={client_write_MAC_key:o.getBytes(t.mac_key_length),server_write_MAC_key:o.getBytes(t.mac_key_length),client_write_key:o.getBytes(t.enc_key_length),server_write_key:o.getBytes(t.enc_key_length)};return i&&(c.client_write_IV=o.getBytes(t.fixed_iv_length),c.server_write_IV=o.getBytes(t.fixed_iv_length)),c},u.createConnectionState=function(e){var t=e.entity===u.ConnectionEnd.client,r=function(){var e={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(e){return!0},compressionState:null,compressFunction:function(e){return!0},updateSequenceNumber:function(){4294967295===e.sequenceNumber[1]?(e.sequenceNumber[1]=0,++e.sequenceNumber[0]):++e.sequenceNumber[1]}};return e},n={read:r(),write:r()};if(n.read.update=function(e,t){return n.read.cipherFunction(t,n.read)?n.read.compressFunction(e,t,n.read)||e.error(e,{message:"Could not decompress record.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.decompression_failure}}):e.error(e,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.bad_record_mac}}),!e.fail},n.write.update=function(e,t){return n.write.compressFunction(e,t,n.write)?n.write.cipherFunction(t,n.write)||e.error(e,{message:"Could not encrypt record.",send:!1,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}}):e.error(e,{message:"Could not compress record.",send:!1,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}}),!e.fail},e.session){var a=e.session.sp;switch(e.session.cipherSuite.initSecurityParameters(a),a.keys=u.generateKeys(e,a),n.read.macKey=t?a.keys.server_write_MAC_key:a.keys.client_write_MAC_key,n.write.macKey=t?a.keys.client_write_MAC_key:a.keys.server_write_MAC_key,e.session.cipherSuite.initConnectionState(n,e,a),a.compression_algorithm){case u.CompressionMethod.none:break;case u.CompressionMethod.deflate:n.read.compressFunction=o,n.write.compressFunction=i;break;default:throw new Error("Unsupported compression algorithm.")}}return n},u.createRandom=function(){var e=new Date,t=+e+6e4*e.getTimezoneOffset(),r=a.util.createBuffer();return r.putInt32(t),r.putBytes(a.random.getBytes(28)),r},u.createRecord=function(e,t){return t.data?{type:t.type,version:{major:e.version.major,minor:e.version.minor},length:t.data.length(),fragment:t.data}:null},u.createAlert=function(e,t){var r=a.util.createBuffer();return r.putByte(t.level),r.putByte(t.description),u.createRecord(e,{type:u.ContentType.alert,data:r})},u.createClientHello=function(e){e.session.clientHelloVersion={major:e.version.major,minor:e.version.minor};for(var t=a.util.createBuffer(),r=0;r<e.cipherSuites.length;++r){var n=e.cipherSuites[r];t.putByte(n.id[0]),t.putByte(n.id[1])}var s=t.length(),i=a.util.createBuffer();i.putByte(u.CompressionMethod.none);var o=i.length(),c=a.util.createBuffer();if(e.virtualHost){var p=a.util.createBuffer();p.putByte(0),p.putByte(0);var d=a.util.createBuffer();d.putByte(0),l(d,2,a.util.createBuffer(e.virtualHost));var f=a.util.createBuffer();l(f,2,d),l(p,2,f),c.putBuffer(p)}var y=c.length();y>0&&(y+=2);var g=e.session.id,h=g.length+1+2+4+28+2+s+1+o+y,C=a.util.createBuffer();return C.putByte(u.HandshakeType.client_hello),C.putInt24(h),C.putByte(e.version.major),C.putByte(e.version.minor),C.putBytes(e.session.sp.client_random),l(C,1,a.util.createBuffer(g)),l(C,2,t),l(C,1,i),y>0&&l(C,2,c),C},u.createServerHello=function(e){var t=e.session.id,r=t.length+1+2+4+28+2+1,n=a.util.createBuffer();return n.putByte(u.HandshakeType.server_hello),n.putInt24(r),n.putByte(e.version.major),n.putByte(e.version.minor),n.putBytes(e.session.sp.server_random),l(n,1,a.util.createBuffer(t)),n.putByte(e.session.cipherSuite.id[0]),n.putByte(e.session.cipherSuite.id[1]),n.putByte(e.session.compressionMethod),n},u.createCertificate=function(e){var t,r=e.entity===u.ConnectionEnd.client,n=null;e.getCertificate&&(t=r?e.session.certificateRequest:e.session.extensions.server_name.serverNameList,n=e.getCertificate(e,t));var s=a.util.createBuffer();if(null!==n)try{a.util.isArray(n)||(n=[n]);for(var i=null,o=0;o<n.length;++o){var c=a.pem.decode(n[o])[0];if("CERTIFICATE"!==c.type&&"X509 CERTIFICATE"!==c.type&&"TRUSTED CERTIFICATE"!==c.type){var p=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw p.headerType=c.type,p}if(c.procType&&"ENCRYPTED"===c.procType.type)throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var d=a.util.createBuffer(c.body);null===i&&(i=a.asn1.fromDer(d.bytes(),!1));var f=a.util.createBuffer();l(f,3,d),s.putBuffer(f)}n=a.pki.certificateFromAsn1(i),r?e.session.clientCertificate=n:e.session.serverCertificate=n}catch(t){return e.error(e,{message:"Could not send certificate list.",cause:t,send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.bad_certificate}})}var y=3+s.length(),g=a.util.createBuffer();return g.putByte(u.HandshakeType.certificate),g.putInt24(y),l(g,3,s),g},u.createClientKeyExchange=function(e){var t=a.util.createBuffer();t.putByte(e.session.clientHelloVersion.major),t.putByte(e.session.clientHelloVersion.minor),t.putBytes(a.random.getBytes(46));var r=e.session.sp;r.pre_master_secret=t.getBytes();var n=(t=e.session.serverCertificate.publicKey.encrypt(r.pre_master_secret)).length+2,s=a.util.createBuffer();return s.putByte(u.HandshakeType.client_key_exchange),s.putInt24(n),s.putInt16(t.length),s.putBytes(t),s},u.createServerKeyExchange=function(e){var t=a.util.createBuffer();return t},u.getClientSignature=function(e,t){var r=a.util.createBuffer();r.putBuffer(e.session.md5.digest()),r.putBuffer(e.session.sha1.digest()),r=r.getBytes(),e.getSignature=e.getSignature||function(e,t,r){var n=null;if(e.getPrivateKey)try{n=e.getPrivateKey(e,e.session.clientCertificate),n=a.pki.privateKeyFromPem(n)}catch(t){e.error(e,{message:"Could not get private key.",cause:t,send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}})}null===n?e.error(e,{message:"No private key set.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.internal_error}}):t=n.sign(t,null),r(e,t)},e.getSignature(e,r,t)},u.createCertificateVerify=function(e,t){var r=t.length+2,n=a.util.createBuffer();return n.putByte(u.HandshakeType.certificate_verify),n.putInt24(r),n.putInt16(t.length),n.putBytes(t),n},u.createCertificateRequest=function(e){var t=a.util.createBuffer();t.putByte(1);var r=a.util.createBuffer();for(var n in e.caStore.certs){var s=e.caStore.certs[n],i=a.pki.distinguishedNameToAsn1(s.subject),o=a.asn1.toDer(i);r.putInt16(o.length()),r.putBuffer(o)}var c=1+t.length()+2+r.length(),p=a.util.createBuffer();return p.putByte(u.HandshakeType.certificate_request),p.putInt24(c),l(p,1,t),l(p,2,r),p},u.createServerHelloDone=function(e){var t=a.util.createBuffer();return t.putByte(u.HandshakeType.server_hello_done),t.putInt24(0),t},u.createChangeCipherSpec=function(){var e=a.util.createBuffer();return e.putByte(1),e},u.createFinished=function(e){var t=a.util.createBuffer();t.putBuffer(e.session.md5.digest()),t.putBuffer(e.session.sha1.digest());var r=e.entity===u.ConnectionEnd.client,n=e.session.sp,i=r?"client finished":"server finished";t=s(n.master_secret,i,t.getBytes(),12);var o=a.util.createBuffer();return o.putByte(u.HandshakeType.finished),o.putInt24(t.length()),o.putBuffer(t),o},u.createHeartbeat=function(e,t,r){"undefined"===typeof r&&(r=t.length);var n=a.util.createBuffer();n.putByte(e),n.putInt16(r),n.putBytes(t);var s=n.length(),i=Math.max(16,s-r-3);return n.putBytes(a.random.getBytes(i)),n},u.queue=function(e,t){if(t&&(0!==t.fragment.length()||t.type!==u.ContentType.handshake&&t.type!==u.ContentType.alert&&t.type!==u.ContentType.change_cipher_spec)){if(t.type===u.ContentType.handshake){var r=t.fragment.bytes();e.session.md5.update(r),e.session.sha1.update(r),r=null}var n;if(t.fragment.length()<=u.MaxFragment)n=[t];else{n=[];for(var s=t.fragment.bytes();s.length>u.MaxFragment;)n.push(u.createRecord(e,{type:t.type,data:a.util.createBuffer(s.slice(0,u.MaxFragment))})),s=s.slice(u.MaxFragment);s.length>0&&n.push(u.createRecord(e,{type:t.type,data:a.util.createBuffer(s)}))}for(var i=0;i<n.length&&!e.fail;++i){var o=n[i];e.state.current.write.update(e,o)&&e.records.push(o)}}},u.flush=function(e){for(var t=0;t<e.records.length;++t){var r=e.records[t];e.tlsData.putByte(r.type),e.tlsData.putByte(r.version.major),e.tlsData.putByte(r.version.minor),e.tlsData.putInt16(r.fragment.length()),e.tlsData.putBuffer(e.records[t].fragment)}return e.records=[],e.tlsDataReady(e)};var Q=function(e){switch(e){case!0:return!0;case a.pki.certificateError.bad_certificate:return u.Alert.Description.bad_certificate;case a.pki.certificateError.unsupported_certificate:return u.Alert.Description.unsupported_certificate;case a.pki.certificateError.certificate_revoked:return u.Alert.Description.certificate_revoked;case a.pki.certificateError.certificate_expired:return u.Alert.Description.certificate_expired;case a.pki.certificateError.certificate_unknown:return u.Alert.Description.certificate_unknown;case a.pki.certificateError.unknown_ca:return u.Alert.Description.unknown_ca;default:return u.Alert.Description.bad_certificate}};for(var G in u.verifyCertificateChain=function(e,t){try{var r={};for(var s in e.verifyOptions)r[s]=e.verifyOptions[s];r.verify=function(t,r,s){Q(t);var i=e.verify(e,t,r,s);if(!0!==i){if("object"===n(i)&&!a.util.isArray(i)){var o=new Error("The application rejected the certificate.");throw o.send=!0,o.alert={level:u.Alert.Level.fatal,description:u.Alert.Description.bad_certificate},i.message&&(o.message=i.message),i.alert&&(o.alert.description=i.alert),o}i!==t&&(i=function(e){switch(e){case!0:return!0;case u.Alert.Description.bad_certificate:return a.pki.certificateError.bad_certificate;case u.Alert.Description.unsupported_certificate:return a.pki.certificateError.unsupported_certificate;case u.Alert.Description.certificate_revoked:return a.pki.certificateError.certificate_revoked;case u.Alert.Description.certificate_expired:return a.pki.certificateError.certificate_expired;case u.Alert.Description.certificate_unknown:return a.pki.certificateError.certificate_unknown;case u.Alert.Description.unknown_ca:return a.pki.certificateError.unknown_ca;default:return a.pki.certificateError.bad_certificate}}(i))}return i},a.pki.verifyCertificateChain(e.caStore,t,r)}catch(t){var i=t;("object"!==n(i)||a.util.isArray(i))&&(i={send:!0,alert:{level:u.Alert.Level.fatal,description:Q(t)}}),"send"in i||(i.send=!0),"alert"in i||(i.alert={level:u.Alert.Level.fatal,description:Q(i.error)}),e.error(e,i)}return!e.fail},u.createSessionCache=function(e,t){var r=null;if(e&&e.getSession&&e.setSession&&e.order)r=e;else{for(var n in(r={}).cache=e||{},r.capacity=Math.max(t||100,1),r.order=[],e)r.order.length<=t?r.order.push(n):delete e[n];r.getSession=function(e){var t=null,n=null;if(e?n=a.util.bytesToHex(e):r.order.length>0&&(n=r.order[0]),null!==n&&n in r.cache)for(var s in t=r.cache[n],delete r.cache[n],r.order)if(r.order[s]===n){r.order.splice(s,1);break}return t},r.setSession=function(e,t){if(r.order.length===r.capacity){var n=r.order.shift();delete r.cache[n]}n=a.util.bytesToHex(e);r.order.push(n),r.cache[n]=t}}return r},u.createConnection=function(e){var t=null;t=e.caStore?a.util.isArray(e.caStore)?a.pki.createCaStore(e.caStore):e.caStore:a.pki.createCaStore();var r=e.cipherSuites||null;if(null===r)for(var n in r=[],u.CipherSuites)r.push(u.CipherSuites[n]);var s=e.server?u.ConnectionEnd.server:u.ConnectionEnd.client,i=e.sessionCache?u.createSessionCache(e.sessionCache):null,o={version:{major:u.Version.major,minor:u.Version.minor},entity:s,sessionId:e.sessionId,caStore:t,sessionCache:i,cipherSuites:r,connected:e.connected,virtualHost:e.virtualHost||null,verifyClient:e.verifyClient||!1,verify:e.verify||function(e,t,r,n){return t},verifyOptions:e.verifyOptions||{},getCertificate:e.getCertificate||null,getPrivateKey:e.getPrivateKey||null,getSignature:e.getSignature||null,input:a.util.createBuffer(),tlsData:a.util.createBuffer(),data:a.util.createBuffer(),tlsDataReady:e.tlsDataReady,dataReady:e.dataReady,heartbeatReceived:e.heartbeatReceived,closed:e.closed,error:function(t,r){r.origin=r.origin||(t.entity===u.ConnectionEnd.client?"client":"server"),r.send&&(u.queue(t,u.createAlert(t,r.alert)),u.flush(t));var n=!1!==r.fatal;n&&(t.fail=!0),e.error(t,r),n&&t.close(!1)},deflate:e.deflate||null,inflate:e.inflate||null,reset:function(e){o.version={major:u.Version.major,minor:u.Version.minor},o.record=null,o.session=null,o.peerCertificate=null,o.state={pending:null,current:null},o.expect=(o.entity,u.ConnectionEnd.client,0),o.fragmented=null,o.records=[],o.open=!1,o.handshakes=0,o.handshaking=!1,o.isConnected=!1,o.fail=!(e||"undefined"===typeof e),o.input.clear(),o.tlsData.clear(),o.data.clear(),o.state.current=u.createConnectionState(o)}};o.reset();return o.handshake=function(e){if(o.entity!==u.ConnectionEnd.client)o.error(o,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(o.handshaking)o.error(o,{message:"Handshake already in progress.",fatal:!1});else{o.fail&&!o.open&&0===o.handshakes&&(o.fail=!1),o.handshaking=!0;var t=null;(e=e||"").length>0&&(o.sessionCache&&(t=o.sessionCache.getSession(e)),null===t&&(e="")),0===e.length&&o.sessionCache&&null!==(t=o.sessionCache.getSession())&&(e=t.id),o.session={id:e,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:a.md.md5.create(),sha1:a.md.sha1.create()},t&&(o.version=t.version,o.session.sp=t.sp),o.session.sp.client_random=u.createRandom().getBytes(),o.open=!0,u.queue(o,u.createRecord(o,{type:u.ContentType.handshake,data:u.createClientHello(o)})),u.flush(o)}},o.process=function(e){var t=0;return e&&o.input.putBytes(e),o.fail||(null!==o.record&&o.record.ready&&o.record.fragment.isEmpty()&&(o.record=null),null===o.record&&(t=function(e){var t=0,r=e.input,n=r.length();if(n<5)t=5-n;else{e.record={type:r.getByte(),version:{major:r.getByte(),minor:r.getByte()},length:r.getInt16(),fragment:a.util.createBuffer(),ready:!1};var s=e.record.version.major===e.version.major;s&&e.session&&e.session.version&&(s=e.record.version.minor===e.version.minor),s||e.error(e,{message:"Incompatible TLS version.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.protocol_version}})}return t}(o)),o.fail||null===o.record||o.record.ready||(t=function(e){var t=0,r=e.input,n=r.length();return n<e.record.length?t=e.record.length-n:(e.record.fragment.putBytes(r.getBytes(e.record.length)),r.compact(),e.state.current.read.update(e,e.record)&&(null!==e.fragmented&&(e.fragmented.type===e.record.type?(e.fragmented.fragment.putBuffer(e.record.fragment),e.record=e.fragmented):e.error(e,{message:"Invalid fragmented record.",send:!0,alert:{level:u.Alert.Level.fatal,description:u.Alert.Description.unexpected_message}})),e.record.ready=!0)),t}(o)),!o.fail&&null!==o.record&&o.record.ready&&function(e,t){var r=t.type-u.ContentType.change_cipher_spec,n=U[e.entity][e.expect];r in n?n[r](e,t):u.handleUnexpected(e,t)}(o,o.record)),t},o.prepare=function(e){return u.queue(o,u.createRecord(o,{type:u.ContentType.application_data,data:a.util.createBuffer(e)})),u.flush(o)},o.prepareHeartbeatRequest=function(e,t){return e instanceof a.util.ByteBuffer&&(e=e.bytes()),"undefined"===typeof t&&(t=e.length),o.expectedHeartbeatPayload=e,u.queue(o,u.createRecord(o,{type:u.ContentType.heartbeat,data:u.createHeartbeat(u.HeartbeatMessageType.heartbeat_request,e,t)})),u.flush(o)},o.close=function(e){if(!o.fail&&o.sessionCache&&o.session){var t={id:o.session.id,version:o.session.version,sp:o.session.sp};t.sp.keys=null,o.sessionCache.setSession(t.id,t)}o.open&&(o.open=!1,o.input.clear(),(o.isConnected||o.handshaking)&&(o.isConnected=o.handshaking=!1,u.queue(o,u.createAlert(o,{level:u.Alert.Level.warning,description:u.Alert.Description.close_notify})),u.flush(o)),o.closed(o)),o.reset(e)},o},e.exports=a.tls=a.tls||{},u)"function"!==typeof u[G]&&(a.tls[G]=u[G]);a.tls.prf_tls1=s,a.tls.hmac_sha1=function(e,t,r){var n=a.hmac.create();n.start("SHA1",e);var s=a.util.createBuffer();return s.putInt32(t[0]),s.putInt32(t[1]),s.putByte(r.type),s.putByte(r.version.major),s.putByte(r.version.minor),s.putInt16(r.length),s.putBytes(r.fragment.bytes()),n.update(s.getBytes()),n.digest().getBytes()},a.tls.createSessionCache=u.createSessionCache,a.tls.createConnection=u.createConnection}}]);